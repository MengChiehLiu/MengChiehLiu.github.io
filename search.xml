<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Trie (å­—å…¸æ¨¹) - Design Add and Search Words Data Structure</title>
    <url>/posts/DSA/2023/trie-2/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p>å¯«å®Œä¸Šä¸€ç¯‡<a href="/posts/DSA/2023/trie/">Implement Trie (å­—å…¸æ¨¹)</a>å¾Œï¼Œæ²’éå…©å¤©LeetCodeæ¯æ—¥ä¸€é¡Œåˆå‡ºç¾Trieçš„é¡Œç›®äº†(ç¬‘)ï¼Œé¡Œç›®æ˜¯<a href="https://leetcode.com/problems/design-add-and-search-words-data-structure/">211. Design Add and Search Words Data Structure</a>ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯å­—å…¸æ¨¹åŠ ä¸Šä¸€é»æ­£è¦è¡¨é”(regular expression)çš„æ¦‚å¿µï¼Œèˆ‰ä¾‹ä¾†èªªtrieè£¡æœ‰<code>bad</code>ï¼Œé‚£æœå°‹<code>b.d</code>çš„è©±ä¹Ÿè¦å›å‚³<code>true</code>ï¼Œè©³ç´°é¡Œç›®ä¸€æ¨£è‡ªå·±åˆ°LeetCodeå»çœ‹å›‰ã€‚</p>
<span id="more"></span>
<h1 id="è§£é¡Œæ€è·¯"><a class="markdownIt-Anchor" href="#è§£é¡Œæ€è·¯"></a> è§£é¡Œæ€è·¯</h1>
<p>å¦‚æœä¸è€ƒæ…®æ­£è¦è¡¨é”çš„è©±ï¼Œé‚£å…¶å¯¦å°±æ˜¯æœ€åŸºæœ¬çš„Trieï¼Œé‚„ä¸äº†è§£trieçš„è©±å¯ä»¥åƒè€ƒå‰ä¸€ç¯‡æ–‡ç« ï¼ä½†ç¾åœ¨å¤šäº†é€™å€‹ç‰¹æ®Šæ¢ä»¶å¾Œï¼Œæˆ‘å€‘å°±éœ€è¦å»è€ƒæ…®æ‰€æœ‰å¯èƒ½ï¼Œæ–¹æ³•æ˜¯å¯«ä¸€å€‹dfs(Depth First Search)çš„è¼”åŠ©å‡½å¼ï¼Œé‡åˆ°<code>.</code>çš„è©±å°±å°‡ç•¶å‰ç¯€é»ä¸‹çš„æ‰€æœ‰å­ç¯€é»å†å¸¶å…¥dfsï¼Œçœ‹æœ€å¾Œæœ‰æ²’æœ‰ç¬¦åˆçš„å–®å­—ï¼Œåªè¦æœ‰å…¶ä¸­ä¸€å€‹å­ç¯€é»ç¬¦åˆçš„è©±æœƒæå‰å›å‚³<code>true</code>ï¼Œéƒ½æ²’æœ‰çš„è©±å°±å›å‚³<code>false</code>ã€‚</p>
<p>æˆ‘å€‘ä»¥ä¸‹é¢çš„åœ–ç‰‡ä¾†èªªæ˜æ­¥é©Ÿï¼Œå‡è¨­æˆ‘å€‘ä»Šå¤©æœå°‹<code>b.t</code>ï¼š</p>
<ol>
<li>è·Ÿä¸€èˆ¬çš„trieä¸€æ¨£ï¼Œæˆ‘å€‘æœƒå…ˆç¢ºèªrootä¸‹æœ‰æ²’æœ‰bé€™å€‹ç¯€é»ï¼Œæœ‰çš„è©±å°±èµ°åˆ°é€™å€‹ç¯€é»ä¸Šã€‚</li>
<li>å› ç‚ºç¬¬äºŒå€‹å­—æ˜¯<code>.</code>ï¼Œè¡¨ç¤º<code>ba</code>è·Ÿ<code>bo</code>éƒ½æ˜¯æˆ‘å€‘å¯ä»¥èµ°çš„è·¯å¾‘ï¼Œå› æ­¤æˆ‘å€‘å…©æ¢è·¯éƒ½è¦å»è¨ªå•ï¼Œä¾å­—æ¯é †åºæˆ‘å€‘å…ˆè¨ªå•<code>ba</code>ã€‚</li>
<li><code>ba</code>ä¸‹é¢é›–ç„¶æœ‰ç¯€é»<code>bat</code>ï¼Œä½†ä»–ä¸æ˜¯å–®å­—çš„çµå°¾ï¼Œæ‰€ä»¥æˆ‘å€‘è·³å‡ºé€™æ¢è·¯å¾‘ã€‚</li>
<li>æˆ‘å€‘å›åˆ°ä¸Šä¸€å±¤ï¼Œæ”¹èµ°<code>bo</code>é€™æ¢è·¯å¾‘ã€‚</li>
<li><code>bot</code>ç¬¦åˆæˆ‘å€‘è¦æ‰¾çš„ç­”æ¡ˆï¼Œä¸¦ä¸”ä»–ä¹Ÿæ˜¯å–®å­—çš„çµå°¾ï¼Œå› æ­¤å›å‚³<code>true</code>ã€‚</li>
</ol>
<p><img src="/images/2023/03/20/trie.png" alt="trie" /></p>
<h1 id="æ–¹æ³•ä¸€-pointers-c"><a class="markdownIt-Anchor" href="#æ–¹æ³•ä¸€-pointers-c"></a> æ–¹æ³•ä¸€: Pointers (C++)</h1>
<p>é‡é»</p>
<ul>
<li>dfsé™¤äº†è¦å‚³å…¥ç¯€é»<code>curr</code>ï¼Œä¹Ÿè¦è¨˜éŒ„ç›®å‰èµ°åˆ°ç¬¬å–®å­—ä¸­çš„ç¬¬å¹¾å€‹ä½ç½®<code>start</code>ã€‚</li>
<li>é‡åˆ°<code>.</code>çš„è©±å°±å°æ‰€æœ‰å¯èƒ½è·¯å¾‘å†åšä¸€æ¬¡dfsã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    Node* children[<span class="number">26</span>];</span><br><span class="line">    <span class="type">bool</span> is_end = <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WordDictionary</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Node* root;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    string word;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(Node* curr, <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=start; i&lt;n; i++)&#123;</span><br><span class="line">            <span class="comment">// é‡åˆ° .</span></span><br><span class="line">            <span class="keyword">if</span> (word[i] == <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                <span class="comment">// ç”¨è¿´åœˆé€ è¨ªæ‰€æœ‰å¯èƒ½è·¯å¾‘</span></span><br><span class="line">                <span class="keyword">for</span> (Node* next: curr-&gt;children)&#123;</span><br><span class="line">                    <span class="comment">// è·¯å¾‘ä¸å¯ç‚ºç©º &amp;&amp; è©²è·¯å¾‘æœ‰ç¬¦åˆç­”æ¡ˆè€…</span></span><br><span class="line">                    <span class="keyword">if</span> (next!=<span class="literal">nullptr</span> &amp;&amp; <span class="built_in">dfs</span>(next, i+<span class="number">1</span>))&#123;</span><br><span class="line">                        <span class="comment">// æå‰å›å‚³ true</span></span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å…¨éƒ¨è·¯å¾‘ç„¡ç­”æ¡ˆï¼Œå›å‚³ false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (curr-&gt;children[word[i]-<span class="string">&#x27;a&#x27;</span>] != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                curr = curr-&gt;children[word[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> curr-&gt;is_end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">WordDictionary</span>() &#123;</span><br><span class="line">        root = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addWord</span><span class="params">(string word)</span> </span>&#123;</span><br><span class="line">        Node* curr = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> w: word)&#123;</span><br><span class="line">            <span class="keyword">if</span> (curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>] == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>] = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        curr-&gt;is_end = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">search</span><span class="params">(string word)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = word.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">this</span>-&gt;word = word;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(root, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="æ–¹æ³•äºŒ-hash-table-python"><a class="markdownIt-Anchor" href="#æ–¹æ³•äºŒ-hash-table-python"></a> æ–¹æ³•äºŒ: Hash Table (Python)</h1>
<p>é‡é»</p>
<ul>
<li>æ³¨æ„è¦é¿é–‹<code>#</code>å› ç‚ºä»–ä¸æ˜¯ä¸€å€‹è·¯å¾‘ï¼Œå¦å‰‡æœƒå ±éŒ¯ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">WordDictionary</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.root = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">addWord</span>(<span class="params">self, word: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        curr = self.root</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> curr:</span><br><span class="line">                curr[w] = &#123;&#125;</span><br><span class="line">            curr = curr[w]</span><br><span class="line">        curr[<span class="string">&quot;#&quot;</span>] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">self, word: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        n = <span class="built_in">len</span>(word)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">curr, start</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, n):</span><br><span class="line">                w = word[i]</span><br><span class="line">                <span class="comment"># é‡åˆ° .</span></span><br><span class="line">                <span class="keyword">if</span> w == <span class="string">&quot;.&quot;</span>:</span><br><span class="line">                    <span class="comment"># ç”¨è¿´åœˆé€ è¨ªæ‰€æœ‰å¯èƒ½è·¯å¾‘</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> curr:</span><br><span class="line">                        <span class="comment"># é¿é–‹çµå°¾æ¨™è¨˜ &amp;&amp; è©²è·¯å¾‘æœ‰ç¬¦åˆç­”æ¡ˆè€…</span></span><br><span class="line">                        <span class="keyword">if</span> c!=<span class="string">&quot;#&quot;</span> <span class="keyword">and</span> dfs(curr[c], i+<span class="number">1</span>):</span><br><span class="line">                            <span class="comment"># æå‰å›å‚³ true</span></span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                    <span class="comment"># å…¨éƒ¨è·¯å¾‘ç„¡ç­”æ¡ˆï¼Œå›å‚³ false</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">elif</span> w <span class="keyword">in</span> curr:</span><br><span class="line">                    curr = curr[w]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;#&quot;</span> <span class="keyword">in</span> curr</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dfs(self.root, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>DSA</category>
      </categories>
      <tags>
        <tag>Trie</tag>
        <tag>LeetCode</tag>
      </tags>
  </entry>
  <entry>
    <title>éæ­·å°åŒ—æ·é‹109å€‹è»Šç«™è¦èŠ±å¤šä¹…æ™‚é–“? åŸºæ–¼ Held Karp ç®—æ³•å°‹æ‰¾æœ€ä½³è·¯ç·š!</title>
    <url>/posts/DSA/2024/MRT-held-karp/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2>
<p><img src="/images/2024/07/27/image.png" alt="MRT event" /></p>
<p>å°åŒ—æ·é‹æœ€è¿‘æ¨å‡ºäº†ä¸€å€‹å¾ˆç˜‹ç‹‚çš„<a href="https://web.metro.taipei/event/metrotaipeistamp/">é›†ç« å…¨åˆ¶éœ¸</a>æ´»å‹•ï¼Œé›†æ»¿5æ¢æ·é‹è·¯ç·š(ä¸å«ç’°ç‹€ç·š)ï¼Œç¸½å…±109å€‹è»Šç«™ï¼Œå°±å¯ä»¥æŠ½å¤§çï¼Œåˆ°åº•æœ‰èª°æœƒé–’é–’æ²’äº‹æƒ³åƒåŠ é€™å€‹æ´»å‹•? å•Šï¼Œæˆ‘å¥³æœ‹å‹å‰›å‰›å•æˆ‘è¦ä¸è¦åƒåŠ ï¼Œæ²’äº‹æ²’äº‹ï¼ŒçœŸæ˜¯å€‹å¥½æ´»å‹•! å•é¡Œä¾†äº†ï¼Œè©²å¦‚ä½•ç”¨æœ€çŸ­çš„æ™‚é–“é›†é½Šæ‰€æœ‰è»Šç«™ä¸¦å›åˆ°å‡ºç™¼åœ°å‘¢?</p>
<p>æœ¬æ–‡å°‡ä½¿ç”¨ Held Karp ç®—æ³•ä¾†è¨ˆç®—å¾å°åŒ—è»Šç«™å‡ºç™¼ï¼Œéæ­· 109 å€‹è»Šç«™ï¼Œä¸¦åœ¨æœ€å¾Œå›åˆ°å°åŒ—è»Šç«™æ‰€éœ€èŠ±è²»çš„æœ€çŸ­æ™‚é–“èˆ‡è·¯å¾‘ï¼Œä¸æƒ³çœ‹éç¨‹çš„äººä¹Ÿå¯ä»¥ç›´æ¥åˆ°æœ€å¾Œé¢çœ‹çµæœã€‚XD</p>
<span id="more"></span>
<h2 id="æ—…è¡Œæ¨éŠ·å“¡å•é¡Œ"><a class="markdownIt-Anchor" href="#æ—…è¡Œæ¨éŠ·å“¡å•é¡Œ"></a> æ—…è¡Œæ¨éŠ·å“¡å•é¡Œ</h2>
<p>è‚¯å®šæœ‰äººç™¼ç¾äº†ï¼Œé€™æœ¬è³ªå°±æ˜¯ä¸€å€‹æ—…è¡Œæ¨éŠ·å“¡å•é¡Œï¼Œå¯ä»¥ç°¡ç¨±ç‚ºTSPå•é¡Œ (Travelling salesman problem)ã€‚å€Ÿç”¨<a href="https://zh.wikipedia.org/zh-tw/%E6%97%85%E8%A1%8C%E6%8E%A8%E9%94%80%E5%91%98%E9%97%AE%E9%A2%98">ç¶­åŸºç™¾ç§‘</a>çš„ä»‹ç´¹ï¼Œå…¶å•é¡Œå…§å®¹ç‚ºã€Œçµ¦å®šä¸€ç³»åˆ—åŸå¸‚å’Œæ¯å°åŸå¸‚ä¹‹é–“çš„è·é›¢ï¼Œæ±‚è§£è¨ªå•æ¯åº§åŸå¸‚ä¸€æ¬¡ä¸¦å›åˆ°èµ·å§‹åŸå¸‚çš„æœ€çŸ­è¿´è·¯ã€‚ã€</p>
<p>æˆ‘å€‘å¯ä»¥ä½¿ç”¨å°åŒ—æ·é‹é–‹æ”¾è³‡æ–™ API ä¸­çš„ <a href="https://tdx.transportdata.tw/api-service/swagger/basic/268fc230-2e04-471b-a728-a726167c1cfc#/Metro/MetroApi_Line_2091">æ·é‹è·¯ç·šåŸºæœ¬è³‡æ–™</a> ä¾†å»ºç«‹ Graphï¼Œå†æ­é… TSP ç®—æ³•ç†è«–ä¸Šå°±èƒ½ç®—å‡ºæœ€ä½³è·¯å¾‘èˆ‡èŠ±è²»æ™‚é–“äº†ï¼Œç‚ºäº†æ–¹ä¾¿è¨ˆç®—å…ˆä¸è€ƒæ…®ç­æ¬¡è·Ÿè½‰ä¹˜æ™‚é–“äº†ã€‚å¦å¤–ï¼Œé›–ç„¶ç’°ç‹€ç·šä¸åœ¨é›†ç« æ´»å‹•çš„ç¯„åœå…§ï¼Œä½†èº«ç‚ºä¸€æ¢ã€Œæ·å¾‘ã€ï¼Œè‚¯å®šé‚„æ˜¯è¦è€ƒæ…®é€²å»çš„ã€‚</p>
<ul>
<li>è³‡æ–™æ ¼å¼  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lines = [</span><br><span class="line">    &#123;</span><br><span class="line">    &quot;LineNo&quot;: &quot;BL&quot;,</span><br><span class="line">    &quot;LineID&quot;: &quot;BL&quot;,</span><br><span class="line">    &quot;RouteID&quot;: &quot;BL-1&quot;,</span><br><span class="line">    &quot;TrainType&quot;: 1,</span><br><span class="line">    &quot;TravelTimes&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;Sequence&quot;: 1,</span><br><span class="line">        &quot;FromStationID&quot;: &quot;BL23&quot;,</span><br><span class="line">        &quot;FromStationName&quot;: &#123;</span><br><span class="line">          &quot;Zh_tw&quot;: &quot;å—æ¸¯å±•è¦½é¤¨&quot;,</span><br><span class="line">          &quot;En&quot;: &quot;Taipei Nangang Exhibition Center&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ToStationID&quot;: &quot;BL22&quot;,</span><br><span class="line">        &quot;ToStationName&quot;: &#123;</span><br><span class="line">          &quot;Zh_tw&quot;: &quot;å—æ¸¯&quot;,</span><br><span class="line">          &quot;En&quot;: &quot;Nangang&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;RunTime&quot;: 112,</span><br><span class="line">        &quot;StopTime&quot;: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      </span><br><span class="line">      ... and more</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li>å»º Graph  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">original_graph = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    <span class="keyword">for</span> edge <span class="keyword">in</span> line[<span class="string">&quot;TravelTimes&quot;</span>]:</span><br><span class="line">        start = edge[<span class="string">&#x27;FromStationName&#x27;</span>][<span class="string">&#x27;Zh_tw&#x27;</span>]</span><br><span class="line">        end = edge[<span class="string">&#x27;ToStationName&#x27;</span>][<span class="string">&#x27;Zh_tw&#x27;</span>]</span><br><span class="line">        time = edge[<span class="string">&quot;RunTime&quot;</span>]</span><br><span class="line">        original_graph[start][end] = time</span><br><span class="line">        original_graph[end][start] = time</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="held-karp-ç®—æ³•"><a class="markdownIt-Anchor" href="#held-karp-ç®—æ³•"></a> Held Karp ç®—æ³•</h2>
<p>Held Karp ç®—æ³•æ˜¯åŸºæ–¼å‹•æ…‹è¦åŠƒä¾†æ±‚è§£TSPå•é¡Œçš„ä¸€ç¨®ç®—æ³•ï¼Œç°¡å–®ä¾†èªªï¼Œé€™å€‹ç®—æ³•æœƒéæ­·æ‰€æœ‰å¯èƒ½çš„ç‹€æ…‹ï¼ŒåŒ…æ‹¬<em>å·²è¨ªå•ç¯€é»</em>èˆ‡<em>æ‰€åœ¨ç¯€é»</em>ï¼Œä¸¦æ ¹æ“šç•¶å‰ç‹€æ…‹ä¸‹å»è¨ˆç®—ä¸‹ä¸€æ­¥è©²å¦‚ä½•èµ°ã€‚</p>
<p>ç‚ºäº†è¨˜éŒ„æ‰€æœ‰å¯èƒ½ï¼Œæˆ‘å€‘å¯ä»¥ç”¨ binary ä¾†è¡¨ç¤ºå·²è¨ªå•ç¯€é»ï¼Œ1è¡¨ç¤ºå·²ç¶“éï¼Œ0è¡¨ç¤ºé‚„æ²’ç¶“éï¼Œèˆ‰ä¾‹ä¾†èªª</p>
<ul>
<li>000: è¡¨ç¤ºå°šæœªè¨ªå•ä»»ä½•ç¯€é»</li>
<li>001: è¡¨ç¤ºå·²è¨ªå•ç¬¬1å€‹ç¯€é»</li>
<li>101: è¡¨ç¤ºå·²è¨ªå•ç¬¬1è·Ÿç¬¬3å€‹ç¯€é»</li>
</ul>
<p>Held Karp ç®—æ³•ç†è«–ä¸Šèƒ½æ±‚å‡ºæœ€ä½³è§£ï¼Œå¯æƒœæ™‚é–“è¤‡é›œåº¦é«˜ï¼Œå°‡å·²è¨ªå•ç¯€é» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(2^n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> x ç•¶å‰ç¯€é» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> x ä¸‹ä¸€ç¯€é» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>ï¼Œæœƒå¾—åˆ°æ™‚é–“è¤‡é›œåº¦æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(n^2 2^n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>Anywayï¼Œæ™‚é–“è¤‡é›œåº¦é‚£éº¼é«˜ï¼Œæœ€å¤šä¹Ÿå°±å®¹è¨±åœ–ä¸­æœ‰20~25å€‹ç¯€é»ï¼Œå°åŒ—æ·é‹109å€‹ç«™æ˜¯è¦ç®—åˆ°å¤©è’åœ°è€? æ‰€ä»¥æˆ‘å€‘çš„ä¸‹å€‹ç›®æ¨™æ˜¯è¦å°‡ Graph ç¸®å°!</p>
<blockquote>
<p>BTW, å› ç‚ºç®—æ³•éœ€è¦çŸ¥é“ä»»æ„å…©é»ä¹‹é–“çš„æˆæœ¬ï¼Œæ‰€ä»¥ä¸‹æ–‡ä¸­ä»»æ„å…©é»é–“çš„è·é›¢ä½¿ç”¨ Dijkstra ä¾†è¨ˆç®—æœ€çŸ­è·¯å¾‘ã€‚</p>
</blockquote>
<h2 id="cut-the-tails-and-circle"><a class="markdownIt-Anchor" href="#cut-the-tails-and-circle"></a> Cut the tails and circle</h2>
<p>ä»”ç´°è§€å¯Ÿæ·é‹åœ–ï¼Œæœƒç™¼ç¾å¤§éƒ¨åˆ†æ·é‹å°¾å·´çš„éƒ¨åˆ†æ˜¯å¯ä»¥åˆ†é–‹è¨ˆç®—çš„ï¼Œæ¯”å¦‚æ°‘æ¬Šè¥¿è·¯åˆ°æ·¡æ°´ã€å¤§å®‰åˆ°å‹•ç‰©åœ’ç­‰ï¼Œç›´è¦ºä¸Šä¾†èªªé€™äº›è·¯ç·šè‚¯å®šåªèƒ½åŸè·¯æŠ˜è¿”ï¼Œæ›´æº–ç¢ºåœ°è¬›æˆ‘å€‘å¯ä»¥ä¸æ–·åœ°å°‡ indegree ç‚º 1 çš„ç¯€é»ç§»é™¤æ‰ï¼Œç”¨å‰©é¤˜çš„ç¯€é»è¨ˆç®—å°±å¥½ã€‚</p>
<p>æ¥è‘—çœ‹åˆ°æ–‡æ¹–ç·šèˆ‡æ¿å—ç·šåœèµ·çš„åœ“åœˆï¼Œå¦‚æœä½ ä»Šå¤©è¦ç”¨æœ€å¿«çš„æ™‚é–“éæ­·åœ“åœˆå…§çš„æ‰€æœ‰è»Šç«™ï¼Œä½ æœƒæ€éº¼èµ°é€™å€‹åœ“åœˆ? è¦é¦¬é †æ™‚é˜ç¹å®Œè¦é¦¬é€†æ™‚é˜ç¹å®Œï¼Œçµ•å°ä¸æœƒæœ‰ç¹ä¸€åŠå¾€å›èµ°çš„æƒ…æ³ï¼Œæ‰€ä»¥é€™ä¸€æ®µæˆ‘å€‘ä¹Ÿå¯ä»¥å…ˆç§»é™¤ã€‚</p>
<p><img src="/images/2024/07/27/core.png" alt="MRT core area" /></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tails = [</span><br><span class="line">    (<span class="string">&#x27;æ·¡æ°´&#x27;</span>, <span class="string">&#x27;æ°‘æ¬Šè¥¿è·¯&#x27;</span>), (<span class="string">&#x27;æ–°åŒ—æŠ•&#x27;</span>, <span class="string">&#x27;åŒ—æŠ•&#x27;</span>), (<span class="string">&#x27;è˜†æ´²&#x27;</span>, <span class="string">&#x27;å¤§æ©‹é ­&#x27;</span>), </span><br><span class="line">    (<span class="string">&#x27;è¿´é¾&#x27;</span>, <span class="string">&#x27;é ­å‰åº„&#x27;</span>), (<span class="string">&#x27;é ‚åŸ”&#x27;</span>, <span class="string">&#x27;æ¿æ©‹&#x27;</span>), (<span class="string">&#x27;å—å‹¢è§’&#x27;</span>, <span class="string">&#x27;æ™¯å®‰&#x27;</span>), </span><br><span class="line">    (<span class="string">&#x27;æ–°åº—&#x27;</span>, <span class="string">&#x27;å¤§åªæ—&#x27;</span>), (<span class="string">&#x27;å°ç¢§æ½­&#x27;</span>, <span class="string">&#x27;ä¸ƒå¼µ&#x27;</span>), (<span class="string">&#x27;æ¾å±±&#x27;</span>, <span class="string">&#x27;å—äº¬å¾©èˆˆ&#x27;</span>), </span><br><span class="line">    (<span class="string">&#x27;å‹•ç‰©åœ’&#x27;</span>, <span class="string">&#x27;å¤§å®‰&#x27;</span>), (<span class="string">&#x27;è±¡å±±&#x27;</span>, <span class="string">&#x27;å¤§å®‰&#x27;</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹†æˆ3æ®µç®—ï¼Œå¦å‰‡ç”¨æœ€çŸ­è·¯å¾‘ç®—æœƒç›´æ¥èµ°ä¸‹å»</span></span><br><span class="line">circles = [</span><br><span class="line">    (<span class="string">&quot;å—äº¬å¾©èˆˆ&quot;</span>, <span class="string">&quot;å…§æ¹–&quot;</span>), (<span class="string">&quot;å…§æ¹–&quot;</span>, <span class="string">&quot;å—æ¸¯&quot;</span>), (<span class="string">&quot;å—æ¸¯&quot;</span>, <span class="string">&quot;å¿ å­å¾©èˆˆ&quot;</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="compress-path"><a class="markdownIt-Anchor" href="#compress-path"></a> Compress path</h2>
<p>ç®—äº†ä¸€ä¸‹ï¼Œå‰©ä¸‹çš„ç¯€é»é‚„æ˜¯å¤ªå¤šäº†å•Šï¼Œé€™æ™‚å€™å°±æ‹¿å‡ºç¬¬äºŒæ‹›ã€Œ<strong>è·¯å¾‘å£“ç¸®</strong>ã€ï¼Œå°‡ä¸é‡è¦çš„ç¯€é»å¾è·¯å¾‘ä¸­ç§»é™¤ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œå¾å¤äº­åˆ°å¤§åªæ—é›–ç„¶è¦ç¶“é 4 ç«™ (å°é›»å¤§æ¨“ã€å…¬é¤¨ã€è¬éš†ã€æ™¯ç¾)ï¼Œä½†é€™ 4 å€‹ç«™éƒ½åœ¨åŒä¸€æ¢ç·šä¸Šä¸”æ²’æœ‰åˆ†æ”¯ï¼Œå¯ä»¥æŠŠå®ƒå€‘ç•¶ä½œæ˜¯é †ä¾¿ã€Œè·¯éã€ï¼Œå°‡é€™äº›ä¸­é–“çš„ç¯€é»ç§»é™¤ï¼Œç”¨é ­å°¾çš„ç¯€é»åšè¨ˆç®—å°±å¥½ã€‚<br />
å‰é¢æåˆ°çš„åœ“åœˆéƒ¨åˆ†å…¶å¯¦ä¹Ÿèƒ½ç®—æ˜¯ä¸€ç¨®è·¯ç·šå£“ç¸® (å¿ å­å¾©èˆˆ &lt;----&gt; å—äº¬å¾©èˆˆ)ï¼Œåªç•™ä¸‹é ­è·Ÿå°¾ï¼Œä¸­é–“éƒ¨åˆ†éƒ½çœç•¥ã€‚</p>
<p><img src="/images/2024/07/27/compress_path.png" alt="compress path" /></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Key Stations</span></span><br><span class="line">key_stations = [</span><br><span class="line">    <span class="string">&#x27;æ°‘æ¬Šè¥¿è·¯&#x27;</span>, <span class="string">&#x27;é›™é€£&#x27;</span>, <span class="string">&#x27;ä¸­å±±&#x27;</span>, <span class="string">&#x27;å°åŒ—è»Šç«™&#x27;</span>, <span class="string">&#x27;å°å¤§é†«é™¢&#x27;</span>, <span class="string">&#x27;ä¸­æ­£ç´€å¿µå ‚&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;ä¸­å±±åœ‹å°&#x27;</span>, <span class="string">&#x27;è¡Œå¤©å®®&#x27;</span>, <span class="string">&#x27;æ¾æ±Ÿå—äº¬&#x27;</span>, <span class="string">&#x27;å¿ å­æ–°ç”Ÿ&#x27;</span>, <span class="string">&#x27;æ±é–€&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;å¤äº­&#x27;</span>, <span class="string">&#x27;å—äº¬å¾©èˆˆ&#x27;</span>, <span class="string">&#x27;å¿ å­å¾©èˆˆ&#x27;</span>, <span class="string">&#x27;å¤§å®‰&#x27;</span>, <span class="string">&#x27;åŒ—é–€&#x27;</span>, <span class="string">&#x27;è¥¿é–€&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;å°å—é–€&#x27;</span>, <span class="string">&#x27;å–„å°å¯º&#x27;</span>, <span class="string">&#x27;é ­å‰åº„&#x27;</span>, <span class="string">&#x27;æ¿æ©‹&#x27;</span>, <span class="string">&#x27;æ™¯å®‰&#x27;</span>, <span class="string">&#x27;å¤§åªæ—&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># compress path</span></span><br><span class="line">n = <span class="built_in">len</span>(key_stations)</span><br><span class="line">graph = [[<span class="number">0</span>]*n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">sub_paths = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"><span class="keyword">for</span> start_idx <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> end_idx <span class="keyword">in</span> <span class="built_in">range</span>(start_idx+<span class="number">1</span>, n):</span><br><span class="line">        cost, path = dijkstra(original_graph, key_stations[start_idx], key_stations[end_idx])</span><br><span class="line">        graph[start_idx][end_idx] = cost</span><br><span class="line">        graph[end_idx][start_idx] = cost</span><br><span class="line">        sub_paths[start_idx][end_idx] = path</span><br><span class="line">        sub_paths[end_idx][start_idx] = path[::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘å€‘åªç”¨é ­è·Ÿå°¾å»è¨ˆç®—æœ€ä½³è·¯ç·šï¼Œé‚£æˆ‘å€‘è¦å¦‚ä½•ä¿è­‰ç®—æ³•æœƒç¶“éé‚£äº›è¢«æˆ‘å€‘åˆªæ‰çš„ç¯€é»å‘¢? åŒæ¨£èˆ‰åœ“åœˆéƒ¨åˆ†ç‚ºä¾‹ï¼Œè¦èµ°å…¥åœ“åœˆçš„å‰ææ˜¯å…¶ä¸­ä¸€æ®µè·¯çš„èµ·é»èˆ‡çµ‚é»åˆ†åˆ¥æ˜¯å—äº¬å¾©èˆˆæˆ–å¿ å­å¾©èˆˆï¼Œå¦‚æœç®—å‡ºä¾†æ ¹æœ¬ä¸æ˜¯é€™æ¨£èµ°å‘¢?</p>
<p>å…¶ä¸­ä¸€å€‹è§£æ±ºæ–¹æ³•æ˜¯ã€Œæä¾›èª˜å› ã€ï¼Œå¼•èª˜ç®—æ³•é¸æ“‡èµ°é€™äº›è·¯ç·šï¼Œå°æ–¼æœ€çŸ­è·¯å¾‘ç®—æ³•ä¾†èªªï¼Œæœ€å¤§çš„èª˜å› æ˜¯ä»€éº¼å‘¢? ç­”æ¡ˆå°±æ˜¯<strong>è·é›¢/æ™‚é–“</strong>ï¼Œåªè¦å°‡å…©é»ä¹‹é–“çš„è·é›¢/æ™‚é–“è¨­ç‚º 0ï¼Œé‚£ç®—æ³•ä¾¿æœƒæ›´åå¥½é€™æ¢è·¯å¾‘ã€‚(ç•¶ç„¶ï¼Œæœ€å¾Œæ˜¯æœƒåŠ å›å»çš„ã€‚)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¼•èª˜è·¯ç·š</span></span><br><span class="line">key_paths = [</span><br><span class="line">    (<span class="string">&quot;å¿ å­å¾©èˆˆ&quot;</span>, <span class="string">&quot;å—äº¬å¾©èˆˆ&quot;</span>), (<span class="string">&quot;æ°‘æ¬Šè¥¿è·¯&quot;</span>, <span class="string">&quot;é ­å‰åº„&quot;</span>), (<span class="string">&quot;è¥¿é–€&quot;</span>, <span class="string">&quot;æ¿æ©‹&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;å¤äº­&quot;</span>, <span class="string">&quot;æ™¯å®‰&quot;</span>), (<span class="string">&quot;å¤äº­&quot;</span>, <span class="string">&quot;å¤§åªæ—&quot;</span>), (<span class="string">&quot;å¤§å®‰&quot;</span>, <span class="string">&quot;æ±é–€&quot;</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">adjusted_graph = [row[:] <span class="keyword">for</span> row <span class="keyword">in</span> graph]</span><br><span class="line"><span class="keyword">for</span> start, end <span class="keyword">in</span> key_paths:</span><br><span class="line">    start_idx = key_stations.index(start)</span><br><span class="line">    end_idx = key_stations.index(end)</span><br><span class="line">    adjusted_graph[start_idx][end_idx] = <span class="number">0</span></span><br><span class="line">    adjusted_graph[end_idx][start_idx] = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>æ—¢ç„¶é€™å€‹åšæ³•è½èµ·ä¾†é‚£éº¼è®šï¼Œé‚£å°±æŠŠçœ‹èµ·ä¾†èƒ½å£“ç¸®çš„è·¯ç·šå…¨éƒ¨å£“ä¸€éå§? å¾ˆéºæ†¾ï¼Œä¹Ÿä¸æ˜¯æ‰€æœ‰è·¯ç·šéƒ½ç®¡ç”¨ï¼Œèˆ‰ä¾‹ï¼Œå¾æ°‘æ¬Šè¥¿è·¯ç¶“ä¸­å±±åœ‹ä¸­ã€è¡Œå¤©å®®åˆ°æ¾æ±Ÿå—äº¬çš„è·¯ç·šï¼Œå°±ç®—å°‡è·é›¢è¨­ç‚º0ï¼Œåœ¨å¾ˆå¤šæƒ…æ³ä¸‹ç®—æ³•é‚„æ˜¯ä¸æœƒç¶“éï¼Œè€Œæ˜¯é¸æ“‡èµ°å…¶ä»–æ¢è·¯ï¼Œå…·é«”ä¾†èªªç©¶ç«Ÿå“ªäº›å¯ä»¥å£“ç¸®å“ªäº›ä¸è¡Œæˆ‘ä¹Ÿèªªä¸æ¸…æ¥šï¼Œå¦‚æœæœ‰æƒ³æ³•çš„è©±æ­¡è¿æä¾›å»ºè­°! æ•´é«”ä¾†èªªï¼Œå°‡è·¯ç·šå¯†é›†å€çš„ç¯€é»ä¿ç•™èµ·ä¾†ï¼Œå¯ä»¥ä¿ç•™å„ç¨®è·¯ç·šè¢«ç®—æ³•å˜—è©¦çš„å¯èƒ½æ€§ã€‚</p>
<h2 id="ç®—æ³•å¯¦ç¾"><a class="markdownIt-Anchor" href="#ç®—æ³•å¯¦ç¾"></a> ç®—æ³•å¯¦ç¾</h2>
<h3 id="held-karp"><a class="markdownIt-Anchor" href="#held-karp"></a> Held Karp</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">held_karp</span>(<span class="params">graph, adjusted_graph, start, end</span>):</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    graph: n*n çš„ matrix of distance</span></span><br><span class="line"><span class="string">    adjusted_graph: n*n çš„ matrix of adjusted distance</span></span><br><span class="line"><span class="string">    start: (int) èµ·é»çš„ index</span></span><br><span class="line"><span class="string">    end: (int) çµ‚é»çš„ index</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">len</span>(adjusted_graph)</span><br><span class="line">    dp = [[<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)] * n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; n)]</span><br><span class="line">    parent = [[-<span class="number">1</span>] * n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; n)]  <span class="comment"># ç”¨ä¾†è¿½è¹¤è·¯å¾‘</span></span><br><span class="line">    dp[<span class="number">1</span> &lt;&lt; start][start] = <span class="number">0</span>  <span class="comment"># èµ·é»ï¼Œstart</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> mask <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; n)):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (mask &amp; (<span class="number">1</span> &lt;&lt; i)):</span><br><span class="line">                <span class="keyword">continue</span>  <span class="comment"># ç¯€é» i ä¸åœ¨ç•¶å‰çš„å­é›†ä¸­</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                <span class="keyword">if</span> mask &amp; (<span class="number">1</span> &lt;&lt; j):</span><br><span class="line">                    <span class="keyword">continue</span>  <span class="comment"># ç¯€é» j å·²ç¶“åœ¨å­é›†ä¸­</span></span><br><span class="line">                new_mask = mask | (<span class="number">1</span> &lt;&lt; j) <span class="comment"># å°‡ç¯€é» j åŠ å…¥å­é›†</span></span><br><span class="line">                <span class="keyword">if</span> dp[new_mask][j] &gt; dp[mask][i] + adjusted_graph[i][j]:</span><br><span class="line">                    dp[new_mask][j] = dp[mask][i] + adjusted_graph[i][j]</span><br><span class="line">                    parent[new_mask][j] = i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¨ˆç®—åˆ°é”çµ‚é»çš„æœ€å°æˆæœ¬</span></span><br><span class="line">    min_cost = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line">    last_node = -<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        cost = dp[(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>][i] + graph[i][end] <span class="comment"># å›èµ·é»æ‰€èŠ±è²»çš„æˆæœ¬è¦ç”¨åŸæœ¬çš„ graph åšè¨ˆç®—</span></span><br><span class="line">        <span class="keyword">if</span> min_cost &gt; cost:</span><br><span class="line">            min_cost = cost</span><br><span class="line">            last_node = i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é‡å»ºè·¯å¾‘</span></span><br><span class="line">    path = []</span><br><span class="line">    mask = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> last_node != -<span class="number">1</span>:</span><br><span class="line">        path.append(last_node)</span><br><span class="line">        new_mask = mask ^ (<span class="number">1</span> &lt;&lt; last_node)</span><br><span class="line">        last_node = parent[mask][last_node]</span><br><span class="line">        mask = new_mask</span><br><span class="line">    </span><br><span class="line">    path.reverse()</span><br><span class="line">    <span class="keyword">if</span> path[-<span class="number">1</span>] != end:</span><br><span class="line">        path.append(end)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> min_cost, path</span><br></pre></td></tr></table></figure>
<h3 id="dijkstra"><a class="markdownIt-Anchor" href="#dijkstra"></a> Dijkstra</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">graph, start, end</span>):</span><br><span class="line">    <span class="comment"># å„²å­˜å¾èµ·é»åˆ°å„é»çš„æœ€çŸ­è·é›¢</span></span><br><span class="line">    distances = &#123;vertex: <span class="built_in">float</span>(<span class="string">&#x27;infinity&#x27;</span>) <span class="keyword">for</span> vertex <span class="keyword">in</span> graph&#125;</span><br><span class="line">    distances[start] = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    previous_nodes = &#123;vertex: <span class="literal">None</span> <span class="keyword">for</span> vertex <span class="keyword">in</span> graph&#125; <span class="comment"># ç´€éŒ„å‰ä¸€å€‹é»</span></span><br><span class="line">    priority_queue = [(<span class="number">0</span>, start)] <span class="comment"># min heap</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> priority_queue:</span><br><span class="line">        current_distance, current_vertex = heapq.heappop(priority_queue)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current_vertex == end: <span class="comment"># æŠµé”çµ‚é»å³åœæ­¢è¨ˆç®—</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> current_distance &gt; distances[current_vertex]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> neighbor, weight <span class="keyword">in</span> graph[current_vertex].items():</span><br><span class="line">            distance = current_distance + weight</span><br><span class="line">            <span class="keyword">if</span> distance &lt; distances[neighbor]: <span class="comment"># æ‰¾åˆ°æ›´çŸ­è·¯å¾‘å‰‡æ›´æ–°è·é›¢ã€åŠ å…¥ä½‡åˆ—</span></span><br><span class="line">                distances[neighbor] = distance</span><br><span class="line">                previous_nodes[neighbor] = current_vertex</span><br><span class="line">                heapq.heappush(priority_queue, (distance, neighbor))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é‡å»ºæœ€çŸ­è·¯å¾‘</span></span><br><span class="line">    path = []</span><br><span class="line">    current_node = end</span><br><span class="line">    <span class="keyword">while</span> current_node <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        path.append(current_node)</span><br><span class="line">        current_node = previous_nodes[current_node]</span><br><span class="line">    path.reverse()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> distances[end], path</span><br></pre></td></tr></table></figure>
<h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a class="markdownIt-Anchor" href="#å®Œæ•´ç¨‹å¼ç¢¼"></a> å®Œæ•´ç¨‹å¼ç¢¼</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> data <span class="keyword">import</span> key_stations, key_paths, lines, tails, circles</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">from</span> dijkstra <span class="keyword">import</span> dijkstra</span><br><span class="line"><span class="keyword">from</span> held_karp <span class="keyword">import</span> held_karp</span><br><span class="line"></span><br><span class="line"><span class="comment"># build graph</span></span><br><span class="line">original_graph = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    <span class="keyword">for</span> edge <span class="keyword">in</span> line[<span class="string">&quot;TravelTimes&quot;</span>]:</span><br><span class="line">        start = edge[<span class="string">&#x27;FromStationName&#x27;</span>][<span class="string">&#x27;Zh_tw&#x27;</span>]</span><br><span class="line">        end = edge[<span class="string">&#x27;ToStationName&#x27;</span>][<span class="string">&#x27;Zh_tw&#x27;</span>]</span><br><span class="line">        time = edge[<span class="string">&quot;RunTime&quot;</span>]</span><br><span class="line">        original_graph[start][end] = time</span><br><span class="line">        original_graph[end][start] = time</span><br><span class="line"></span><br><span class="line"><span class="comment"># cacluate cost of tails, round-trip</span></span><br><span class="line">tail_cost = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> start, end <span class="keyword">in</span> tails:</span><br><span class="line">    cost, path = dijkstra(original_graph, start, end)</span><br><span class="line">    tail_cost += cost * <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cacluate cost of circles, one-way</span></span><br><span class="line">circle_cost = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> start, end <span class="keyword">in</span> circles:</span><br><span class="line">    cost, path = dijkstra(original_graph, start, end)</span><br><span class="line">    circle_cost += cost</span><br><span class="line"></span><br><span class="line"><span class="comment"># compress path</span></span><br><span class="line">n = <span class="built_in">len</span>(key_stations)</span><br><span class="line">graph = [[<span class="number">0</span>]*n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">sub_paths = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"><span class="keyword">for</span> start_idx <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> end_idx <span class="keyword">in</span> <span class="built_in">range</span>(start_idx+<span class="number">1</span>, n):</span><br><span class="line">        cost, path = dijkstra(original_graph, key_stations[start_idx], key_stations[end_idx])</span><br><span class="line">        graph[start_idx][end_idx] = cost</span><br><span class="line">        graph[end_idx][start_idx] = cost</span><br><span class="line">        sub_paths[start_idx][end_idx] = path</span><br><span class="line">        sub_paths[end_idx][start_idx] = path[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># adjust compressed graph</span></span><br><span class="line">adjusted_graph = [row[:] <span class="keyword">for</span> row <span class="keyword">in</span> graph]</span><br><span class="line"><span class="keyword">for</span> start, end <span class="keyword">in</span> key_paths:</span><br><span class="line">    start_idx = key_stations.index(start)</span><br><span class="line">    end_idx = key_stations.index(end)</span><br><span class="line">    adjusted_graph[start_idx][end_idx] = <span class="number">0</span></span><br><span class="line">    adjusted_graph[end_idx][start_idx] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># held karp</span></span><br><span class="line">start_station = <span class="string">&quot;å°åŒ—è»Šç«™&quot;</span></span><br><span class="line">end_station = <span class="string">&quot;å°åŒ—è»Šç«™&quot;</span></span><br><span class="line">start_idx = key_stations.index(start_station)</span><br><span class="line">end_idx = key_stations.index(end_station)</span><br><span class="line">core_cost, path = held_karp(graph, adjusted_graph, start_idx, end_idx)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add key_path back, start from 1</span></span><br><span class="line"><span class="keyword">for</span> start, end <span class="keyword">in</span> key_paths[<span class="number">1</span>:]:</span><br><span class="line">    start_idx = key_stations.index(start)</span><br><span class="line">    end_idx = key_stations.index(end)</span><br><span class="line">    core_cost += graph[start_idx][end_idx]</span><br><span class="line"></span><br><span class="line"><span class="comment"># show result</span></span><br><span class="line">total_cost = tail_cost + circle_cost + core_cost</span><br><span class="line">h = total_cost // <span class="number">3600</span></span><br><span class="line">m = total_cost // <span class="number">60</span> % <span class="number">60</span></span><br><span class="line">s = total_cost % <span class="number">60</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ç¸½è€—æ™‚: <span class="subst">&#123;h&#125;</span>h <span class="subst">&#123;m&#125;</span>m <span class="subst">&#123;s&#125;</span>s&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ ¸å¿ƒéƒ¨åˆ†è·¯ç·š:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(path)-<span class="number">1</span>):</span><br><span class="line">    start_idx = path[i]</span><br><span class="line">    end_idx = path[i+<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>. <span class="subst">&#123;<span class="string">&#x27;--&gt;&#x27;</span>.join(sub_paths[start_idx][end_idx])&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="çµæœ"><a class="markdownIt-Anchor" href="#çµæœ"></a> çµæœ</h2>
<p>çµ‚æ–¼ä¾†åˆ°æœ¬ç¯‡æ–‡ç« ç²¾è¯? æ ¹æ“šè¨ˆç®—çµæœï¼Œå¾å°åŒ—è»Šç«™å‡ºç™¼ï¼Œéæ­· 109 å€‹è»Šç«™ï¼Œä¸¦åœ¨æœ€å¾Œå›åˆ°å°åŒ—è»Šç«™æ‰€éœ€èŠ±è²»çš„æ™‚é–“æ˜¯<strong>4å°æ™‚52åˆ†é˜7ç§’</strong>ï¼Œæ ¸å¿ƒè·¯ç·šå¦‚ä¸‹ï¼Œè¨˜å¾—é‡åˆ° tails èˆ‡ circle æ™‚è¦ç¹éå»å°±è¡Œäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. å°åŒ—è»Šç«™--&gt;å–„å°å¯º</span><br><span class="line">2. å–„å°å¯º--&gt;å¿ å­æ–°ç”Ÿ</span><br><span class="line">3. å¿ å­æ–°ç”Ÿ--&gt;æ±é–€</span><br><span class="line">4. æ±é–€--&gt;å¤§å®‰æ£®æ—å…¬åœ’--&gt;å¤§å®‰</span><br><span class="line">5. å¤§å®‰--&gt;å¿ å­å¾©èˆˆ</span><br><span class="line">6. å¿ å­å¾©èˆˆ--&gt;å—äº¬å¾©èˆˆ</span><br><span class="line">7. å—äº¬å¾©èˆˆ--&gt;æ¾æ±Ÿå—äº¬</span><br><span class="line">8. æ¾æ±Ÿå—äº¬--&gt;è¡Œå¤©å®®</span><br><span class="line">9. è¡Œå¤©å®®--&gt;ä¸­å±±åœ‹å°</span><br><span class="line">10. ä¸­å±±åœ‹å°--&gt;æ°‘æ¬Šè¥¿è·¯--&gt;é›™é€£--&gt;ä¸­å±±</span><br><span class="line">11. ä¸­å±±--&gt;é›™é€£</span><br><span class="line">12. é›™é€£--&gt;æ°‘æ¬Šè¥¿è·¯</span><br><span class="line">13. æ°‘æ¬Šè¥¿è·¯--&gt;å¤§æ©‹é ­--&gt;å°åŒ—æ©‹--&gt;èœå¯®--&gt;ä¸‰é‡--&gt;å…ˆå—‡å®®--&gt;é ­å‰åº„</span><br><span class="line">14. é ­å‰åº„--&gt;æ–°åŸ”æ°‘ç”Ÿ--&gt;æ¿æ©‹</span><br><span class="line">15. æ¿æ©‹--&gt;æ–°åŸ”--&gt;æ±Ÿå­ç¿ --&gt;é¾å±±å¯º--&gt;è¥¿é–€</span><br><span class="line">16. è¥¿é–€--&gt;åŒ—é–€</span><br><span class="line">17. åŒ—é–€--&gt;è¥¿é–€--&gt;å°å—é–€</span><br><span class="line">18. å°å—é–€--&gt;ä¸­æ­£ç´€å¿µå ‚--&gt;å¤äº­--&gt;é ‚æºª--&gt;æ°¸å®‰å¸‚å ´--&gt;æ™¯å®‰</span><br><span class="line">19. æ™¯å®‰--&gt;æ™¯å¹³--&gt;ç§€æœ—æ©‹--&gt;åå››å¼µ--&gt;å¤§åªæ—</span><br><span class="line">20. å¤§åªæ—--&gt;æ™¯ç¾--&gt;è¬éš†--&gt;å…¬é¤¨--&gt;å°é›»å¤§æ¨“--&gt;å¤äº­</span><br><span class="line">21. å¤äº­--&gt;ä¸­æ­£ç´€å¿µå ‚</span><br><span class="line">22. ä¸­æ­£ç´€å¿µå ‚--&gt;å°å¤§é†«é™¢</span><br><span class="line">23. å°å¤§é†«é™¢--&gt;å°åŒ—è»Šç«™</span><br></pre></td></tr></table></figure>
<p>ä¸éèªªçœŸçš„ï¼Œé›–ç„¶è·¯ç·šå¯èƒ½æ˜¯æœ€å¥½æ²’éŒ¯ï¼Œä½†é€™å€‹è¨ˆç®—çµæœè‚¯å®šæ˜¯ä½ä¼°å¤šäº†ï¼ŒåŸå› å¦‚æ–‡ç« ä¸­æ‰€æï¼Œä¸¦æ²’æœ‰å°‡ç­æ¬¡èˆ‡è½‰ä¹˜çš„å› ç´ è€ƒæ…®é€²å»ã€‚<br />
å†è€…ï¼Œé€™åªæ˜¯ã€Œéæ­·ã€æ‰€èŠ±è²»çš„æ™‚é–“ï¼Œå¤§å®¶é‚„è¨˜å¾—æ´»å‹•çš„ç›®çš„æ˜¯è¦é›†ç« å—? é€™äº›é›†ç« çš„æ©Ÿå°å¤§å¤šéƒ½åœ¨ç«™å¤–ï¼Œä¹Ÿå°±æ˜¯ä½ å„ä½è¦å‡ºç«™å•Š ğŸ˜‚ğŸ˜‚ğŸ˜‚ï¼Œä¿å®ˆä¸€é»ç®—ï¼Œå‡è¨­æ¯ç«™è¦å¤šåœç•™5åˆ†é˜ï¼Œæ›ç®—ä¸‹ä¾†å·®ä¸å¤šå°±è¦å†å¤šå€‹ 9 å°æ™‚ï¼Œé€™é‚„åªæ˜¯ä¿å®ˆï¼Œæƒ³è²·æ·é‹ä¸€æ—¥ç¥¨åœ¨ä¸€å¤©å…§é›†é½Šæ‰€æœ‰ç« ä¸æ˜¯ä¸å¯èƒ½ï¼Œä½†é€™è¡¨ç¤ºä¸€å¤§æ—©å°±è¦é–‹å§‹é›†ç« ï¼Œä¸¦ä¸”æ•´å¤©éƒ½è¦å¾ˆèªçœŸåœ°è·‘è·¯ç·šæ‰èƒ½è¾¦åˆ°ï¼Œå¯¦åœ¨å¤ªç´¯äººäº†å•Šï¼Œé€™è£¡å¼·çƒˆå»ºè­°:<br />
<em>â€œè²·æœˆç¥¨æˆ–è·Ÿæœ‰æœˆç¥¨çš„æœ‹å‹å€Ÿï¼Œåˆ†å¹¾å¤©æ…¢æ…¢è·‘å®Œï¼Œæ¯”è¼ƒè¼•é¬†é‚„ä¸ç”¨å¤šèŠ±åŠæ¯›éŒ¢å–”â€</em> ğŸ˜‰</p>
]]></content>
      <categories>
        <category>DSA</category>
      </categories>
      <tags>
        <tag>Held Karp</tag>
        <tag>Dijkstra</tag>
        <tag>TSP</tag>
      </tags>
  </entry>
  <entry>
    <title>Implement Trie (å­—å…¸æ¨¹)</title>
    <url>/posts/DSA/2023/trie/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p>ä»Šå¤©åœ¨å¯«LeetCodeæ¯æ—¥ä¸€é¡Œæ™‚é‡åˆ°<a href="https://leetcode.com/problems/implement-trie-prefix-tree/description/">208. Implement Trie (Prefix Tree)</a>ï¼Œä¹‹å‰å› ç‚ºè¦ºå¾—Trieå¥½åƒå¾ˆé›£æ‰€ä»¥ä¸€ç›´ä¸é¡˜é¢å°ï¼Œä½†é€™é¡Œå°±æ˜¯è¦è·ŸTrieçš„ç›´çƒå°æ±ºäº†æƒ³èº²ä¹Ÿèº²ä¸æ‰XDï¼ŒAnywayï¼Œçœ‹äº†ä¸€ä¸‹ç™¼ç¾Trieå…¶å¯¦è »å¥½ç†è§£çš„ï¼Œä»Šå¤©å°±ä¾†èªè­˜ä¸€ä¸‹Trieï¼Œç„¶å¾Œçœ‹çœ‹é€™ä¸€é¡Œå¯ä»¥æ€éº¼å¯«å§ï¼(Python, C++)</p>
<span id="more"></span>
<h1 id="trie-ä»‹ç´¹"><a class="markdownIt-Anchor" href="#trie-ä»‹ç´¹"></a> Trie ä»‹ç´¹</h1>
<p>Trieçš„ä¸­æ–‡å¯ä»¥å«åšå­—å…¸æ¨¹ã€å­—é¦–æ¨¹æˆ–å‰ç¶´æ¨¹ï¼Œé¡§åæ€ç¾©æ˜¯ä¸€ç¨®æ¨¹ç‹€çµæ§‹ï¼Œå¸¸è¢«ç”¨ä¾†æª¢ç´¢æ–‡æœ¬ä¸­çš„å–®è©æˆ–å‰ç¶´(prefix)ã€‚</p>
<p>å­—å…¸æ¨¹æœ‰å¹¾å€‹æ€§è³ªï¼Œé€™è£¡æ­é…ä¸‹æ–¹åœ–ç‰‡åšä»‹ç´¹ï¼š</p>
<ol>
<li>æ¯å€‹ç¯€é»ä»£è¡¨ä¸€å€‹å­—ç¬¦ï¼Œä¸¦ä¸”å–®å­—çš„çµå°¾æœ‰æ¨™è¨˜ï¼Œèˆ‰ä¾‹ä¾†èªªå–®å­—&quot;ten&quot;æœƒä¾åºç¶“étã€eã€nä¸‰å€‹ç¯€é»ï¼Œå…¶ä¸­næ˜¯çµå°¾(ç¶ è‰²)ã€‚</li>
<li>ç¯€é»æ˜¯å¯ä»¥è¢«å…±ç”¨çš„ï¼Œèˆ‰ä¾‹ä¾†èªª&quot;sun&quot;åŠ&quot;sup&quot;å°±å…±ç”¨äº†sã€uå…©å€‹ç¯€é»ã€‚</li>
<li>è‘‰å­ç¯€é»ä¸€å®šæ˜¯å–®å­—çµå°¾ï¼Œä½†éè‘‰ç¯€é»ä¹Ÿå¯ä»¥æ˜¯çµå°¾ï¼Œèˆ‰ä¾‹ä¾†èªª&quot;an&quot;åŠ&quot;and&quot;åˆ†åˆ¥æ˜¯å…©å€‹å–®å­—ï¼Œå…¶ä¸­nåŠdéƒ½æ˜¯å–®å­—çš„çµå°¾(ç¶ è‰²)ã€‚</li>
</ol>
<p><img src="/images/2023/03/18/trie.png" alt="trie" /><br />
å­—å…¸æ¨¹çš„å„ªé»æ˜¯å¯ä»¥å¿«é€ŸæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œä¸”å¯ä»¥æŒ‰ç…§å­—å…¸åºé€²è¡Œæ’åºã€‚ä½†ç¼ºé»æ˜¯éœ€è¦è¼ƒå¤§çš„ç©ºé–“ä¾†å­˜å„²ï¼Œä¸”æ’å…¥å’Œåˆªé™¤æ“ä½œç›¸å°è¼ƒæ…¢ã€‚</p>
<h1 id="å¯¦ä½œ-trie"><a class="markdownIt-Anchor" href="#å¯¦ä½œ-trie"></a> å¯¦ä½œ Trie</h1>
<p>å¯¦ä½œçš„å…§å®¹å°±æ˜¯ä¸€é–‹å§‹æåˆ°çš„LeetCode 208ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯è¦åšå‡ºåˆå§‹åŒ–ã€æ’å…¥ã€å°‹æ‰¾åŠå°‹æ‰¾å‰ç¶´4å€‹åŠŸèƒ½ï¼Œè©³ç´°é¡Œç›®å¯ä»¥è‡ªå·±åˆ°LeetCodeå»çœ‹ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒTrie æœ‰å…©ç¨®å¯¦ä½œæ–¹æ³•ï¼Œç¬¬ä¸€å€‹æ–¹æ³•ç›¸ç•¶ç›´è¦ºï¼Œå°±æ˜¯ç”¨æŒ‡é‡é€£çµå„å€‹ç¯€é»ä¾†æ¨¡æ“¬å‡ºä¸€å€‹æ¨¹ç‹€çµæ§‹ï¼›ç¬¬äºŒå€‹æ–¹æ³•å‰‡æ˜¯å‹•æ…‹èªè¨€é™å®šï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥ç”¨hash tableä¾†å„²å­˜å­—ç¬¦ï¼Œæ¥ä¸‹ä¾†åˆ†åˆ¥ç”¨C++åŠPythonä¾†æ¼”ç¤ºé€™å…©ç¨®æ–¹æ³•ã€‚</p>
<h2 id="æ–¹æ³•ä¸€-pointers-c"><a class="markdownIt-Anchor" href="#æ–¹æ³•ä¸€-pointers-c"></a> æ–¹æ³•ä¸€: Pointers (C++)</h2>
<p>é‡é»</p>
<ul>
<li>è‹±æ–‡å­—æ¯åªæœ‰26å€‹ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨arrayï¼Œä»¥index(<code>w-'a'</code>)ä¾†è¡¨ç¤ºå­—ç¬¦ã€‚</li>
<li>prefixçš„éƒ¨åˆ†åªè¦ç¯€é»å­˜åœ¨å°±OKï¼Œä½†searchçš„éƒ¨åˆ†é‚„è¦æª¢æŸ¥æ˜¯ä¸æ˜¯çµå°¾ã€‚</li>
<li>å¦å¤–å®šç¾©ä¸€å€‹structè€Œä¸æ˜¯ç›´æ¥newåŸæœ¬çš„classï¼Œæ˜¯å› ç‚ºstructçš„çµæ§‹æ¯”classç°¡å–®çš„å¤š(æ²’æœ‰function)ï¼Œå¯ä»¥æå‡åŸ·è¡Œæ•ˆç‡ã€‚</li>
<li>ä½¿ç”¨éœæ…‹å®£å‘Š(array)æ‰€ä»¥ä¸ç”¨æ“”å¿ƒmemory leakã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">  Node* children[<span class="number">26</span>];</span><br><span class="line">  <span class="type">bool</span> is_word = <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Trie</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Node* root;</span><br><span class="line">    <span class="built_in">Trie</span>() &#123;</span><br><span class="line">        root = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string word)</span> </span>&#123;</span><br><span class="line">        Node* curr = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> w: word) &#123;</span><br><span class="line">            <span class="keyword">if</span>(curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>] == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>] = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        curr-&gt;is_word = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">search</span><span class="params">(string word)</span> </span>&#123;</span><br><span class="line">        Node* curr = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> w: word) &#123;</span><br><span class="line">            <span class="keyword">if</span>(curr == <span class="literal">NULL</span> || curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>] == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> curr-&gt;is_word;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">startsWith</span><span class="params">(string prefix)</span> </span>&#123;</span><br><span class="line">        Node* curr = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> w: prefix) &#123;</span><br><span class="line">            <span class="keyword">if</span>(curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>] == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr-&gt;children[w-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="æ–¹æ³•äºŒ-hash-table-python"><a class="markdownIt-Anchor" href="#æ–¹æ³•äºŒ-hash-table-python"></a> æ–¹æ³•äºŒ: Hash Table (Python)</h2>
<p>é‡é»</p>
<ul>
<li>ç”¨ç‰¹æ®Šç¬¦è™Ÿ(#)ä¾†æ¨™è¨˜å–®å­—çµå°¾ã€‚</li>
<li>å› ç‚ºå‹•æ…‹èªè¨€ä¸­çš„è³‡æ–™å‹æ…‹æ˜¯å‹•æ…‹æ±ºå®šçš„ï¼Œæ‰€ä»¥Hash Tableå…§å¯ä»¥åŒæ™‚å„²å­˜ä¸åŒè³‡æ–™å‹æ…‹(å­˜ä¸‹ä¸€å±¤/å­˜çµå°¾)ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Trie</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._root = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert</span>(<span class="params">self, word: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        curr = self._root</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> curr:</span><br><span class="line">                curr[w] = &#123;&#125;</span><br><span class="line">            curr = curr[w]</span><br><span class="line">        curr[<span class="string">&quot;#&quot;</span>] = <span class="literal">True</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">self, word: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        curr = self._root</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">in</span> curr:</span><br><span class="line">                curr = curr[w]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> curr.get(<span class="string">&quot;#&quot;</span>, <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">startsWith</span>(<span class="params">self, prefix: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        curr = self._root</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> prefix:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">in</span> curr:</span><br><span class="line">                curr = curr[w]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<h1 id="ç›¸é—œæ–‡ç« "><a class="markdownIt-Anchor" href="#ç›¸é—œæ–‡ç« "></a> ç›¸é—œæ–‡ç« </h1>
<p><a href="/posts/DSA/2023/trie-2/">Trie (å­—å…¸æ¨¹) - Design Add and Search Words Data Structure</a></p>
<h1 id="çµèª"><a class="markdownIt-Anchor" href="#çµèª"></a> çµèª</h1>
<p>Trieçš„åŸºæœ¬è§€å¿µèªªå¯¦åœ¨é‚„è »ç°¡å–®çš„ï¼Œé›£æ‡‰è©²æ˜¯é›£åœ¨ä¹‹å¾Œçš„æ‡‰ç”¨ï¼Œä¹‹å¾Œæœ‰æ©Ÿæœƒçœ‹èƒ½ä¸èƒ½æ›´æ–°ä¸€äº›é€²éšçš„è§€å¿µï¼Œåƒæ˜¯æœå°‹å¼•æ“ä¹‹é¡çš„ã€‚</p>
<h1 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h1>
<p><a href="https://www.youtube.com/watch?v=f48wGD-MuQw">https://www.youtube.com/watch?v=f48wGD-MuQw</a></p>
]]></content>
      <categories>
        <category>DSA</category>
      </categories>
      <tags>
        <tag>Trie</tag>
        <tag>LeetCode</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨ A* Search Algorithm èµ°è¿·å®®</title>
    <url>/posts/DSA/2024/a-star-search-algorithm/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2>
<p>å‰ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† <a href="/posts/DSA/2024/ellers-algorithm/">Ellerâ€™s Algorithm è¿·å®®ç”Ÿæˆç®—æ³•</a> ä¾†ç”Ÿæˆè¿·å®®ï¼Œé€™ä¸€ç¯‡æ–‡ç« æœƒå…ˆä»‹ç´¹ A* Algorithmï¼Œä¸¦ä½¿ç”¨ A* Search Algorithm ä¾†æ”»ç•¥è¿·å®®ï¼Œå…ˆå·çœ‹ä¸€ä¸‹æˆæœ:<br />
<img src="/images/2024/08/10/maze_animation.gif" alt="maze_animation" class="seventy"></p>
<span id="more"></span>
<h2 id="a-search-algorithm"><a class="markdownIt-Anchor" href="#a-search-algorithm"></a> A* Search Algorithm</h2>
<p>A* æ˜¯ä¸€ç¨®æœ€çŸ­è·¯å¾‘ç®—æ³•ï¼Œå®ƒè·Ÿ Dijkstra éå¸¸åœ°ç›¸ä¼¼ï¼Œéƒ½æœƒæ ¹æ“šæŸå€‹å„ªå…ˆåºä¾†é¸æ“‡ä¸‹ä¸€æ­¥è¦èµ°çš„è·¯å¾‘ï¼Œå”¯ä¸€ä¸åŒçš„é»æ˜¯ Dijkstra çš„å„ªå…ˆåºåªè€ƒé‡äº†ç›®å‰ã€Œå·²èµ°çš„è·é›¢ã€ï¼Œå› æ­¤å®ƒçš„æœå°‹æ–¹å‘æœƒæœå››å‘¨ç™¼æ•£ã€‚ä½†æˆ‘å€‘åœ¨æœå°‹è·¯å¾‘æ™‚é€šå¸¸æœƒæ˜¯æœ‰ç›®çš„åœ°ï¼Œä¹Ÿå°±æ˜¯çŸ¥é“æ–¹å‘çš„ï¼Œä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œæˆ‘å€‘ä¸æœƒæƒ³å¾€åæ–¹å‘å°‹æ‰¾æœ€çŸ­è·¯å¾‘ï¼Œæ‰€ä»¥ A* åœ¨ Dijkstra çš„åŸºç¤ä¸Šå¤šè€ƒæ…®äº†æœªä¾†ã€Œé æœŸè¦èµ°çš„è·é›¢ã€ã€‚</p>
<p>ç°¡å–®åœ°å»ç†è§£ï¼Œã€Œå·²èµ°çš„è·é›¢ã€+ã€Œé æœŸè¦èµ°çš„è·é›¢ã€åŸºæœ¬ä¸Šå°±æœƒæ˜¯æ•´è¶Ÿè·¯çš„è·é›¢ï¼Œè€Œç›´æ¥ç”¨æ•´è¶Ÿè·¯çš„è·é›¢ä¾†æ’åºå„ªç·šåºï¼Œå¤§éƒ¨åˆ†æƒ…æ³ä¸‹éƒ½èƒ½å¹«åŠ©æˆ‘å€‘æ›´å¿«æ‰¾åˆ°æœ€çŸ­è·¯å¾‘ï¼Œé€™å–æ±ºæ–¼æˆ‘å€‘å°é æœŸçš„ä¼°ç®—æ˜¯å¦æº–ç¢ºã€‚ä¸éä¹Ÿä¸ç”¨æƒ³å¾—å¤ªè¤‡é›œï¼Œå°æ–¼é€™å€‹é æœŸï¼Œé€šå¸¸ç›´æ¥ç”¨ç°¡å–®çš„è·é›¢å‡½å¼æ±‚å¾—å°±å¥½ï¼Œå¦‚æ­å¹¾é‡Œå¾·è·é›¢æˆ–æ›¼å“ˆé “è·é›¢ã€‚</p>
<p>ä»¥ä¸‹åœ–ä¾†èªªï¼Œæ©˜è‰²æ˜¯å·²èµ°çš„è·é›¢ï¼ŒDijkstra åªæœƒè€ƒæ…®é€™ä¸€æ®µï¼Œè—è‰²å‰‡æ˜¯é æœŸè¦èµ°çš„è·é›¢ï¼Œæ©˜è‰²+è—è‰²å°±æ˜¯ A* æœƒè€ƒæ…®çš„ç¯„åœã€‚</p>
<img src="/images/2024/08/10/distance.png" alt="distance" class="fifty">
<h2 id="python-å¯¦ç¾"><a class="markdownIt-Anchor" href="#python-å¯¦ç¾"></a> Python å¯¦ç¾</h2>
<p>ä¸èƒ½èªªè·Ÿ Dijkstra å¾ˆåƒï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€æ¨¡ä¸€æ¨£ï¼Œåªæ˜¯æŠŠ priority queue è£¡é¢å…§å®¹æ›æˆæ•´è¶Ÿè·¯çš„è·é›¢ã€‚</p>
<h3 id="æœç´¢è·¯å¾‘"><a class="markdownIt-Anchor" href="#æœç´¢è·¯å¾‘"></a> æœç´¢è·¯å¾‘</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">future_cost</span>(<span class="params">y, x, target_y, target_x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(y-target_y) + <span class="built_in">abs</span>(x-target_x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">barrier</span>(<span class="params">graph, y, x, i, j</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> graph[y][x] &amp; <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> j == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> graph[y][x] &amp; <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i == -<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> graph[y-<span class="number">1</span>][x] &amp; <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> graph[y][x-<span class="number">1</span>] &amp; <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a_star</span>(<span class="params">graph, start_y, start_x, target_y, target_x</span>):</span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">len</span>(graph)</span><br><span class="line">    m = <span class="built_in">len</span>(graph[<span class="number">0</span>])</span><br><span class="line">    ways = [(<span class="number">0</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">0</span>), (<span class="number">0</span>, -<span class="number">1</span>), (-<span class="number">1</span>, <span class="number">0</span>)]</span><br><span class="line"></span><br><span class="line">    min_cost = [[<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)]*m <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    min_cost[start_y][start_x] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    prev = [[<span class="literal">None</span>]*m <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    heap = [(<span class="number">0</span>, <span class="number">0</span>, start_y, start_x)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># find path, update distance</span></span><br><span class="line">    <span class="keyword">while</span> heap:</span><br><span class="line">        _, past_cost, y, x = heapq.heappop(heap)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> y==target_y <span class="keyword">and</span> x==target_x:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        past_cost += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i, j <span class="keyword">in</span> ways:</span><br><span class="line">            nxt_y = y+i</span><br><span class="line">            nxt_x = x+j</span><br><span class="line">            <span class="keyword">if</span> nxt_y&lt;<span class="number">0</span> <span class="keyword">or</span> nxt_x&lt;<span class="number">0</span> <span class="keyword">or</span> nxt_y==n <span class="keyword">or</span> nxt_x==m:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> barrier(graph, y, x, i, j):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> past_cost &lt; min_cost[nxt_y][nxt_x]:</span><br><span class="line">                min_cost[nxt_y][nxt_x] = past_cost</span><br><span class="line">                prev[nxt_y][nxt_x] = (y, x)</span><br><span class="line">                tot_cost = future_cost(nxt_y, nxt_x, target_x, target_y) + past_cost</span><br><span class="line">                heapq.heappush(heap, (tot_cost, past_cost, nxt_y, nxt_x))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct path</span></span><br><span class="line">    curr_y = target_y</span><br><span class="line">    curr_x = target_x</span><br><span class="line">    path = [(curr_y, curr_x)]</span><br><span class="line">    <span class="keyword">while</span> prev[curr_y][curr_x] != <span class="literal">None</span>:</span><br><span class="line">        curr_y, curr_x = prev[curr_y][curr_x]</span><br><span class="line">        path.append((curr_y, curr_x))</span><br><span class="line">    path.reverse()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> path</span><br></pre></td></tr></table></figure>
<h3 id="ç¹ªè£½è·¯å¾‘"><a class="markdownIt-Anchor" href="#ç¹ªè£½è·¯å¾‘"></a> ç¹ªè£½è·¯å¾‘</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.animation <span class="keyword">as</span> animation</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot_path</span>(<span class="params">maze, path, fig, ax</span>):</span><br><span class="line">    height = <span class="built_in">len</span>(maze)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–å‡½æ•¸</span></span><br><span class="line">    adjusted_path = [(x+<span class="number">0.5</span>, height-y-<span class="number">0.5</span>) <span class="keyword">for</span> y, x <span class="keyword">in</span> path]</span><br><span class="line">    x_data, y_data = <span class="built_in">zip</span>(*adjusted_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">        line.set_data([], [])</span><br><span class="line">        <span class="keyword">return</span> line,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ›´æ–°å‡½æ•¸</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">num</span>):</span><br><span class="line">        line.set_data(x_data[:num+<span class="number">1</span>], y_data[:num+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> line,</span><br><span class="line"></span><br><span class="line">    line, = ax.plot([], [], <span class="string">&#x27;r&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line">    ani = animation.FuncAnimation(fig, update, frames=<span class="built_in">len</span>(path), init_func=init,</span><br><span class="line">                                interval=<span class="number">100</span>, blit=<span class="literal">True</span>, repeat=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> fig, ax, ani</span><br></pre></td></tr></table></figure>
<h3 id="åŸ·è¡Œçµæœ"><a class="markdownIt-Anchor" href="#åŸ·è¡Œçµæœ"></a> åŸ·è¡Œçµæœ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">height = <span class="number">20</span></span><br><span class="line">width = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># maze (code in prev article)</span></span><br><span class="line">maze = ellers_algorithm(height, width)</span><br><span class="line">fig, ax = plot_maze(maze)</span><br><span class="line"></span><br><span class="line"><span class="comment"># path</span></span><br><span class="line">path = a_star(maze, <span class="number">0</span>, <span class="number">0</span>, height-<span class="number">1</span>, width-<span class="number">1</span>)</span><br><span class="line">fig, ax, ani = plot_path(maze, path, fig, ax)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>æˆæœå¦‚ä¸‹:<br />
<img src="/images/2024/08/10/maze_animation.gif" alt="maze_animation" class="seventy"></p>
]]></content>
      <categories>
        <category>DSA</category>
      </categories>
      <tags>
        <tag>A* Algorithm</tag>
        <tag>Maze</tag>
      </tags>
  </entry>
  <entry>
    <title>Eller&#39;s Algorithm è¿·å®®ç”Ÿæˆç®—æ³•</title>
    <url>/posts/DSA/2024/ellers-algorithm/</url>
    <content><![CDATA[<img src="/images/2024/08/09/new_maze.png" alt="maze" class="seventy">
<h2 id="ellers-algorithm-ç®—æ³•ä»‹ç´¹"><a class="markdownIt-Anchor" href="#ellers-algorithm-ç®—æ³•ä»‹ç´¹"></a> Ellerâ€™s Algorithm ç®—æ³•ä»‹ç´¹</h2>
<p>Ellerâ€™s Algorithm æ˜¯ä¸€ç¨®ç¥å¥‡å‹•æ…‹è¿·å®®ç”Ÿæˆç®—æ³•ï¼Œå¯ä»¥åœ¨ç·šæ€§æ™‚é–“å…§é€è¡Œç”Ÿæˆè¿·å®®ï¼Œç”¨æˆ‘è‡ªå·±çš„ç†è§£ä¾†èªªï¼Œç®—æ³•çš„ç²¾ç¥å°±æ˜¯:</p>
<p><em>æ¯å€‹æ ¼å­ä¸€é–‹å§‹éƒ½æ˜¯è¢«åˆ†éš”é–‹çš„ã€Œ<strong>å€åŸŸ</strong>ã€ï¼Œéš¨æ©Ÿæ‰“é€šæ ¼å­é–“çš„ç‰†å£ä½¿å€åŸŸé–“å¯ä»¥ç›¸é€šã€‚</em></p>
<span id="more"></span>
<h3 id="æ­¥é©Ÿæ‹†è§£"><a class="markdownIt-Anchor" href="#æ­¥é©Ÿæ‹†è§£"></a> æ­¥é©Ÿæ‹†è§£</h3>
<p>Ellerâ€™s Algorithm å¤§è‡´ä¸Šå¯ä»¥æ‹†è§£ç‚ºä»¥ä¸‹å¹¾å€‹æ­¥é©Ÿ:</p>
<ol>
<li><strong>åˆå§‹åŒ–ç¬¬ä¸€è¡Œ</strong><br />
æ¯å€‹æ ¼å­éƒ½æœ‰ä¸€å€‹å”¯ä¸€çš„å€åŸŸç·¨è™Ÿï¼Œå½¼æ­¤ä¹‹é–“éƒ½æ˜¯åˆ†éš”çš„ã€‚<br />
<img src="/images/2024/08/09/step1.png" alt="step1" class="fifty"></li>
<li><strong>æ©«å‘é€£æ¥</strong><br />
éš¨æ©Ÿæ‰“é€šç›¸é„°æ ¼å­ä¹‹é–“çš„æ©«å‘ç‰†å£ï¼Œå°‡å®ƒå€‘åˆä½µåˆ°åŒä¸€å€‹å€åŸŸä¸­ã€‚<br />
<img src="/images/2024/08/09/step2.png" alt="step2" class="fifty"></li>
<li><strong>å‚ç›´é€£æ¥</strong><br />
æ¯å€‹å€åŸŸè‡³å°‘æœ‰ä¸€å€‹æ ¼å­å‘ä¸‹é€£æ¥ï¼Œç¢ºä¿è¿·å®®åœ¨ä¸‹ä¸€è¡Œæ˜¯é€£é€šçš„ã€‚<br />
<img src="/images/2024/08/09/step3.png" alt="step3" class="fifty"></li>
<li><strong>æ–°å¢å€åŸŸ</strong><br />
åˆ†é…æ–°çš„å€åŸŸç·¨è™Ÿçµ¦å°šæœªé€£æ¥çš„æ ¼å­ï¼Œç”±æ–¼ç®—æ³•åªé—œæ³¨æœ€æ–°çš„ä¸€è¡Œï¼Œæ‰€ä»¥å‰é¢çš„å¹¾è¡Œéƒ½ä¸ç”¨ç®¡äº†ã€‚<br />
<img src="/images/2024/08/09/step4.png" alt="step4" class="fifty"></li>
<li><strong>è¿­ä»£ç”Ÿæˆ</strong><br />
é‡è¤‡ 2~4 çš„æ­¥é©Ÿ<br />
<img src="/images/2024/08/09/step5_1.png" alt="step5_1" class="fifty"><br />
<img src="/images/2024/08/09/step5_2.png" alt="step5_2" class="fifty"><br />
<img src="/images/2024/08/09/step5_3.png" alt="step5_3" class="fifty"></li>
<li><strong>è™•ç†æœ€å¾Œä¸€è¡Œ</strong><br />
ç¢ºä¿æœ€å¾Œä¸€è¡Œæ‰€æœ‰æ ¼å­éƒ½é€£æ¥ (æ‰“é€šæ‰€æœ‰å€åŸŸ)ï¼Œä»¥å½¢æˆä¸€å€‹å®Œæ•´çš„è¿·å®®ã€‚<br />
ps. é€£é€šçš„æ˜¯å€åŸŸï¼Œä¸ä»£è¡¨æœ€å¾Œä¸€åˆ—æ²’æœ‰æ©«å‘çš„ç‰†å£<br />
<img src="/images/2024/08/09/step6.png" alt="step6" class="fifty"></li>
</ol>
<h2 id="python-å¯¦ç¾"><a class="markdownIt-Anchor" href="#python-å¯¦ç¾"></a> Python å¯¦ç¾</h2>
<p>é›–ç„¶èªªç®—æ³•é‚è¼¯æ˜¯æ‰“é€šå€åŸŸï¼Œä½†å€åŸŸæ˜¯å€‹æŠ½è±¡çš„æ¦‚å¿µï¼Œå¯¦éš›ä¸Šç¨‹å¼å¯«èµ·ä¾†æœƒæ¯”è¼ƒåƒåœ¨å„å€‹æ ¼å­é–“ã€Œ<strong>å»ºç‰†</strong>ã€ã€‚</p>
<h3 id="ç”Ÿæˆè¿·å®®"><a class="markdownIt-Anchor" href="#ç”Ÿæˆè¿·å®®"></a> ç”Ÿæˆè¿·å®®</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">replace</span>(<span class="params">row, old_v, new_v</span>):</span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(row):</span><br><span class="line">        <span class="keyword">if</span> v == old_v:</span><br><span class="line">            row[i] = new_v</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ellers_algorithm</span>(<span class="params">height, width, prob=<span class="number">0.5</span></span>):</span><br><span class="line">    maze = [[<span class="number">0</span>]*width <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(height)]</span><br><span class="line">    areas = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width)]</span><br><span class="line">    next_area = width</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="comment"># Horizontal connections</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width-<span class="number">1</span>):</span><br><span class="line">            <span class="comment"># no wall (connect areas)</span></span><br><span class="line">            <span class="keyword">if</span> areas[j] != areas[j+<span class="number">1</span>] <span class="keyword">and</span> random.random() &gt; prob:</span><br><span class="line">                replace(areas, areas[j+<span class="number">1</span>], areas[j])</span><br><span class="line">            <span class="comment"># build wall</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                maze[i][j] |= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Last row (connect all areas)</span></span><br><span class="line">        <span class="keyword">if</span> i == height-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width-<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> areas[j] != areas[j+<span class="number">1</span>]:</span><br><span class="line">                    replace(areas, areas[j+<span class="number">1</span>], areas[j])</span><br><span class="line">                    maze[i][j] &amp;= ~<span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Vertical connections</span></span><br><span class="line">        area_count = Counter(areas)</span><br><span class="line">        <span class="keyword">for</span> j, cell <span class="keyword">in</span> <span class="built_in">enumerate</span>(areas):</span><br><span class="line">            <span class="comment"># build wall</span></span><br><span class="line">            <span class="keyword">if</span> area_count[cell] &gt; <span class="number">1</span> <span class="keyword">and</span> random.random() &lt; prob:</span><br><span class="line">                area_count[cell] -= <span class="number">1</span></span><br><span class="line">                areas[j] = next_area</span><br><span class="line">                next_area += <span class="number">1</span></span><br><span class="line">                maze[i][j] |= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> maze</span><br></pre></td></tr></table></figure>
<h3 id="ç¹ªè£½è¿·å®®"><a class="markdownIt-Anchor" href="#ç¹ªè£½è¿·å®®"></a> ç¹ªè£½è¿·å®®</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.lines <span class="keyword">as</span> lines</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">line</span>(<span class="params">x1, x2, y1, y2, color=<span class="string">&#x27;black&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">return</span> lines.Line2D([x1, x2], [y1, y2], color=color, linewidth=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot_maze</span>(<span class="params">maze</span>):</span><br><span class="line">    height, width = <span class="built_in">len</span>(maze), <span class="built_in">len</span>(maze[<span class="number">0</span>])</span><br><span class="line">    fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boarder</span></span><br><span class="line">    ax.add_line(line(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, height))</span><br><span class="line">    ax.add_line(line(<span class="number">0</span>, width, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    ax.add_line(line(width, width, <span class="number">0</span>, height))</span><br><span class="line">    ax.add_line(line(<span class="number">0</span>, width, height, height))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="keyword">if</span> maze[i][j] &amp; <span class="number">1</span>:  <span class="comment"># Wall to the right</span></span><br><span class="line">                ax.add_line(line(j+<span class="number">1</span>, j+<span class="number">1</span>, height-i-<span class="number">1</span>, height-i))</span><br><span class="line">            <span class="keyword">if</span> maze[i][j] &amp; <span class="number">2</span>:  <span class="comment"># Wall below</span></span><br><span class="line">                ax.add_line(line(j, j+<span class="number">1</span>, height-i-<span class="number">1</span>, height-i-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    ax.set_xlim(<span class="number">0</span>, width)</span><br><span class="line">    ax.set_ylim(<span class="number">0</span>, height)</span><br><span class="line">    ax.set_aspect(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">    ax.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> fig, ax</span><br></pre></td></tr></table></figure>
<h3 id="åŸ·è¡Œçµæœ"><a class="markdownIt-Anchor" href="#åŸ·è¡Œçµæœ"></a> åŸ·è¡Œçµæœ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">height = <span class="number">20</span></span><br><span class="line">width = <span class="number">30</span></span><br><span class="line">    </span><br><span class="line">maze = ellers_algorithm(height, width)</span><br><span class="line">fig, ax = plot_maze(maze)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>æˆæœå¦‚ä¸‹:<br />
<img src="/images/2024/08/09/new_maze.png" alt="maze" class="seventy"></p>
<h2 id="é å‘Š"><a class="markdownIt-Anchor" href="#é å‘Š"></a> é å‘Š</h2>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« ç”¨ A* ç®—æ³•èµ°è¿·å®® ~</p>
]]></content>
      <categories>
        <category>DSA</category>
      </categories>
      <tags>
        <tag>Maze</tag>
        <tag>Eller&#39;s Algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>Monotonic Stack</title>
    <url>/posts/DSA/2024/monotonic-stack/</url>
    <content><![CDATA[<p><strong>Monotonic Stack</strong> æœ¬è³ªä¸Šå°±æ˜¯ä¸€å€‹ Stack è€Œå·²ï¼Œåªä¸éåœ¨æ“ä½œ Stack æ™‚éœ€è¦åŒæ™‚ç¶­è­·å…¶å–®èª¿çš„ç‰¹æ€§ï¼Œæœ¬æ–‡æœƒç°¡å–®ä»‹ç´¹ Monotonic Stack ä¸¦é™„ä¸Šå…©å€‹æœ‰ä¸€é»é»é›£åº¦çš„ LeetCode é¡Œç›®åšç·´ç¿’ï¼š<a href="https://leetcode.com/problems/largest-rectangle-in-histogram">84. Largest Rectangle in Histogram</a>ã€<a href="https://leetcode.com/problems/maximal-rectangle">85. Maximal Rectangle</a>ã€‚</p>
<span id="more"></span>
<h2 id="usage"><a class="markdownIt-Anchor" href="#usage"></a> Usage</h2>
<p>ç™½è©±ä¾†èªªï¼Œå¦‚æœæˆ‘å€‘è¦ç¶­è­·ä¸€å€‹<strong>å–®èª¿éå¢</strong>çš„ stack (å¦‚ä¸Šåœ–)ï¼Œé‚£éº¼åœ¨ <strong>push</strong> æ–°å…ƒç´ æ™‚è¦å…ˆå’Œ stack çš„ top é€²è¡Œæ¯”è¼ƒï¼Œå¦‚æœæ–°çš„å…ƒç´ æ¯”è¼ƒå¤§å°±ç›´æ¥æ”¾é€²å»ï¼Œå¦‚æœæ–°çš„å…ƒç´ æ¯”è¼ƒå°çš„è©±ï¼Œå°±è¦å…ˆå°‡ stack ä¸­å¤§æ–¼æ–°å…ƒç´ çš„å…ƒç´ ä¾æ¬¡ <strong>pop</strong> å‡ºä¾†ï¼Œä¹‹å¾Œæ‰æ”¾å…¥æ–°å…ƒç´ ï¼Œå¦‚æ­¤ä¸€ä¾†ä¾¿èƒ½ç¶­è­· Stack çš„å–®èª¿æ€§ã€‚</p>
<p><img src="/images/2024/04/13/monotonic-stack.png" alt="monotonic stack" /></p>
<p>ä¾æ­¤é¡æ¨ï¼Œå–®èª¿éæ¸›ä¹Ÿæ˜¯å·®ä¸å¤šä½œæ³•ã€‚</p>
<h2 id="leetcode-example"><a class="markdownIt-Anchor" href="#leetcode-example"></a> LeetCode Example</h2>
<h3 id="84-largest-rectangle-in-histogram"><a class="markdownIt-Anchor" href="#84-largest-rectangle-in-histogram"></a> <a href="https://leetcode.com/problems/largest-rectangle-in-histogram">84. Largest Rectangle in Histogram</a></h3>
<p><img src="/images/2024/04/13/Largest-Rectangle-in-Histogram.png" alt="Largest Rectangle in Histogram" /></p>
<p>åœ¨é€™å€‹é¡Œç›®ä¸­ï¼Œæˆ‘å€‘è¦æ‰¾å‡ºç›´æ–¹åœ–æ‰€èƒ½çµ„æˆçš„æœ€å¤§é•·æ–¹å½¢é¢ç©ï¼Œæˆ‘å€‘å…¶å¯¦å¯ä»¥æŠŠå®ƒçœ‹ä½œ <a href="https://www.geeksforgeeks.org/next-smaller-element/">Next Smaller Element</a> å•é¡Œçš„è®Šå½¢ï¼Œæ‰¾åˆ°å°æ–¼æ¯å€‹ hist ä¾†èªªï¼Œä¸‹ä¸€å€‹æ¯”å®ƒä½çš„ hist åœ¨å“ªï¼Œå¦‚æ­¤ä¾¿èƒ½çš„åˆ°å®ƒé•·æ–¹å½¢çš„å¯¬ï¼Œé€²ä¸€æ­¥è¨ˆç®—å‡ºé•·æ–¹å½¢çš„é¢ç©ã€‚<br />
å…·é«”ä¾†èªªï¼Œæˆ‘å€‘åœ¨éæ­·ç›´æ–¹åœ–çš„åŒæ™‚ç¶­è­·ä¸€å€‹ Monotonic Stackï¼Œæ¯æ¬¡ pop æ™‚éƒ½å»è¨ˆç®—è¢« pop æ‰çš„æŸ±é«”æœ€å¤šå¯ä»¥çµ„æˆå¤šå°‘é¢ç©ï¼Œä»¥ä¸Šåœ–ä¾†èªªï¼š</p>
<ul>
<li><strong>push 2</strong><br />
ç›´æ¥æ”¾å…¥ 2ï¼Œstack = <strong>[2]</strong></li>
<li><strong>push 1</strong><br />
1 &lt; 2ï¼Œpop 2ï¼Œé•·æ–¹å½¢é¢ç©ç‚º 2 * 1 = 2ã€‚<br />
æ”¾å…¥ 1ï¼Œstack = <strong>[1]</strong></li>
<li><strong>push 5</strong><br />
ç›´æ¥æ”¾å…¥ 5ï¼Œstack = <strong>[1, 5]</strong></li>
<li><strong>push 6</strong><br />
ç›´æ¥æ”¾å…¥ 6ï¼Œstack = <strong>[1, 5, 6]</strong></li>
<li><strong>push 2</strong><br />
2 &lt; 6ï¼Œpop 6ï¼Œé•·æ–¹å½¢é¢ç©ç‚º 6 * 1 = 6ã€‚<br />
2 &lt; 5ï¼Œpop 5ï¼Œé•·æ–¹å½¢é¢ç©ç‚º 5 * 2 = 10ã€‚<br />
æ”¾å…¥ 2ï¼Œstack = <strong>[1, 2]</strong></li>
<li><strong>â€¦</strong></li>
</ul>
<p>ä¸‹é¢çš„ç¨‹å¼ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨åš´æ ¼å–®èª¿éå¢ï¼Œæ‰€ä»¥é«˜åº¦ä¸€æ¨£çš„è©±æˆ‘å€‘ä¸€æ¨£ä¸æ”¾é€² stack ä¸­ï¼Œå¦å¤–æˆ‘å€‘çš„ stack åŒæ™‚å­˜å„² hist çš„é«˜åº¦ä»¥åŠ indexï¼Œé€™æ¨£åœ¨ç®—é¢ç©æ™‚æ¯”è¼ƒå¿«ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">largestRectangleArea</span>(<span class="params">self, heights: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    </span><br><span class="line">    heights.append(<span class="number">0</span>)</span><br><span class="line">    stack = [(-<span class="number">1</span>, -<span class="number">1</span>)]</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, h <span class="keyword">in</span> <span class="built_in">enumerate</span>(heights):</span><br><span class="line">        t_i = i</span><br><span class="line">        <span class="keyword">while</span> h &lt; stack[-<span class="number">1</span>][<span class="number">1</span>]:</span><br><span class="line">            t_i, t_h = stack.pop()</span><br><span class="line">            res = <span class="built_in">max</span>(res, t_h*(i-t_i))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> h &gt; stack[-<span class="number">1</span>][<span class="number">1</span>]:</span><br><span class="line">            stack.append((t_i, h))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="85-maximal-rectangle"><a class="markdownIt-Anchor" href="#85-maximal-rectangle"></a> <a href="https://leetcode.com/problems/maximal-rectangle">85. Maximal Rectangle</a></h3>
<p><img src="/images/2024/04/13/Maximal-Rectangle.png" alt="Maximal Rectangle" /></p>
<p>ä¸Šä¸€é¡Œçš„å»¶ä¼¸é¡Œï¼Œå…ˆå°‡ matrix ä¸­çš„æ¯å€‹ row è½‰æ›ç‚ºå°æ‡‰çš„ç›´æ–¹åœ–ï¼Œæ¥è‘—ç”¨åŒæ¨£çš„æ–¹å¼å»æ±‚å‡ºç›´æ–¹åœ–çš„æœ€å¤§é•·æ–¹å½¢é¢ç©å°±è¡Œäº†ï¼Œä»¥ä¸Šåœ–ä¾†èªªï¼š</p>
<ul>
<li>matrix[0] = <strong>[1, 0, 1, 0, 0]</strong></li>
<li>matrix[1] = <strong>[2, 0, 2, 1, 1]</strong></li>
<li>matrix[2] = <strong>[3, 1, 3, 2, 2]</strong></li>
<li>matrix[3] = <strong>[4, 0, 0, 3, 0]</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">maximalRectangle</span>(<span class="params">self, matrix: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">str</span>]]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Apply monotonic stack to calculate maximal rectangle</span></span><br><span class="line"><span class="string">    1. reserve one more space for the zero</span></span><br><span class="line"><span class="string">    2. put a negative hist in the bottom to stay in a valid state (in while loop)</span></span><br><span class="line"><span class="string">    3. append a zero to calculate remaining hist in stack</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">len</span>(matrix)</span><br><span class="line">    m = <span class="built_in">len</span>(matrix[<span class="number">0</span>])+<span class="number">1</span>    <span class="comment"># 1</span></span><br><span class="line">    heights = [<span class="number">0</span>]*m</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        stack = [(-<span class="number">1</span>, -<span class="number">1</span>)]  <span class="comment"># 2</span></span><br><span class="line">        matrix[i].append(<span class="number">0</span>) <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">            heights[j] = heights[j]+<span class="number">1</span> <span class="keyword">if</span> matrix[i][j] == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            t_j = j</span><br><span class="line">            <span class="keyword">while</span> heights[j] &lt; stack[-<span class="number">1</span>][<span class="number">1</span>]:</span><br><span class="line">                t_j, t_h = stack.pop()</span><br><span class="line">                res = <span class="built_in">max</span>(res, t_h*(j-t_j))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> heights[j] &gt; stack[-<span class="number">1</span>][<span class="number">1</span>]:</span><br><span class="line">                stack.append((t_j, heights[j]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>DSA</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
        <tag>Monotonic Stack</tag>
      </tags>
  </entry>
  <entry>
    <title>è³‡æ–™çµæ§‹ç­†è¨˜ - å¸ƒéš†éæ¿¾å™¨ Bloom Filter</title>
    <url>/posts/DSA/2024/bloom-filter/</url>
    <content><![CDATA[<p><img src="/images/2024/01/10/bloom-filter-new.png" alt="bloom-filter" /></p>
<h1 id="summary"><a class="markdownIt-Anchor" href="#summary"></a> Summary</h1>
<ul>
<li>ç”¨é€”: ç”¨ä¾†å¿«é€Ÿåˆ¤æ–·å…ƒç´ æ˜¯å¦å­˜åœ¨æ–¼ä¸€å€‹é›†åˆä¸­</li>
<li>å„ªé»: å¿«é€Ÿã€ç¯€çœç©ºé–“</li>
<li>ç¼ºé»: å¯èƒ½æœ‰ false positive (ä¸å­˜åœ¨ä½†åˆ¤å®šç‚ºå­˜åœ¨)</li>
<li>æ‡‰ç”¨:
<ul>
<li>Check Duplicate: nameã€email ç­‰æ˜¯å¦å·²è¢«ä½¿ç”¨</li>
<li>Filters: éæ¿¾æƒ¡æ„è«‹æ±‚ (ex: <a href="https://www.explainthis.io/zh-hant/swe/cache-mechanism">Cache penetration</a>)ã€åƒåœ¾éƒµä»¶ç­‰</li>
</ul>
</li>
</ul>
<span id="more"></span>
<h1 id="åŸç†"><a class="markdownIt-Anchor" href="#åŸç†"></a> åŸç†</h1>
<p>å°å…ƒç´ ä½¿ç”¨ k å€‹ Hash Functionsï¼Œå°‡å…¶æ˜ å°„åˆ°é•·åº¦ç‚º m çš„ Array ä¸­ï¼Œå¯«å…¥æ™‚å°‡æ˜ å°„åˆ°çš„ k å€‹ä½ç½®æ¨™ç¤ºç‚º 1ï¼Œæª¢æŸ¥æ™‚å¦‚æœæ˜ å°„åˆ°çš„ k å€‹ä½ç½®éƒ½å‘½ä¸­ï¼Œè¡¨ç¤ºè©²å…ƒç´ <strong>å¯èƒ½å­˜åœ¨</strong>ã€‚</p>
<ol>
<li>
<p>ç”±é æœŸçš„ <strong>False positive rate (p)</strong> ä»¥åŠå­˜å…¥çš„<strong>è³‡æ–™ç­†æ•¸ (n)</strong> ä¾†æ±‚å‡º <strong>Array Size (m)</strong> ä»¥åŠ <strong>Hash Functionsæ•¸ (k)</strong></p>
<ul>
<li><strong>False positive rate</strong><br />
<img src="/images/2024/01/10/false-positive-probability.png" alt="false-positive-probability" /></li>
<li><strong>Array size</strong><br />
<img src="/images/2024/01/10/array-size.png" alt="array-size" /></li>
<li><strong>Number of hash functions</strong><br />
<img src="/images/2024/01/10/number-of-hash-functions.png" alt="number-of-hash-functions" /></li>
</ul>
</li>
<li>
<p>é¸æ“‡ Hash function<br />
å¯ä»¥ä½¿ç”¨ <strong>Non-Cryptographic Hash</strong> (éå¯†ç¢¼é›œæ¹Šå‡½æ•¸)ï¼Œé›–ç„¶æœ‰ collision çš„å¯èƒ½ï¼Œä½†è¶³å¤ å¥½äº†ï¼Œè€Œä¸”æ¯”è¼ƒå¿«ã€‚<br />
ä¾‹å¦‚: MurmurHashã€FarmHashã€SpookyHash</p>
</li>
</ol>
<h1 id="å¯¦ä½œ"><a class="markdownIt-Anchor" href="#å¯¦ä½œ"></a> å¯¦ä½œ</h1>
<p><strong>éåŸå‰µ!</strong> åŸºæœ¬ä¸Šæ˜¯ä¸‹é¢åƒè€ƒæ–‡ç« ä¸­çš„ç¨‹å¼ç¢¼ï¼Œå¯«çš„å¾ˆä¸éŒ¯æ‰€ä»¥åªæœ‰å°å°ä¿®æ”¹ä¸€ä¸‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Python 3 program to build Bloom Filter </span></span><br><span class="line"><span class="comment"># Install mmh3 and bitarray 3rd party module first </span></span><br><span class="line"><span class="comment"># pip install mmh3 </span></span><br><span class="line"><span class="comment"># pip install bitarray </span></span><br><span class="line"><span class="keyword">import</span> math </span><br><span class="line"><span class="keyword">import</span> mmh3 </span><br><span class="line"><span class="keyword">from</span> bitarray <span class="keyword">import</span> bitarray </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BloomFilter</span>(<span class="title class_ inherited__">object</span>): </span><br><span class="line"></span><br><span class="line">	<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">	Class for Bloom filter, using murmur3 hash function </span></span><br><span class="line"><span class="string">	&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, items_count, fp_prob</span>): </span><br><span class="line">		<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">		items_count : int </span></span><br><span class="line"><span class="string">			Number of items expected to be stored in bloom filter </span></span><br><span class="line"><span class="string">		fp_prob : float </span></span><br><span class="line"><span class="string">			False Positive probability in decimal </span></span><br><span class="line"><span class="string">		&#x27;&#x27;&#x27;</span></span><br><span class="line">		<span class="comment"># False possible probability in decimal </span></span><br><span class="line">		self.fp_prob = fp_prob </span><br><span class="line"></span><br><span class="line">		<span class="comment"># Size of bit array to use </span></span><br><span class="line">		self.size = self.get_size(items_count, fp_prob) </span><br><span class="line"></span><br><span class="line">		<span class="comment"># number of hash functions to use </span></span><br><span class="line">		self.hash_count = self.get_hash_count(self.size, items_count) </span><br><span class="line"></span><br><span class="line">		<span class="comment"># Bit array of given size, default all 0 </span></span><br><span class="line">		self.bit_array = bitarray(self.size) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, item</span>): </span><br><span class="line">		<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">		Add an item in the filter </span></span><br><span class="line"><span class="string">		&#x27;&#x27;&#x27;</span></span><br><span class="line">		digests = [] </span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.hash_count): </span><br><span class="line"></span><br><span class="line">			<span class="comment"># create digest for given item. </span></span><br><span class="line">			<span class="comment"># i work as seed to mmh3.hash() function </span></span><br><span class="line">			<span class="comment"># With different seed, digest created is different </span></span><br><span class="line">			digest = mmh3.<span class="built_in">hash</span>(item, i) % self.size </span><br><span class="line">			digests.append(digest) </span><br><span class="line"></span><br><span class="line">			<span class="comment"># set the bit True in bit_array </span></span><br><span class="line">			self.bit_array[digest] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, item</span>): </span><br><span class="line">		<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">		Check for existence of an item in filter </span></span><br><span class="line"><span class="string">		&#x27;&#x27;&#x27;</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.hash_count): </span><br><span class="line">			digest = mmh3.<span class="built_in">hash</span>(item, i) % self.size </span><br><span class="line">			<span class="keyword">if</span> self.bit_array[digest] == <span class="literal">False</span>: </span><br><span class="line"></span><br><span class="line">				<span class="comment"># if any of bit is False then,its not present </span></span><br><span class="line">				<span class="comment"># in filter </span></span><br><span class="line">				<span class="comment"># else there is probability that it exist </span></span><br><span class="line">				<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">	@staticmethod</span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">get_size</span>(<span class="params">n, p</span>): </span><br><span class="line">		<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">		Return the size of bit array(m) to used using </span></span><br><span class="line"><span class="string">		following formula </span></span><br><span class="line"><span class="string">		m = -(n * lg(p)) / (lg(2)^2) </span></span><br><span class="line"><span class="string">		n : int </span></span><br><span class="line"><span class="string">			number of items expected to be stored in filter </span></span><br><span class="line"><span class="string">		p : float </span></span><br><span class="line"><span class="string">			False Positive probability in decimal </span></span><br><span class="line"><span class="string">		&#x27;&#x27;&#x27;</span></span><br><span class="line">		m = -(n * math.log(p))/(math.log(<span class="number">2</span>)**<span class="number">2</span>) </span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">int</span>(m) </span><br><span class="line"></span><br><span class="line"><span class="meta">	@staticmethod</span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">get_hash_count</span>(<span class="params">m, n</span>): </span><br><span class="line">		<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">		Return the hash function(k) to be used using </span></span><br><span class="line"><span class="string">		following formula </span></span><br><span class="line"><span class="string">		k = (m/n) * lg(2) </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		m : int </span></span><br><span class="line"><span class="string">			size of bit array </span></span><br><span class="line"><span class="string">		n : int </span></span><br><span class="line"><span class="string">			number of items expected to be stored in filter </span></span><br><span class="line"><span class="string">		&#x27;&#x27;&#x27;</span></span><br><span class="line">		k = (m/n) * math.log(<span class="number">2</span>) </span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">int</span>(k)</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸€ä¸‹æˆæœ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">100000</span> <span class="comment"># Number of items to add </span></span><br><span class="line">p = <span class="number">0.05</span> <span class="comment"># False positive probability </span></span><br><span class="line">  </span><br><span class="line">bloomf = BloomFilter(n,p) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Array size: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(bloomf.size)) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Number of hash functions: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(bloomf.hash_count)) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;False positive probability: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(bloomf.fp_prob)) </span><br><span class="line"></span><br><span class="line"><span class="comment"># Add items</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">	bloomf.add(<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check false positive rate on Test data</span></span><br><span class="line">fp = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n, <span class="number">2</span>*n):</span><br><span class="line">	<span class="keyword">if</span> bloomf.check(<span class="built_in">str</span>(i)):</span><br><span class="line">		fp += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;False positive rate on test data: &#123;:.4f&#125;&quot;</span>.<span class="built_in">format</span>(fp/n)) </span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¯¦éš›çš„ FP Rate èˆ‡æˆ‘å€‘è¨­å®šçš„éå¸¸æ¥è¿‘ã€‚<br />
<img src="/images/2024/01/10/filter-result.png" alt="filter-result" /></p>
<h1 id="åƒè€ƒæ–‡ç« "><a class="markdownIt-Anchor" href="#åƒè€ƒæ–‡ç« "></a> åƒè€ƒæ–‡ç« </h1>
<p><a href="https://www.geeksforgeeks.org/bloom-filters-introduction-and-python-implementation/">Bloom Filters â€“ Introduction and Implementation</a></p>
]]></content>
      <categories>
        <category>DSA</category>
      </categories>
      <tags>
        <tag>Bloom Filter</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDBæ¦‚å¿µä»‹ç´¹ + PyMongoåŸºæœ¬CRUDæ“ä½œæ•™å­¸</title>
    <url>/posts/Back-end/2023/pymongo/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p><img src="/images/2023/05/05/cover.png" alt="cover image" /></p>
<p>å› ç‚ºèª²å ‚å°ˆæ¡ˆçš„é—œä¿‚éœ€è¦ç”¨åˆ°MongoDBæ‰€ä»¥å°å­¸äº†ä¸€ä¸‹ï¼Œç™¼ç¾MongoDBçœŸçš„æ˜¯å¾ˆé¦™ï¼Œæ’‡é–‹è³‡æ–™åº«æ˜“ç”¨æ€§ï¼Œå…‰æ˜¯MongoDB Atlasæä¾›æ¯ä½ä½¿ç”¨è€…å…è²»10GBçš„é›²ç«¯è³‡æ–™åº«ç©ºé–“(å…å¡«ä¿¡ç”¨å¡)ï¼Œå°±å¾ˆå€¼å¾—ä½ è¾¦å€‹å¸³è™Ÿä¾†ç©ä¸€ä¸‹äº†ã€‚é€™ç¯‡æ–‡ç« æœƒç°¡å–®ä»‹ç´¹ä¸€ä¸‹MongoDBï¼Œä»¥åŠå¦‚ä½•ç”¨python PyMongoå®Œæˆè³‡æ–™åº«çš„CRUDæ“ä½œã€‚</p>
<span id="more"></span>
<h1 id="mongodb-atlas"><a class="markdownIt-Anchor" href="#mongodb-atlas"></a> MongoDB Atlas</h1>
<p>MongoDB Atlasæ˜¯MongoDBçš„é›²ç«¯è³‡æ–™åº«å¹³å°æœå‹™ï¼Œé¡§åæ€ç¾©ä½ å¯ä»¥æŠŠä½ çš„è³‡æ–™å­˜åœ¨é›²ç«¯è£¡é¢ï¼Œå¦‚æœä½ æ˜¯ç”¨drivers(ex: python, nodejsâ€¦)é€£ç·šé€²å»çš„è©±ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å®‰è£å€‹å¥—ä»¶å°±æå®šäº†ï¼Œä¸ç”¨é¡å¤–å»ä¸‹è¼‰æˆ–æ˜¯è¨­å®šä¸€äº›é›œä¸ƒé›œå…«çš„æ±è¥¿çœŸçš„å¾ˆæ–¹ä¾¿ï¼Œå¦å¤–ä¹Ÿå› ç‚ºæ˜¯é›²ç«¯æœå‹™ï¼Œå› æ­¤åœ¨åœ˜éšŠæˆå“¡è¦é€£ç·šé€²ä¾†ä¹Ÿå¾ˆå®¹æ˜“ï¼Œæ‹¿ä¾†runä¸€å€‹èª²å ‚å°ˆæ¡ˆæ˜¯ç¶½ç¶½æœ‰é¤˜äº†ã€‚</p>
<p>å› ç‚ºæ–‡ç« é‡é»æœƒæ”¾åœ¨MongoDBçš„è§€å¿µèˆ‡æ“ä½œï¼Œé€™è£¡å°±æä¾›ä¸€ç¯‡æ•™å­¸è®“å¤§å®¶è‡ªå·±çœ‹:</p>
<ul>
<li><a href="https://www.tpisoftware.com/tpu/articleDetails/2758" title="{rel='nofollow'}">å¦‚ä½•å¿«é€Ÿåœ°æ¶å¥½è‡ªå·±çš„MongoDB - MongoDB Atlasä»‹ç´¹</a></li>
</ul>
<p>å…¶å¯¦å°±æ˜¯è·Ÿè‘—æŒ‡ç¤ºåšï¼Œéƒ½æŒºç›´è¦ºçš„ï¼Œé›²ç«¯ä¾›æ‡‰å•†çš„éƒ¨åˆ†æˆ‘ä¹Ÿæ˜¯é¸GCPï¼Œå› ç‚ºæœ‰å°ç£çš„regionï¼Œé€™é‚Šå”¯ä¸€è¦æ³¨æ„çš„æ˜¯å¯é€£ç·šIPçš„éƒ¨åˆ†ï¼Œè¦æŠŠIPåœ°å€åŠ å…¥åå–®ä¸­æ‰èƒ½æˆåŠŸèˆ‡è³‡æ–™åº«å»ºç«‹é€£ç·šï¼Œæœ‰å€‹å°æ’‡æ­¥æ˜¯åªè¦åœ¨åå–®ä¸­åŠ å…¥<code>0.0.0.0</code>ï¼Œå°±å¯ä»¥ç„¡è¦–ç•¶å‰IPä½å€éš¨ä¾¿é€£äº†~</p>
<h1 id="mongodb-introduction"><a class="markdownIt-Anchor" href="#mongodb-introduction"></a> MongoDb Introduction</h1>
<h2 id="datebase-architecture"><a class="markdownIt-Anchor" href="#datebase-architecture"></a> Datebase architecture</h2>
<p>MongoDBå±¬æ–¼<strong>General Purpose Document Database</strong>(æ–‡ä»¶è³‡æ–™åº«)ï¼Œå…ˆä¾†äº†è§£ä¸€ä¸‹å¹¾å€‹é—œéµå­—:</p>
<blockquote>
<p><strong>Document</strong>: Basic unit of data<br />
<strong>Collection</strong>: A grouping of documents<br />
<strong>Database</strong>: A container for collections</p>
</blockquote>
<h2 id="document-model"><a class="markdownIt-Anchor" href="#document-model"></a> Document Model</h2>
<p>documentæ˜¯MongoDBçš„åŸºæœ¬è³‡æ–™å–®ä½ï¼Œæ¯å€‹documentéƒ½ä»¥BSONæ ¼å¼å„²å­˜(é¡ä¼¼JSONæ ¼å¼ï¼Œä½†å¤šäº†ä¸€äº›ç‰¹æ®Šçš„è³‡æ–™å‹æ…‹)ï¼Œèˆ‡é—œé€£å¼è³‡æ–™åº«ä¸åŒï¼ŒMongoDBæœ‰polymorphic documentsçš„ç‰¹æ€§ï¼Œæ²’æœ‰å¯«æ­»çš„schemaï¼Œä½¿ç”¨æ™‚ä¸éœ€è¦äº‹å…ˆå®šç¾©æ¬„ä½ã€è³‡æ–™å‹æ…‹ï¼Œç›¸åçš„ä½ æƒ³æ€éº¼å­˜å°±æ€éº¼å­˜ï¼ŒåŒå€‹collectionè£¡çš„documentå¯ä»¥é•·çš„å®Œå…¨ä¸ä¸€æ¨£ï¼Œ<strong>BUT!!!</strong>ï¼Œæœ‰å½ˆæ€§ä¸ä»£è¡¨å°±å¯ä»¥äº‚å­˜ï¼Œé‚„æ˜¯è¦è¦–å¯¦éš›çš„ä½¿ç”¨æƒ…å¢ƒä¾†è¨­è¨ˆschemaæ‰ä¸æœƒå®³åˆ°è‡ªå·±å–”ã€‚</p>
<h2 id="data-modeling"><a class="markdownIt-Anchor" href="#data-modeling"></a> Data Modeling</h2>
<p>å»¶çºŒå‰é¢æåˆ°çš„schemaï¼Œç©¶ç«Ÿè©²å¦‚ä½•è¨­è¨ˆä¸€å€‹å¥½çš„schemaï¼ŒMongoDBæœ‰æä¾›å…©å€‹éå¸¸æ˜ç¢ºçš„åŸå‰‡</p>
<blockquote>
<p>Thinking about the application rather than thinking about how itâ€™s stored.<br />
Data accessed together should be stored todether.</p>
</blockquote>
<p>ç¬¬ä¸€é»æ˜¯åœ¨èªªæˆ‘å€‘åœ¨è¨­è¨ˆè³‡æ–™åº«schemaæ™‚æ‡‰è©²focusåœ¨ã€Œæˆ‘å€‘çš„applicationå¦‚ä½•å–ç”¨è³‡æ–™ã€ï¼Œè€Œä¸æ˜¯ã€Œå¦‚ä½•æŠŠè³‡æ–™å­˜å¥½ã€ã€‚<br />
ç¬¬äºŒé»å‰‡æ˜¯èˆ‡MongoDBçš„æ¶æ§‹æœ‰é—œï¼Œå› ç‚ºè³‡æ–™éƒ½æ˜¯ä»¥documentç‚ºå–®ä½ï¼Œå› æ­¤æŠŠæœƒä¸€èµ·ä½¿ç”¨åˆ°çš„è³‡æ–™éƒ½å­˜åœ¨åŒä¸€å€‹documentè£¡é¢ï¼Œé€šå¸¸æœƒæ¯”å­˜åœ¨å…©å€‹åˆ†åˆ¥çš„documentè£¡é¢ä¾†çš„æ–¹ä¾¿å–ç”¨ã€‚</p>
<h2 id="relationship-types"><a class="markdownIt-Anchor" href="#relationship-types"></a> Relationship types</h2>
<p>ç…§ä¸Šé¢é€™éº¼èªªçš„è©±ï¼Œé‚£ç°¡å–®ï¼Œå…¨éƒ¨å¡é€²åŒå€‹documentå°±å°äº†å—? å…¶å¯¦ä¹Ÿä¸å°ï¼Œå› ç‚ºæ¯å€‹documnetå…¶å¯¦æœ‰16MBçš„size limitï¼Œæ‰€ä»¥æˆ‘å€‘é‚„æ˜¯è¦è¦–æƒ…æ³ä¾†å»ºç«‹æˆ‘å€‘çš„é—œè¯è¦å‰‡ï¼Œä»¥ä¸‹ä»‹ç´¹3ç¨®é—œè¯è¦å‰‡ä»¥åŠMongoDBçš„å»ºè­°çš„å„²å­˜æ–¹æ³•ã€‚</p>
<ol>
<li>one to one<br />
é¡§åæ€ç¾©å°±æ˜¯ä¸€å€‹å°ä¸€å€‹ï¼Œä»¥å­¸ç”Ÿè³‡æ–™ä¾†èªªï¼Œæ¯ä½å­¸ç”Ÿéƒ½æœ‰è‡ªå·±ç¨ç‰¹ä¸”å”¯ä¸€å­¸è™Ÿï¼Œé€™æ™‚å€™æˆ‘å€‘å°±æ²’å¿…è¦æŠŠå­¸è™Ÿå¦å¤–å­˜åœ¨åˆ¥çš„documentï¼Œç›´æ¥å­˜åœ¨ä¸€èµ·å°±å¥½ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &#x27;_id&#x27;: ObjectID(...),  # MongoDBé è¨­çš„_idæ ¼å¼ï¼Œæ²’æœ‰è¨­å®š_idçš„è©±æœƒè‡ªå‹•assign</span><br><span class="line">  &#x27;Name&#x27;: &#x27;Jack&#x27;,</span><br><span class="line">  &#x27;Mobile&#x27;: &#x27;0800-000000&#x27;,</span><br><span class="line">  &#x27;ID&#x27;: &#x27;A0001&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>one to many<br />
ç¾åœ¨å‡è¨­æˆ‘å€‘é‚„éœ€è¦å­˜æ¯ä½å­¸ç”Ÿçš„å®¶é•·è³‡æ–™ï¼Œç•¢ç«Ÿæ¯å€‹äººçš„å®¶é•·è³‡æ–™è‚¯å®šæ˜¯ä¸é‡è¤‡çš„å˜›ï¼Œæ‰€ä»¥æˆ‘å€‘é‚„æ˜¯æƒ³å­˜åœ¨åŒä¸€å€‹documentè£¡ï¼Œé€™æ™‚å€™æˆ‘å€‘å¯ä»¥ä½¿ç”¨<strong>Embedding</strong>çš„æŠ€å·§ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯å·¢ç‹€çµæ§‹åŠ ä¸‹å»å°±å°äº†XDã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &#x27;_id&#x27;: ObjectID(...),</span><br><span class="line">  &#x27;Name&#x27;: &#x27;Jack&#x27;,</span><br><span class="line">  &#x27;Mobile&#x27;: &#x27;0800-000000&#x27;,</span><br><span class="line">  &#x27;ID&#x27;: &#x27;A0001&#x27;,</span><br><span class="line">  &#x27;Parents&#x27;: &#123;</span><br><span class="line">    &#x27;Dad&#x27;: &#123;&#x27;Name&#x27;: &#x27;Bob&#x27;, &#x27;Mobile&#x27;: &#x27;0800-000001&#x27;&#125;,</span><br><span class="line">    &#x27;Mom&#x27;: &#123;&#x27;Name&#x27;: &#x27;Amy&#x27;, &#x27;Mobile&#x27;: &#x27;0800-000002&#x27;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>many to many<br />
ç¹¼çºŒå‰é¢ä¾‹å­ï¼Œæ¯å€‹å­¸ç”Ÿæ¯å­¸æœŸéƒ½æœƒä¿®å¾ˆå¤šèª²ï¼Œä¸¦ä¸”åŒä¸€å ‚èª²æœƒæœ‰å¾ˆå¤šå­¸ç”Ÿä¸€èµ·ä¿®ï¼Œé€™æ™‚å€™æˆ‘å€‘å¦‚æœç”¨Embeddingçš„è©±é›–ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æœ‰é»å¤ªæµªè²»è³‡æ–™åº«ç©ºé–“äº†ï¼Œæœƒå‡ºç¾å¾ˆå¤šé‡è¤‡çš„è³‡æ–™ï¼Œé€™æ™‚æˆ‘å€‘å¯ä»¥è¦–æƒ…æ³ä½¿ç”¨<strong>Referencing</strong>çš„æŠ€å·§ï¼ŒåŸºæœ¬ä¸Šè·ŸEmbeddingå¾ˆåƒï¼Œæ”¹æˆå­˜ç”¨ä¾†joinçš„keyã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &#x27;_id&#x27;: ObjectID(...),</span><br><span class="line">  &#x27;Name&#x27;: &#x27;Jack&#x27;,</span><br><span class="line">  &#x27;Mobile&#x27;: &#x27;0800-000000&#x27;,</span><br><span class="line">  &#x27;ID&#x27;: &#x27;A0001&#x27;,</span><br><span class="line">    &#x27;Parents&#x27;: &#123;</span><br><span class="line">    &#x27;Dad&#x27;: &#123;&#x27;Name&#x27;: &#x27;Bob&#x27;, &#x27;Mobile&#x27;: &#x27;0800-000001&#x27;&#125;,</span><br><span class="line">    &#x27;Mom&#x27;: &#123;&#x27;Name&#x27;: &#x27;Amy&#x27;, &#x27;Mobile&#x27;: &#x27;0800-000002&#x27;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#x27;courses&#x27;: [ObjectID(...), ObjectID(...), ...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦æ³¨æ„çš„æ˜¯Embeddingè·ŸReferencingçš„ä½¿ç”¨æ™‚æ©Ÿæ˜¯çœ‹æƒ…æ³æ±ºå®š!ä¸æ˜¯one to manyå°±ä¸€å®šè¦ç”¨Embeddingï¼Œä¹Ÿä¸æ˜¯many to manyå°±ä¸€å®šè¦ç”¨Referencingï¼Œé‚„è¦è€ƒæ…®<strong>è³‡æ–™è¦æ¨¡</strong>ï¼Œå¦‚æœone to manyï¼Œä½†é€£å‡ºå»çš„è³‡æ–™éå¸¸é¾å¤§ï¼Œé‚£ä¸€æ¨£è¦æ”¹ç”¨Referencingæ‰å­˜å¾—ä¸‹ã€‚</p>
<h1 id="crud-in-pymongo"><a class="markdownIt-Anchor" href="#crud-in-pymongo"></a> CRUD in PyMongo</h1>
<p>ä»¥é˜²æœ‰äººä¸çŸ¥é“CRUDæ˜¯ä»€éº¼ï¼ŒCRUDå°æ‡‰åˆ°databaseçš„4å€‹åŸºæœ¬æ“ä½œCreateã€Readã€Updateã€Deleteï¼Œè¦åœ¨MongoDBæ“ä½œCRUDæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œé™¤äº†ä½¿ç”¨MogoDBè‡ªå·±çš„CLIå¤–ï¼Œå®˜æ–¹ä¹Ÿæä¾›è±å¯Œçš„<a href="https://www.mongodb.com/docs/drivers/" title="{rel='nofollow'}">libraries</a>ï¼Œä»¥pythonä¾†èªªå°±æœ‰å…©å€‹librariesï¼ŒPyMongoè² è²¬è™•ç†åŒæ­¥é€£ç·šã€Motorè² è²¬è™•ç†éåŒæ­¥é€£ç·šï¼Œæ¥ä¸‹ä¾†æœƒä»‹ç´¹å¦‚ä½•ä½¿ç”¨PyMongoä¾†æ“ä½œCRUDã€‚</p>
<h2 id="beforehand"><a class="markdownIt-Anchor" href="#beforehand"></a> Beforehand</h2>
<p>ç¬¬ä¸€æ­¥ç•¶ç„¶æ˜¯è¦å…ˆå®‰è£å¥—ä»¶:</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">! pip install pymongo</span><br></pre></td></tr></table></figure>
<p>æ¥è‘—æˆ‘å€‘importå¥—ä»¶ä¸¦å»ºç«‹é€£ç·š:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pymongo <span class="keyword">import</span> MongoClient</span><br><span class="line">client = MongoClient(CONNECTION_STRING)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>CONNECTION_STRING</code>çš„æ ¼å¼é•·é€™æ¨£ï¼Œè¨˜å¾—è¦æ›æˆè‡ªå·±çš„å¸³è™Ÿã€å¯†ç¢¼:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mongodb+srv://&lt;user_name&gt;:&lt;password&gt;@thrifty.0xdedx2.mongodb.net/?retryWrites=true&amp;w=majority</span><br></pre></td></tr></table></figure>
<p>é€™ä¸²æ±è¥¿å¥½é•·å–”è¨˜ä¸èµ·ä¾†æ€éº¼è¾¦? é€²å…¥mongodb atlaså¾Œï¼Œå¯ä»¥åœ¨ Connect â†’ Drivers â†’ python è£¡æ‰¾åˆ°<br />
<img src="/images/2023/05/05/mongodb_atlas_connect.png" alt="mongodb atlas connect" /><br />
<img src="/images/2023/05/05/mongodb_atlas_connection_string.png" alt="mongodb atlas connection string" /></p>
<p>æˆ‘å€‘å¯ä»¥ç›´æ¥é€éclientç‰©ä»¶ä¾†å»ºç«‹æˆ–å–ç”¨databaseï¼Œå¯ä»¥ä½¿ç”¨key-valueçš„æ–¹å¼æˆ–å‘¼å«objectçš„æ–¹å¼ï¼Œèˆ‰ä¾‹ä¾†èªªæˆ‘æƒ³è¦createä¸€å€‹åå«test_databaseçš„databaseï¼Œé‚£æˆ‘å¯ä»¥ç”¨:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">database = client.test_database <span class="comment"># or</span></span><br><span class="line">database = client[<span class="string">&#x27;test_database&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>åŒç†ï¼Œæˆ‘å€‘å¯ä»¥é€édbç‰©ä»¶ä¾†å»ºç«‹æˆ–å–ç”¨collection:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">collection = database.test_collection <span class="comment"># or</span></span><br><span class="line">collection = database[<span class="string">&#x27;test_collection&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œäº‹å‰å·¥ä½œæº–å‚™å®Œæˆ!</p>
<h2 id="create"><a class="markdownIt-Anchor" href="#create"></a> Create</h2>
<p>åœ¨PyMongoä¸­ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨<code>insert_one</code>/<code>insert_many</code>ä¾†æ’å…¥æ–°çš„document:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦æ’å…¥çš„è³‡æ–™</span></span><br><span class="line">a = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;</span><br><span class="line">b = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;</span><br><span class="line">c = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">collection.insert_one(a)       <span class="comment"># æ’å…¥ä¸€å€‹æª”æ¡ˆ</span></span><br><span class="line">collection.insert_many([b, c]) <span class="comment"># æ’å…¥å¤šå€‹æª”æ¡ˆ</span></span><br></pre></td></tr></table></figure>
<h2 id="read"><a class="markdownIt-Anchor" href="#read"></a> Read</h2>
<p>åœ¨PyMongoä¸­ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨<code>find_one</code>æˆ–<code>find</code>ä¾†å°‹æ‰¾ä¸€å€‹æˆ–å¤šå€‹çš„document:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># find_oneæœƒå›å‚³ç¬¦åˆæ¢ä»¶çš„ç¬¬ä¸€ç­†è³‡æ–™(æ²’æ”¾æ¢ä»¶çš„è©±å°±æ˜¯collectionçš„ç¬¬ä¸€ç­†doc)</span></span><br><span class="line">collection.find_one()</span><br><span class="line"></span><br><span class="line"><span class="comment"># findæœƒå›å‚³æ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ï¼Œä¸¦å°‡å…¶åŒ…è£ç‚ºä¸€å€‹é¡ä¼¼iteratorçš„ç‰©ä»¶(æ²’æ”¾æ¢ä»¶çš„è©±å°±æ˜¯collectionè£¡æ‰€æœ‰doc)</span></span><br><span class="line">docs = collection.find()</span><br><span class="line"><span class="comment"># æˆ‘å€‘å¯ä»¥å°‡è©²ç‰©ä»¶æ”¾å…¥forè¿´åœˆä¸­æŸ¥çœ‹çµæœ</span></span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:</span><br><span class="line">  <span class="built_in">print</span>(doc)</span><br></pre></td></tr></table></figure>
<p>æˆ‘å€‘å¯ä»¥åœ¨functionä¸­åŠ å…¥æ¢ä»¶ï¼Œä¾†æŸ¥æ‰¾ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ï¼Œå› ç‚ºæ“ä½œéƒ½å·®ä¸å¤šï¼Œæ‰€ä»¥æ¥ä¸‹ä¾†åªç”¨<code>find_one</code>åšç¤ºç¯„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">collection.find_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;a&#x27;</span>&#125;)</span><br><span class="line">collection.find_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;) <span class="comment"># å¯ä»¥æ”¾å¤šå€‹æ¢ä»¶</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç¢¼æœƒå¹«æˆ‘å€‘æ‰¾åˆ°nameç­‰æ–¼açš„è³‡æ–™ï¼Œä½†å…¶å¯¦é€™æ˜¯ä¸€å€‹ç°¡åŒ–çš„å¯«æ³•ï¼ŒMongoDBåœ¨é€²è¡Œæ¢ä»¶ç¯©é¸æ™‚é€šå¸¸æœƒé€é<strong>Comparison Operators</strong>çš„å¹«å¿™ï¼Œå¯¦éš›ä¸Šå®Œæ•´çš„å¯«æ³•é•·é€™æ¨£:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">collection.find_one(&#123;<span class="string">&#x27;name&#x27;</span>: &#123;<span class="string">&#x27;$eq&#x27;</span>: <span class="string">&#x27;a&#x27;</span>&#125;, <span class="string">&#x27;gender&#x27;</span>: &#123;<span class="string">&#x27;$eq&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>é€™è£¡çš„<code>$eq</code>å°±æ˜¯equal toçš„æ„æ€ï¼Œå› ç‚ºæ˜¯æœ€åŸºæœ¬çš„æ“ä½œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¸å¯«ï¼Œå¦å¤–é‚„æœ‰å¾ˆå¤šç”¨æ–¼æ¢ä»¶åˆ¤æ–·çš„operatorï¼Œèˆ‰ä¾‹ä¾†èªª:</p>
<blockquote>
<p><code>$gt</code> : greater to<br />
<code>$lt</code> : lower to<br />
<code>$gte</code> : greater or equal to<br />
<code>$lte</code> : lower or equal to<br />
<code>$ne</code> : not equal to</p>
</blockquote>
<p>é™¤äº†<strong>Comparison Operators</strong>å¤–ï¼Œåœ¨è™•ç†å¤šå€‹æ¢ä»¶æ™‚ï¼Œæˆ‘å€‘é€šå¸¸éœ€è¦ä½¿ç”¨<strong>Logical Operators</strong>ä¾†å¹«åŠ©æˆ‘å€‘åšå¤šæ¢ä»¶çš„åˆ¤æ–·ï¼Œä¸Šé¢ä¾‹å­åŒæ¨£å› ç‚ºæ˜¯åŸºæœ¬æ“ä½œæ‰€ä»¥å¯ä»¥ç›´æ¥å¯«ï¼Œå¯¦éš›ä¸Šä¹Ÿå¯ä»¥é€™æ¨£å¯«:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">collection.find_one(&#123;<span class="string">&#x27;$and&#x27;</span>: [&#123;<span class="string">&#x27;name&#x27;</span>: &#123;<span class="string">&#x27;$eq&#x27;</span>: <span class="string">&#x27;a&#x27;</span>&#125;&#125;, &#123;<span class="string">&#x27;gender&#x27;</span>: &#123;<span class="string">&#x27;$eq&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;&#125;]&#125;)</span><br></pre></td></tr></table></figure>
<p>åŸºæœ¬ä¸Šè·Ÿä¸€èˆ¬ç¨‹å¼èªè¨€çš„ç”¨æ³•å¾ˆåƒï¼Œå¸¸è¦‹çš„æœ‰:</p>
<blockquote>
<p><code>$or</code> : or<br />
<code>$not</code> : not</p>
</blockquote>
<p>ä¸Šé¢åªä»‹ç´¹äº†éƒ¨åˆ†çš„query operatorsï¼Œæƒ³äº†è§£æ›´å¤šquery operatorså¯ä»¥åƒè€ƒ<a href="https://www.mongodb.com/docs/manual/reference/operator/query/" title="{rel='nofollow'}">é€™è£¡</a>ã€‚</p>
<h2 id="update"><a class="markdownIt-Anchor" href="#update"></a> Update</h2>
<p>PyMongoä¸­ç”¨ä¾†æ›´æ–°documentçš„functionæœ‰ä¸‰å¤§é¡ï¼Œåˆ†åˆ¥æ˜¯</p>
<ol>
<li><code>replace_one</code></li>
<li><code>update_one</code>/<code>update_many</code></li>
</ol>
<p>å·®åˆ¥åœ¨æ–¼replaceæœƒæŠŠæ•´å€‹documnetéƒ½å–ä»£ç‚ºæ–°çš„ï¼Œupdateå‰‡åªæœƒå»æ›´æ–°documentä¸­è¢«æŒ‡å®šçš„éƒ¨åˆ†ã€‚å…©è€…åœ¨ä½¿ç”¨ä¸Šéƒ½ç”±ä¸‰å€‹éƒ¨åˆ†çµ„æˆï¼Œåˆ†åˆ¥æ˜¯filterã€replacement/updateå’Œoptionsï¼Œå…¶ä¸­filteræ˜¯ç¯©é¸çš„æ¢ä»¶ï¼Œå¯«æ³•è·Ÿå‰é¢findä¸€æ¨£ï¼Œreplacement/updateæ˜¯è¦æ›´æ–°çš„document/éƒ¨åˆ†documentï¼Œoptionså‰‡æ˜¯æ›´æ–°æ™‚å¯ä»¥è¨­å®šçš„é¸é …ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># template</span></span><br><span class="line">collection.replace_one(<span class="built_in">filter</span>, replacement, options) <span class="comment"># å–ä»£ç¬¦åˆæ¢ä»¶çš„è³‡æ–™çš„ç¬¬ä¸€ç­†è³‡æ–™</span></span><br><span class="line">collection.update_one(<span class="built_in">filter</span>, update, options)       <span class="comment"># æ›´æ–°ç¬¦åˆæ¢ä»¶çš„ç¬¬ä¸€ç­†è³‡æ–™</span></span><br><span class="line">collection.update_many(<span class="built_in">filter</span>, update, options)      <span class="comment"># æ›´æ–°ç¬¦åˆæ¢ä»¶çš„æ‰€æœ‰è³‡æ–™</span></span><br></pre></td></tr></table></figure>
<p>è¦ç‰¹åˆ¥ç•™æ„çš„æ˜¯ï¼Œåœ¨updateçš„éƒ¨åˆ†ä¸€å®šè¦æ­é…ä½¿ç”¨<strong>Update Operators</strong>ï¼Œå¦å‰‡æœƒåŸ·è¡Œå¤±æ•—!å¸¸ç”¨çš„operatorsæœ‰:</p>
<blockquote>
<p><code>$set</code> : set to new value<br />
<code>$push</code>: appends value to an array<br />
<code>$inc</code> : increased by value</p>
</blockquote>
<p>æœ€å¾Œoptionséƒ¨åˆ†ï¼Œé€™é‚Šåªææœ€å¸¸è¢«ä½¿ç”¨åˆ°çš„<code>upsert</code>(update+insert)ï¼Œé è¨­ç‚º<code>False</code>ï¼Œå¦‚æœå°‡<code>upsert</code>è¨­ç‚º<code>True</code>çš„è©±ï¼Œé‚£å°±ç®—filteréƒ¨åˆ†æ²’æœ‰æ‰¾åˆ°ç¬¦åˆçš„documentï¼Œä¹Ÿæœƒé †ä¾¿å¹«æˆ‘å€‘åŸ·è¡Œinsertçš„å‹•ä½œã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°‹æ‰¾nameç‚ºdçš„documentä¸¦å–ä»£ç‚ºæ–°documnetï¼Œå› ç‚ºæ²’æœ‰é€™å€‹documentè€Œä¸”upsert=Trueï¼Œæ‰€ä»¥æœƒç›´æ¥insert</span></span><br><span class="line">collection.replace_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;d&#x27;</span>&#125;, &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;arr&#x27;</span>: []&#125;, upsert=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># å°‡nameé‡æ–°å‘½å</span></span><br><span class="line">collection.update_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;d&#x27;</span>&#125;, &#123;<span class="string">&#x27;$set&#x27;</span>: &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;e&#x27;</span>&#125;&#125;)</span><br><span class="line"><span class="comment"># æŠŠitemæ¨å…¥arrayç•¶ä¸­</span></span><br><span class="line">collection.update_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;e&#x27;</span>&#125;, &#123;<span class="string">&#x27;$push&#x27;</span>: &#123;<span class="string">&#x27;arr&#x27;</span>: <span class="string">&#x27;item&#x27;</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="delete"><a class="markdownIt-Anchor" href="#delete"></a> Delete</h2>
<p>PyMongoä¸­ç”¨ä¾†åˆªé™¤documentçš„functionæ˜¯<code>delete_one</code>èˆ‡<code>delete_many</code>ï¼Œç”¨æ³•è·ŸfindåŸºæœ¬ä¸€æ¨£~</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">collection.delete_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;a&#x27;</span>&#125;)  <span class="comment"># åˆªé™¤ç¬¦åˆæ¢ä»¶çš„ç¬¬ä¸€ç­†è³‡æ–™</span></span><br><span class="line">collection.delete_many(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;a&#x27;</span>&#125;) <span class="comment"># åˆªé™¤ç¬¦åˆæ¢ä»¶çš„æ‰€æœ‰è³‡æ–™</span></span><br></pre></td></tr></table></figure>
<h2 id="bulk_write"><a class="markdownIt-Anchor" href="#bulk_write"></a> bulk_write</h2>
<p>å‰é¢çš„æ“ä½œéƒ½ä¸€æ¬¡é‡å°ä¸€å€‹æ¢ä»¶é€²è¡Œå‹•ä½œï¼Œå‡å¦‚æˆ‘å€‘æƒ³è¦å¿«é€Ÿåœ°åŸ·è¡Œå¤šå€‹ä¸åŒå‹•ä½œè©²æ€éº¼è¾¦å‘¢? é€™æ™‚æˆ‘å€‘å¯ä»¥å°‡åŸå…ˆçš„CRUDæŒ‡ä»¤åŒ…è£æˆObjectï¼Œä¸¦é€é<code>bulk_write</code>ä¾†é€²è¡Œæ‰¹æ¬¡æ“ä½œã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pymongo <span class="keyword">import</span> InsertOne, DeleteMany, ReplaceOne, UpdateOne</span><br><span class="line">result = colection.bulk_write([</span><br><span class="line">    DeleteMany(&#123;&#125;),</span><br><span class="line">    InsertOne(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;),</span><br><span class="line">    InsertOne(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;),</span><br><span class="line">    InsertOne(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>&#125;),</span><br><span class="line">    ReplaceOne(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;d&#x27;</span>&#125;, &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;arr&#x27;</span>: []&#125;, upsert=<span class="literal">True</span>),</span><br><span class="line">    UpdateOne(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;d&#x27;</span>&#125;, &#123;<span class="string">&#x27;$set&#x27;</span>: &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;e&#x27;</span>&#125;&#125;),</span><br><span class="line">    UpdateOne(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;e&#x27;</span>&#125;, &#123;<span class="string">&#x27;$push&#x27;</span>: &#123;<span class="string">&#x27;arr&#x27;</span>: <span class="string">&#x27;item&#x27;</span>&#125;&#125;)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h1 id="çµèª"><a class="markdownIt-Anchor" href="#çµèª"></a> çµèª</h1>
<p>MongoDBåœ¨ç¶²è·¯ä¸Šçš„æ•™å­¸è³‡æºçœŸçš„å¾ˆè±å¯Œï¼Œå®˜æ–¹ä¹Ÿæœ‰æä¾›<a href="https://learn.mongodb.com/" title="{rel='nofollow'}">å…è²»èª²ç¨‹</a>ï¼Œæƒ³è¦ä¸Šæ‰‹çœŸçš„ä¸æ˜¯ä¸€ä»¶é›£äº‹ï¼Œæˆ‘éƒ½é‚Šå¯«é‚Šæ‡·ç–‘è‡ªå·±å¯«é€™ç¯‡åˆ°åº•æœ‰å¤šå¤§åƒ¹å€¼ï¼Œå› ç‚ºç¶²è·¯ä¸Šå…¶ä»–åœ°æ–¹å¤§æ¦‚ä¹Ÿéƒ½æ‰¾çš„åˆ°é¡ä¼¼çš„å…§å®¹ï¼Œä¸éæŠ±æŒè‘—ç•¶åšç­†è¨˜èªªä¸å®šå“ªå¤©æ—ºå­£æœƒæƒ³å›ä¾†çœ‹çš„ç²¾ç¥ï¼Œé‚„æ˜¯ä¹–ä¹–æŠŠä»–å¯«å®Œäº†XDDD</p>
]]></content>
      <categories>
        <category>Back-end</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>ç³»çµ±æ¶æ§‹ç­†è¨˜ - å‚ç›´æ“´å±•ã€æ°´å¹³æ“´å±•</title>
    <url>/posts/Back-end/2024/scaling/</url>
    <content><![CDATA[<p><img src="/images/2024/01/17/scaling.png" alt="scaling" /></p>
<p>é€™ç¯‡æ–‡ç« æœƒä»‹ç´¹å‚ç›´æ“´å±•ä»¥åŠæ°´å¹³æ“´å±•ï¼Œä¸¦ä»¥è³‡æ–™åº«çš„æ°´å¹³æ“´å±•ç‚ºå»¶ä¼¸ï¼Œä»‹ç´¹è®€å¯«åˆ†é›¢èˆ‡è³‡æ–™åº«åˆ‡åˆ† (Sharding)ã€‚</p>
<span id="more"></span>
<h1 id="å‚ç›´æ“´å±•"><a class="markdownIt-Anchor" href="#å‚ç›´æ“´å±•"></a> å‚ç›´æ“´å±•</h1>
<p>é€™å°æ©Ÿå™¨ä¸è¡Œé‚£æˆ‘å°±æ›ä¸€å°æ›´å¥½çš„ã€‚<br />
å…¶å¯¦å°±æ˜¯å‡ç´šç¡¬é«”ï¼Œå¥½è™•å°±æ˜¯ç°¡å–®ç›´æ¥ï¼Œèƒ½ç”¨å‚æ“´å±•è§£æ±ºé‚£å°±å„ªå…ˆè€ƒæ…®å‚ç›´æ“´å±•å§ã€‚ä½†å‚ç›´æ“´å±•æ˜¯æœ‰æ¥µé™çš„ï¼Œè€Œä¸”è¶Šå¥½çš„æ©Ÿå™¨è¶Šè²´ï¼Œé€™æ™‚å°±å¯ä»¥è€ƒæ…®æ°´å¹³æ“´å±•ã€‚</p>
<h1 id="æ°´å¹³æ“´å±•"><a class="markdownIt-Anchor" href="#æ°´å¹³æ“´å±•"></a> æ°´å¹³æ“´å±•</h1>
<p>ä¸€å°æ©Ÿå™¨ä¸è¡Œé‚£æˆ‘å°±å¤šç”¨å¹¾å°ã€‚<br />
è¦å¯¦ç¾ä¼ºæœå™¨çš„æ°´å¹³æ“´å±•æ¯”è¼ƒå®¹æ˜“ï¼Œä¸å¤–ä¹å°±æ˜¯å¤šé–‹å¹¾å°æ©Ÿå™¨ï¼Œç„¶å¾Œåšå¥½ load balanceï¼Œé€™è£¡é‡é»ä»‹ç´¹<strong>è³‡æ–™åº«</strong>çš„æ°´å¹³æ“´å±•ï¼Œå¤§è‡´ä¸Šå¯ä»¥åˆ†ç‚ºå…©å€‹ç­–ç•¥ï¼š</p>
<h2 id="è®€å¯«åˆ†é›¢"><a class="markdownIt-Anchor" href="#è®€å¯«åˆ†é›¢"></a> è®€å¯«åˆ†é›¢</h2>
<p>åœ¨åŸæœ¬çš„è³‡æ–™åº« (ä¸»ç¯€é») å¤–æ·»åŠ å¹¾å€‹å¾è³‡æ–™åº« (å¾ç¯€é») ï¼Œå‘ä¸»ç¯€é»å¯«å…¥è³‡æ–™ï¼Œè®€å–æ™‚å‰‡å„ªå…ˆè‡ªå¾ç¯€é»è®€å–ã€‚è®€å¯«åˆ†é›¢æœƒé‡åˆ°å¹¾å€‹å•é¡Œï¼š</p>
<ol>
<li><strong>æœ€çµ‚ä¸€è‡´æ€§å•é¡Œ</strong><br />
ç”±æ–¼å¾ç¯€é»çš„æ•¸æ“šæ˜¯è‡ªä¸»ç¯€é»åŒæ­¥éä¾†ï¼Œå› æ­¤ä¸­é–“å‹¢å¿…å­˜åœ¨ä¸€æ™‚é–“å·®ï¼Œå¯èƒ½å°è‡´å¾ç¯€é»çš„æ•¸æ“šä¸æ˜¯æœ€å³æ™‚çš„æ•¸æ“šï¼Œå› æ­¤å¾ç¯€é»çš„æ•¸æ“šåƒ…æ»¿è¶³æœ€çµ‚ä¸€è‡´æ€§ã€‚</li>
<li><strong>å–®å€‹ä¸»ç¯€é»</strong><br />
ç”±æ–¼ä¸»ç¯€é»ä»ç„¶åªæœ‰ä¸€å€‹ï¼Œå¦‚æœé‡åˆ°éœ€è¦å¤§é‡å¯«å…¥çš„ä½œæ¥­ä»ç„¶æœƒå‡ºç¾å µå¡ï¼Œé€™æ™‚å€™å¯èƒ½è¦è€ƒæ…®å¤šå€‹ä¸»ç¯€é»çš„æ¶æ§‹ï¼Œä¸éå°±è·Ÿå‰ä¸€é»ä¸€æ¨£æœƒé‡åˆ°è³‡æ–™åŒæ­¥çš„å•é¡Œï¼Œé‚„éœ€è¦è€ƒæ…®åŒæ™‚æœ‰å¤šå€‹å¯«å…¥æƒ…æ³ä¸‹çš„ race conditionã€‚</li>
</ol>
<h2 id="è³‡æ–™åº«åˆ‡åˆ†-partitioning-sharding"><a class="markdownIt-Anchor" href="#è³‡æ–™åº«åˆ‡åˆ†-partitioning-sharding"></a> è³‡æ–™åº«åˆ‡åˆ† (Partitioning / Sharding)</h2>
<p>å°‡ä¸€å€‹è³‡æ–™åº« (å¤§è³‡æ–™è¡¨) åˆ†å‰²ç‚ºå¤šå€‹å°è³‡æ–™è¡¨ï¼Œä¸¦å°‡å…¶å„²å­˜åœ¨ä¸åŒç¯€é»ä¸Šï¼Œåˆå¯ä»¥åˆ†ç‚º<strong>å‚ç›´åˆ‡åˆ†</strong>èˆ‡<strong>æ°´å¹³åˆ‡åˆ†</strong>ï¼š<br />
<img src="/images/2024/01/17/sharding.png" alt="sharding" /></p>
<h3 id="å‚ç›´åˆ‡åˆ†"><a class="markdownIt-Anchor" href="#å‚ç›´åˆ‡åˆ†"></a> å‚ç›´åˆ‡åˆ†</h3>
<p>æŒ‰ç…§æ¬„ä½ä¾†é€²è¡Œåˆ‡åˆ†ï¼Œé€šå¸¸å¯ä»¥æŒ‰ç…§æ¥­å‹™åŠŸèƒ½ä¾†åšåˆ‡å‰²ï¼Œå¦‚é›»å•†å¹³å°ä¸­çš„è²·å®¶è³‡è¨Šèˆ‡è³£å®¶è³‡è¨Šå°±å¯ä»¥åˆ†é–‹å„²å­˜ã€‚</p>
<h3 id="æ°´å¹³åˆ‡åˆ†"><a class="markdownIt-Anchor" href="#æ°´å¹³åˆ‡åˆ†"></a> æ°´å¹³åˆ‡åˆ†</h3>
<p>æŒ‰ç…§åˆ—ä¾†é€²è¡Œåˆ‡åˆ†ï¼Œä¸»è¦æœ‰å…©ç¨®åˆ‡åˆ†æ–¹æ³•ï¼š</p>
<ol>
<li><strong>æŒ‰ä¸€å®šç¯„åœåˆ‡åˆ†</strong><br />
èˆ‰ä¾‹ä¾†èªª ID &lt;= 10000 ç‚ºç¬¬ä¸€å€‹è¡¨ï¼Œæ¥è‘—æ¯ 10000 ç­†è³‡æ–™ç‚ºä¸€å€‹è¡¨ï¼Œé€™å€‹åšæ³•çš„å¥½è™•æ˜¯<strong>å®¹æ˜“æ–°å¢è¡¨</strong>ï¼Œå£è™•æ˜¯<strong>è¼ƒå·®çš„é™„è¼‰å¹³è¡¡</strong>ï¼Œå› ç‚ºæ–°è³‡æ–™èˆ‡èˆŠè³‡æ–™çš„æ´»èºåº¦å¯èƒ½æœ‰å¾ˆå¤§çš„å·®ç•°ã€‚</li>
<li><strong>ä½¿ç”¨å“ˆå¸Œè¡¨åˆ‡åˆ†</strong><br />
å°‡ ID æ”¾å…¥ä¸€å€‹ Hash Function ä¸­ï¼Œå¦‚ <code>10 % 3 = 1</code>ï¼Œæ ¹æ“š Hash çµæœæ‰¾åˆ°å°æ‡‰çš„è¡¨ï¼Œå¥½è™•æ˜¯æœ‰<strong>è¼ƒä½³çš„é™„è¼‰å¹³è¡¡</strong>ï¼Œç¼ºé»æ˜¯<strong>ä¸å®¹æ˜“æ–°å¢è¡¨</strong>ï¼Œæ–°å¢ä¸€å€‹è¡¨é€šå¸¸æ¶‰åŠåˆ°<strong>ä¿®æ”¹ Hash Function</strong> ä»¥åŠåŸå…ˆè¡¨çš„<strong>æ•¸æ“šé·ç§»</strong>ã€‚</li>
</ol>
<h1 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h1>
<p><a href="https://www.digitalocean.com/community/tutorials/understanding-database-sharding">Understanding Database Sharding</a><br />
<a href="https://blog.csdn.net/Dongguabai/article/details/83578092">é«˜å¹¶å‘ï¼ˆæ°´å¹³æ‰©å±•ï¼Œå‚ç›´æ‰©å±•ï¼‰</a><br />
<a href="https://www.twblogs.net/a/5c99f60fbd9eee434fc6c4d5">æ•¸æ“šåº«çš„å‘ä¸Šæ“´å±•å’Œæ©«å‘æ“´å±•ï¼ˆå³æ°´å¹³æ“´å±•ï¼šè®€å¯«åˆ†é›¢ã€å‚ç›´åˆ‡åˆ†ã€æ°´å¹³åˆ‡åˆ†ï¼‰</a></p>
]]></content>
      <categories>
        <category>Back-end</category>
      </categories>
      <tags>
        <tag>System Design</tag>
        <tag>Scaling</tag>
      </tags>
  </entry>
  <entry>
    <title>ç³»çµ±æ¶æ§‹ç­†è¨˜ - å¸¸è¦‹çš„äº”ç¨®éƒ¨ç½²ç­–ç•¥</title>
    <url>/posts/Back-end/2024/deployment-strategies/</url>
    <content><![CDATA[<p><img src="/images/2024/01/16/strategies.png" alt="strategies" /></p>
<p>é€™ç¯‡æ–‡ç« ç°¡å–®ç´€éŒ„äº†å¸¸è¦‹çš„äº”ç¨®éƒ¨ç½²ç­–ç•¥: Big Bang Deploymentã€Rolling Deployment (æ»¾å‹•éƒ¨ç½²)ã€Blue-Green Deployment (è—ç¶ éƒ¨ç½²)ã€Canary Deployment (é‡‘çµ²é›€éƒ¨ç½²) èˆ‡ Shadow Deployment (å½±å­éƒ¨ç½²)ã€‚</p>
<span id="more"></span>
<h1 id="big-bang-deployment"><a class="markdownIt-Anchor" href="#big-bang-deployment"></a> Big Bang Deployment</h1>
<p>åå­—è½èµ·ä¾†å¾ˆ Dramatic çš„éƒ¨ç½²ç­–ç•¥ï¼Œå°‡èˆŠç‰ˆæœ¬å®Œå…¨ä¸‹ç·šå¾Œéƒ¨ç½²æ–°ç‰ˆæœ¬ã€‚</p>
<ul>
<li>å„ªé»:
<ul>
<li>easyã€ä¸€æ¬¡æ€§å®Œæˆ</li>
</ul>
</li>
<li>ç¼ºé»:
<ul>
<li>æœ‰ downtimeï¼Œä¸€èˆ¬ç”Ÿç”¢ç’°å¢ƒä¸‹ä¸æœƒä½¿ç”¨</li>
</ul>
</li>
</ul>
<h1 id="rolling-deployment-æ»¾å‹•éƒ¨ç½²"><a class="markdownIt-Anchor" href="#rolling-deployment-æ»¾å‹•éƒ¨ç½²"></a> Rolling Deployment (æ»¾å‹•éƒ¨ç½²)</h1>
<p><img src="/images/2024/01/16/rolling.png" alt="rolling" /></p>
<p>å°‡èˆŠç‰ˆæœ¬é€æ­¥ (one by one) æ›´æ–°ç‚ºæ–°ç‰ˆæœ¬ï¼Œåœ¨é€™å€‹éç¨‹ä¸­ï¼ŒèˆŠç‰ˆæœ¬å’Œæ–°ç‰ˆæœ¬æœƒå…±å­˜ä¸€æ®µæ™‚é–“ã€‚</p>
<ul>
<li>å„ªé»:
<ul>
<li>no downtime</li>
</ul>
</li>
<li>ç¼ºé»:
<ul>
<li>æ–°èˆŠç‰ˆæœ¬é–“æ²’æœ‰éš”é›¢ï¼Œå¯èƒ½éœ€è¦è™•ç†ç‰ˆæœ¬ä¹‹é–“çš„ç›¸å®¹æ€§èˆ‡æ•¸æ“šä¸€è‡´æ€§</li>
<li>rollback ä¹Ÿæ˜¯é€æ­¥æ»¾å›å»ï¼Œè¤‡é›œä¸”è€—æ™‚</li>
</ul>
</li>
</ul>
<h1 id="blue-green-deployment-è—ç¶ éƒ¨ç½²"><a class="markdownIt-Anchor" href="#blue-green-deployment-è—ç¶ éƒ¨ç½²"></a> Blue-Green Deployment (è—ç¶ éƒ¨ç½²)</h1>
<p><img src="/images/2024/01/16/blue-green.png" alt="blue-green" /></p>
<p>åŒæ™‚ç¶­è­·å…©å€‹å¹³è¡Œçš„ç’°å¢ƒï¼Œä¸€å€‹ç‚ºä¸»è¦ç’°å¢ƒ (Blue)ï¼Œå¦ä¸€å€‹ç‚ºå³å°‡ä¸Šç·šçš„æ–°ç‰ˆæœ¬ (Green)ï¼Œæ–¼æ¸¬è©¦ç’°å¢ƒæ¸¬è©¦å®Œæ–°ç‰ˆæœ¬å¾Œï¼Œç›´æ¥å°‡å…©å€‹ç’°å¢ƒçš„æµé‡åšåˆ‡æ›ã€‚</p>
<ul>
<li>å„ªé»:
<ul>
<li>no downtime</li>
<li>ç›´æ¥åˆ‡æ›æµé‡å³å¯å®Œæˆç‰ˆæœ¬åˆ‡æ›ï¼Œrollback ä¹Ÿæ˜¯</li>
</ul>
</li>
<li>ç¼ºé»:
<ul>
<li>è¦åŒæ™‚ç¶­è­·å…©å€‹ç’°å¢ƒï¼Œæˆæœ¬é«˜</li>
</ul>
</li>
</ul>
<h1 id="canary-deployment-é‡‘çµ²é›€éƒ¨ç½²"><a class="markdownIt-Anchor" href="#canary-deployment-é‡‘çµ²é›€éƒ¨ç½²"></a> Canary Deployment (é‡‘çµ²é›€éƒ¨ç½²)</h1>
<p><img src="/images/2024/01/16/canary.png" alt="canary" /></p>
<p>å°‡æ–°ç‰ˆæœ¬é‡‹å‡ºçµ¦å°‘é‡ç”¨æˆ¶åšæ¸¬è©¦ï¼Œæ¸¬è©¦æ²’å•é¡Œå¾Œæ‰å°‡å‰©ä¸‹çš„éƒ¨ç½²ç‚ºæ–°ç‰ˆæœ¬ã€‚</p>
<ul>
<li>å„ªé»:
<ul>
<li>no downtime</li>
<li>èƒ½æ–¼ç”Ÿç”¢ç’°å¢ƒä¸­è©•ä¼°æ–°ç‰ˆæœ¬æ•ˆèƒ½ï¼Œé™ä½æ–°ç‰ˆæœ¬é¢¨éšª</li>
<li>rollback è¼ƒå®¹æ˜“</li>
</ul>
</li>
<li>ç¼ºé»:
<ul>
<li>éƒ¨ç½²æ™‚é–“è¼ƒé•·</li>
<li>æŸäº›å•é¡Œç„¡æ³•é å°‘é‡ç”¨æˆ¶å°±ç™¼ç¾</li>
</ul>
</li>
<li>èˆ‡ Rolling Deployment çš„å·®ç•°
<ul>
<li>Canary Deployment æ˜¯éšæ®µå¼çš„éç¨‹ï¼Œå…ˆéƒ¨ç½²å°‘éƒ¨åˆ†ï¼Œç¢ºå®šæ²’å•é¡Œæ‰æ“´å¤§éƒ¨ç½²</li>
<li>Rolling Deployment å‰‡é€£çºŒçš„éç¨‹ï¼Œä¸€æ¬¡å°æ•´å€‹ç³»çµ±åšå‡ç´šï¼Œåªæ˜¯éç¨‹ä¸Šæ˜¯é€æ­¥éƒ¨ç½²</li>
</ul>
</li>
</ul>
<h1 id="shadow-deployment-å½±å­éƒ¨ç½²"><a class="markdownIt-Anchor" href="#shadow-deployment-å½±å­éƒ¨ç½²"></a> Shadow Deployment (å½±å­éƒ¨ç½²)</h1>
<p>åŒæ™‚ç¶­è­·å…©å€‹å¹³è¡Œçš„ç’°å¢ƒï¼Œæ–°ç‰ˆæœ¬åœ¨å¹•å¾Œé‹è¡Œ (in the shadow)ï¼Œä½¿ç”¨è€…çš„ request æœƒè¢«è¤‡è£½ä¸€ä»½åˆ°æ–°ç‰ˆæœ¬ç”¨æ–¼æ¸¬è©¦</p>
<ul>
<li>å„ªé»:
<ul>
<li>ä¸æœƒå°ä½¿ç”¨è€…é€ æˆå¯¦éš›å½±éŸ¿ï¼ŒåŒæ™‚èƒ½æ¸¬è©¦æ–°ç‰ˆæœ¬æ•ˆèƒ½</li>
</ul>
</li>
<li>ç¼ºé»
<ul>
<li>å¯¦ä½œä¸Šæ¯”è¼ƒå›°é›£</li>
<li>æˆæœ¬é«˜</li>
</ul>
</li>
</ul>
<h2 id="å…¶ä»–-feature-toggle"><a class="markdownIt-Anchor" href="#å…¶ä»–-feature-toggle"></a> å…¶ä»–: Feature Toggle</h2>
<p><img src="/images/2024/01/16/feature-toggle.png" alt="feature-toggle" /></p>
<p>å°é¢çš„åœ–ç‰‡è£¡é‚„æœ‰æåˆ°ä¸€å€‹ Feature Toggleï¼Œæ¦‚å¿µæ˜¯åœ¨ç¨‹å¼ä¸­è¨­è¨ˆä¸€å€‹é–‹é—œä¾†æ§åˆ¶æ–°åŠŸèƒ½çš„ç‹€æ…‹ï¼Œå¯ä»¥é‡å°ç‰¹å®šç”¨æˆ¶é–‹å•Ÿï¼Œç”¨ä¾†è§€å¯Ÿæ–°åŠŸèƒ½çš„æ•ˆèƒ½ã€åé¥‹å¦‚ä½•ï¼Œé€šå¸¸æ˜¯ç”¨ä¾†åš A/B Testï¼Œæœ¬è³ªä¸Šè·Ÿå‰é¢æåˆ°çš„å¹¾å€‹éƒ¨ç½²æ–¹æ³•æœ‰é»å·®ç•°ã€‚</p>
]]></content>
      <categories>
        <category>Back-end</category>
      </categories>
      <tags>
        <tag>System Design</tag>
        <tag>Deployment</tag>
      </tags>
  </entry>
  <entry>
    <title>Python éš¨ä¾¿å¯« - ASCII Spinning Cube</title>
    <url>/posts/Others/2024/ascii-spinning-cube/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p>å› ç‚ºè¢«<a href="https://www.a1k0n.net/2011/07/20/donut-math.html">æ—‹è½‰ç”œç”œåœˆ</a>çµ¦é©šè±”åˆ°ï¼Œæ‰€ä»¥ä¹Ÿæƒ³è¦è‡ªå·±ä¾†å¯«å¯«çœ‹ï¼Œä¸éç”œç”œåœˆçš„æ•¸å­¸çœ‹äº†é ­å¥½ç—›ï¼Œæ‰€ä»¥æ”¹å¯«ç¨å¾®ç°¡å–®ä¸€é»çš„<strong>æ—‹è½‰ç«‹æ–¹é«”</strong>ï¼Œä¸å›‰å—¦å…ˆçœ‹æˆæœï¼š</p>
<p><img src="/images/2024/03/23/spinning_cube_new.gif" alt="Spinning Cube" /></p>
<span id="more"></span>
<h2 id="problem-analysis"><a class="markdownIt-Anchor" href="#problem-analysis"></a> Problem Analysis</h2>
<p>è¦åœ¨è¢å¹•ä¸Šç¹ªè£½ä¸€å€‹æ—‹è½‰çš„ç«‹æ–¹é«”ï¼Œæˆ‘å€‘å¤§è‡´ä¸Šè¦è™•ç†å…©å€‹å•é¡Œï¼Œä¸€å€‹æ˜¯ <strong>3 ç¶­ç©ºé–“ä¸­ç‰©é«”çš„æ—‹è½‰</strong>ï¼Œå¦å¤–ä¸€å€‹æ˜¯<strong>å°‡ 3D çš„ç‰©é«”æŠ•å½±åˆ° 2D çš„å¹³é¢ä¸Š</strong>ã€‚</p>
<p><img src="/images/2024/03/23/cube_projection.png" alt="Cube Projection" /></p>
<p>åœ¨é–‹å§‹ä¹‹å‰å…ˆä¾†å®šç¾©ä¸€ä¸‹åº§æ¨™ç©ºé–“ï¼Œå¾æˆ‘å€‘çš„è§’åº¦çœ‹åƒç‰©é«”ï¼Œç‰©é«”çš„å·¦å³æœƒæ˜¯ x è»¸ï¼Œç‰©é«”çš„ä¸Šä¸‹æ˜¯ y è»¸ï¼Œæˆ‘å€‘åˆ°ç‰©é«”çš„æ–¹å‘å‰‡æ˜¯ z è»¸ã€‚</p>
<p><img src="/images/2024/03/23/coordinate.png" alt="Coordinate Space" /></p>
<h2 id="rotation-matrix"><a class="markdownIt-Anchor" href="#rotation-matrix"></a> Rotation Matrix</h2>
<p>ç‰©é«”åœ¨ä¸‰ç¶­ç©ºé–“ä¸­çš„æ—‹è½‰å¯ä»¥ä½¿ç”¨æ—‹è½‰çŸ©é™£ä¾†è¨ˆç®—ï¼Œä»¥æ²¿è‘— z è»¸çš„ä¸»å‹•æ—‹è½‰ä¾†èªª (åœ¨ xy å¹³é¢é€†æ™‚é‡)ï¼Œæˆ‘å€‘å°±å¯ç”¨ä¸‹é¢çš„æ—‹è½‰çŸ©é™£ä¾†æ±‚å¾—æ—‹è½‰å¾Œçš„ä½ç½®ï¼š</p>
<p><img src="/images/2024/03/23/rotation_matrix_z.png" alt="Rotation Matrix Z" /></p>
<p>èˆ‰ä¾‹ä¾†èªªï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{[x, y, z] = [1, 0, 0]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span> æ²¿ z è»¸é€†æ™‚é‡æ—‹è½‰ 90% æœƒè®Šæˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{[x, y, z] = [0, 1, 0]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span>ï¼š</p>
<p><img src="/images/2024/03/23/rotation_matrix_example.png" alt="Rotation Matrix Example" /></p>
<p>è€Œæ—‹è½‰çŸ©é™£çš„æ•ˆæœæ˜¯å¯ä»¥ç–ŠåŠ çš„ï¼Œå› æ­¤æˆ‘å€‘å¦‚æœæˆ‘å€‘ä¾åºæ²¿ zè»¸ã€yè»¸ã€xè»¸é€²è¡Œæ—‹è½‰ï¼Œå¾—åˆ°çš„æ—‹è½‰çŸ©é™£å¦‚ä¸‹ï¼š</p>
<p><img src="/images/2024/03/23/rotation_matrix_xyz.png" alt="Rotation Matrix XYZ" /></p>
<p>æœ‰äº†æ—‹è½‰çŸ©é™£å¾Œï¼Œæˆ‘å€‘å°±èƒ½å»è¨ˆç®—ç«‹æ–¹é«”çš„æ—‹è½‰äº†ï¼</p>
<h2 id="perspective-projection"><a class="markdownIt-Anchor" href="#perspective-projection"></a> Perspective Projection</h2>
<p><img src="/images/2024/03/23/perspective_projection.png" alt="Perspective Projection" /></p>
<p>æŠ•å½±çš„éƒ¨åˆ†å…¶å¯¦æ²’æœ‰åƒé …ä¸­çš„é›£ï¼Œç”¨çš„çš„åªæ˜¯æœ€åŸºç¤çš„<strong>ç­‰æ¯”ä¸‰è§’å½¢</strong>çš„æ¦‚å¿µï¼Œå‡è¨­æˆ‘å€‘çš„çœ¼ç›åˆ°ç‰©é«”çš„è·é›¢æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">{z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span>ï¼Œè€Œæˆ‘å€‘çš„çœ¼ç›åˆ°è¢å¹•çš„è·é›¢æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>z</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">{z&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå› æ­¤å°‡é» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(x,y)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> æŠ•å½±åˆ°è¢å¹•ä¸Šåˆ†åˆ¥æœƒè½åœ¨ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><mfrac><mrow><mi>x</mi><msup><mi>z</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><mi>z</mi></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle  x&#x27; = {\frac {xz&#x27;}{z}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.114892em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><mfrac><mrow><mi>y</mi><msup><mi>z</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><mi>z</mi></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle y&#x27; = {\frac {yz&#x27;}{z}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.1148919999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4288919999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></span></p>
<h2 id="python-code"><a class="markdownIt-Anchor" href="#python-code"></a> Python Code</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sin, cos</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rotation angles</span></span><br><span class="line">A = B = C = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Screen layout size</span></span><br><span class="line">width = <span class="number">100</span></span><br><span class="line">height = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Cube&#x27;s half side length </span></span><br><span class="line">cubeWidth = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Distances</span></span><br><span class="line">distance_to_screen = <span class="number">20</span></span><br><span class="line">distance_to_cube = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Rotation matrix</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculateX</span>(<span class="params">x, y, z</span>):</span><br><span class="line">    <span class="keyword">return</span> x * cosB * cosC \</span><br><span class="line">    + y * (sinA * sinB * cosC - cosA * sinC) \</span><br><span class="line">    + z * (cosA * sinB * cosC + sinA * sinC)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculateY</span>(<span class="params">x, y, z</span>):</span><br><span class="line">    <span class="keyword">return</span> x * cosB * sinC \</span><br><span class="line">    + y * (sinA * sinB * sinC + cosA * cosC) \</span><br><span class="line">    + z * (cosA * sinB * sinC - sinA * cosC)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculateZ</span>(<span class="params">x, y, z</span>):</span><br><span class="line">    <span class="keyword">return</span> - x * sinB + y * sinA * cosB + z * cosA * cosB</span><br><span class="line"></span><br><span class="line"><span class="comment"># Project 3D cube on 2D screen</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">project</span>(<span class="params">_x, _y, _z, char</span>):</span><br><span class="line">    <span class="comment"># Apply rotation transformations</span></span><br><span class="line">    x = calculateX(_x, _y, _z)</span><br><span class="line">    y = calculateY(_x, _y, _z)</span><br><span class="line">    z = calculateZ(_x, _y, _z) + distance_to_cube</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Perspective projection</span></span><br><span class="line">    z_ratio = distance_to_screen/z</span><br><span class="line">    xp = <span class="built_in">round</span>(width/<span class="number">2</span> + x*<span class="number">2</span>*z_ratio) <span class="comment"># x*2 becasue Letterspacing is smaller than Linespacing</span></span><br><span class="line">    yp = <span class="built_in">round</span>(height/<span class="number">2</span> + y*z_ratio)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Store the points nearest to us</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span>&lt;=xp&lt;width <span class="keyword">and</span> <span class="number">0</span>&lt;=yp&lt;height <span class="keyword">and</span> z_ratio&gt;buffer[yp][xp]):</span><br><span class="line">        buffer[yp][xp] = z_ratio</span><br><span class="line">        charbuffer[yp][xp] = char</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\x1b[2J&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        sinA, sinB, sinC = sin(A), sin(B), sin(C)</span><br><span class="line">        cosA, cosB, cosC = cos(A), cos(B), cos(C)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Initialize buffers to store projected points</span></span><br><span class="line">        buffer = [[<span class="number">0</span>]*width <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(height)]</span><br><span class="line">        charbuffer = [[<span class="string">&#x27; &#x27;</span>]*width <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(height)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Project each point of the cube onto the screen</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(-cubeWidth, cubeWidth+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(-cubeWidth, cubeWidth+<span class="number">1</span>):</span><br><span class="line">                project(x, y, -cubeWidth, <span class="string">&quot;#&quot;</span>)</span><br><span class="line">                project(x, y, cubeWidth, <span class="string">&quot;%&quot;</span>)</span><br><span class="line">                project(x, cubeWidth, y, <span class="string">&quot;&amp;&quot;</span>)</span><br><span class="line">                project(x, -cubeWidth, y, <span class="string">&quot;@&quot;</span>)</span><br><span class="line">                project(cubeWidth, x, y, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">                project(-cubeWidth, x, y, <span class="string">&quot;+&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Clear the screen and print the current state of the 2D projection</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\x1b[H&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> charbuffer:</span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> row:</span><br><span class="line">                <span class="built_in">print</span>(char, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Increment rotation angles for the next frame</span></span><br><span class="line">        A += <span class="number">0.05</span></span><br><span class="line">        B += <span class="number">0.07</span></span><br><span class="line">        C += <span class="number">0.02</span></span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://www.youtube.com/watch?v=p09i_hoFdd0">ASMR Programming - Spinning Cube - No Talking</a><br />
<a href="https://en.wikipedia.org/wiki/Rotation_matrix">Rotation matrix - Wikipedia</a><br />
<a href="https://silverwind1982.pixnet.net/blog/post/165223625">æ—‹è½‰çŸ©é™£(Rotation Matrix) - æ‹¾äººç‰™æ…§- ç—å®¢é‚¦</a></p>
]]></content>
      <categories>
        <category>Others</category>
      </categories>
      <tags>
        <tag>ASCII Art</tag>
        <tag>Rotation Matrix</tag>
        <tag>Perspective Projection</tag>
      </tags>
  </entry>
  <entry>
    <title>Python éš¨ä¾¿å¯« - ç”¨ç‰›é “æ³• (Newton&#39;s method) è¨ˆç®—å…§éƒ¨å ±é…¬ç‡ (IRR)</title>
    <url>/posts/Others/2024/irr-with-newton-method/</url>
    <content><![CDATA[<h2 id="å…§éƒ¨å ±é…¬ç‡-internal-rate-of-returnirr"><a class="markdownIt-Anchor" href="#å…§éƒ¨å ±é…¬ç‡-internal-rate-of-returnirr"></a> å…§éƒ¨å ±é…¬ç‡ (Internal Rate of Returnï¼ŒIRR)</h2>
<p><strong>å…§éƒ¨å ±é…¬ç‡</strong>æ˜¯ä¸€ç¨®ç”¨ä¾†è¡¡é‡æŠ•è³‡æ•ˆç›Šçš„æŒ‡æ¨™ï¼Œå…¶æ¦‚å¿µæ˜¯è¨ˆç®—å‡ºä¸€å€‹<strong>æŠ˜ç¾ç‡</strong>ï¼Œä½¿æ·¨è³‡é‡‘æµå…¥çš„ç¾å€¼èˆ‡æ·¨è³‡é‡‘æµå‡ºçš„ç¾å€¼åŠ ç¸½ç‚º 0ï¼Œä¹Ÿå°±æ˜¯æ·¨ç¾å€¼ç‚º 0 (<strong>NPV=0</strong>)ã€‚</p>
<p>æ·¨ç¾å€¼çš„æ•¸å­¸å…¬å¼å¦‚ä¸‹:</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>P</mi><mi>V</mi><mo>=</mo><mstyle scriptlevel="0" displaystyle="true"><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mfrac><msub><mi>C</mi><mi>t</mi></msub><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mi>r</mi><mo fence="true">)</mo></mrow><mi>t</mi></msup></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{NPV = \displaystyle \sum _{t=0}^{N}{\frac {C_{t}}{\left(1+r\right)^{t}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.176544em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.073456em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span> æ˜¯æŠ˜ç¾ç‡ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> ç‚ºæœŸé–“ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{C_{t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> ç‚ºç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">t</span></span></span></span></span> å¹´çš„æ·¨ç¾é‡‘æµé‡ã€‚<br />
ç•¶æˆ‘å€‘å¸¶å…¥ä¸€å€‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span> èƒ½ä½¿å¾— NPV=0 æ™‚ï¼Œæˆ‘å€‘å°±æŠŠé€™å€‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span> ç¨± IRRã€‚</p>
<span id="more"></span>
<p>ä¸€èˆ¬ä¾†èªªæˆ‘å€‘å¯ä»¥ä½¿ç”¨<strong>æ’å€¼æ³•</strong>ä¾†è¨ˆç®— IRRï¼Œå‡è¨­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span>=5% æ™‚ NPV &gt; 0ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span>=6% æ™‚ NPV &lt; 0ï¼Œé‚£æˆ‘å€‘å°±èƒ½èªª IRR åœ¨ 5%~6% ä¹‹é–“ï¼Œå¯ä»¥ç”¨ <strong>Binary Search</strong> çš„æ¦‚å¿µå»å¯¦ä½œï¼Œä½†é€™æ¬¡æˆ‘æ±ºå®šç”¨é»ä¸ä¸€æ¨£çš„ã€‚</p>
<h2 id="ç‰›é “æ³•-newtons-method"><a class="markdownIt-Anchor" href="#ç‰›é “æ³•-newtons-method"></a> ç‰›é “æ³• (Newtonâ€™s method)</h2>
<p>æ‰€è¬‚çš„<strong>ç‰›é “æ³•</strong>æ˜¯ä¸€ç¨®æ±‚è§£æ–¹ç¨‹å¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{f(x) = 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span> çš„æ ¹çš„æ–¹æ³•ã€‚æˆ‘å€‘æŠŠä¸Šé¢ NPV å…¬å¼è£¡çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span> æ›æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span></span>ï¼Œä¾¿å¯ä»¥æŠŠ NPV è¦–ä½œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{f(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> ï¼Œå‰‡ IRR å³æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{f(x) = 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span> çš„æ ¹ï¼Œå› æ­¤ç‰›é “æ³•æ­£å¥½å¯ä»¥æ‹¿ä¾†æ±‚è§£ IRRã€‚</p>
<p><img src="/images/2024/03/21/newton_method.png" alt="Newton method" /></p>
<p>æˆ‘å€‘è®“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{f(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">{x_{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> åšåå¾®åˆ†å¾—åˆ°ä¸€æ–œç‡ï¼Œé€²ä¸€æ­¥è¨ˆç®—å‡ºé€šé <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">{x_{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> ä¹‹åˆ‡ç·šï¼Œæ¥è‘—æ‰¾åˆ°åˆ‡ç·šèˆ‡ x è»¸çš„äº¤é» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">{x_{n+1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶å€¼ç‚º:</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>âˆ’</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle x_{n+1}=x_{n}-{\frac {f(x_{n})}{f&#x27;(x_{n})}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>èƒ½ç™¼ç¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">{x_{n+1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></span> ç›¸æ¯”æ–¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">{x_{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> æ›´é è¿‘æˆ‘å€‘è¦æ±‚çš„æ ¹ï¼Œå› æ­¤æˆ‘å€‘èƒ½è¿­ä»£çš„é€²è¡Œé€™å€‹æ“ä½œï¼Œç›´åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{f(x_{n}) = 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span>ï¼Œæˆ–è€… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>b</mi><mi>s</mi><mo stretchy="false">(</mo><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mo>âˆ’</mo><mn>0</mn><mo stretchy="false">)</mo><mo>&lt;</mo><mi>t</mi><mi>o</mi><mi>l</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">{abs({f(x_{n})} - 0) &lt; tolerance}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">e</span></span></span></span></span>ã€‚</p>
<h2 id="python-ç¨‹å¼ç¢¼"><a class="markdownIt-Anchor" href="#python-ç¨‹å¼ç¢¼"></a> Python ç¨‹å¼ç¢¼</h2>
<p>é¦–å…ˆæ˜¯è¨ˆç®— NPV çš„éƒ¨åˆ†ï¼Œé€™é‚Šç‚ºäº†å› æ‡‰ç¾é‡‘æµä¸å›ºå®šçš„æƒ…æ³æ‰€ä»¥æœƒå…ˆè¨ˆç®—æ¯ä¸€æœŸçš„ <code>time_diff</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">npv_with_dates</span>(<span class="params">cashflows, rate</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Calculate NPV (with date)</span></span><br><span class="line"><span class="string">    :param cashflows: [(date 1, cash 1), (date 2, cash 2) ...]</span></span><br><span class="line"><span class="string">    :param rate: discount rate</span></span><br><span class="line"><span class="string">    :return: NPV</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    npv = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> date, cashflow <span class="keyword">in</span> cashflows:</span><br><span class="line">        time_diff = (date - cashflows[<span class="number">0</span>][<span class="number">0</span>]).days / <span class="number">365.0</span></span><br><span class="line">        npv += cashflow / ((<span class="number">1</span> + rate) ** time_diff)</span><br><span class="line">    <span class="keyword">return</span> npv</span><br></pre></td></tr></table></figure>
<p>æ¥è‘—å°±æ˜¯ç‰›é “æ³•çš„éƒ¨åˆ†ï¼Œçµ¦å®šä¸€å€‹åˆå§‹çš„æŠ˜ç¾ç‡é–‹å§‹è¿­ä»£å„ªåŒ–ï¼Œ<code>derivative</code> æ˜¯åå¾®åˆ†çš„çµæœï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">irr_with_dates</span>(<span class="params">cashflows, initial_rate=<span class="number">0.1</span>, tolerance=<span class="number">1.0e-6</span>, max_iter=<span class="number">100</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Calculate IRR with Newton&#x27;s method (with date)</span></span><br><span class="line"><span class="string">    :param cashflows: [(date 1, cash 1), (date 2, cash 2) ...]</span></span><br><span class="line"><span class="string">    :param initial_rate: initial discount rate</span></span><br><span class="line"><span class="string">    :param tolerance</span></span><br><span class="line"><span class="string">    :param max_iter: max iterations</span></span><br><span class="line"><span class="string">    :return: IRR</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    rate = initial_rate</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(max_iter):</span><br><span class="line">        npv = npv_with_dates(cashflows, rate)</span><br><span class="line">        derivative = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> date, cashflow <span class="keyword">in</span> cashflows:</span><br><span class="line">            time_diff = (date - cashflows[<span class="number">0</span>][<span class="number">0</span>]).days / <span class="number">365.0</span></span><br><span class="line">            derivative += -time_diff * cashflow / ((<span class="number">1</span> + rate) ** (time_diff + <span class="number">1</span>))</span><br><span class="line">        rate -= npv / derivative</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(npv) &lt; tolerance:</span><br><span class="line">            <span class="keyword">return</span> rate</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<p>åŸ·è¡Œç¨‹å¼ç¢¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cashflows = [(datetime(<span class="number">2023</span>, <span class="number">1</span>, <span class="number">1</span>), -<span class="number">100</span>), (datetime(<span class="number">2023</span>, <span class="number">5</span>, <span class="number">1</span>), <span class="number">20</span>), (datetime(<span class="number">2023</span>, <span class="number">9</span>, <span class="number">1</span>), -<span class="number">10</span>), (datetime(<span class="number">2024</span>, <span class="number">1</span>, <span class="number">1</span>), <span class="number">50</span>), (datetime(<span class="number">2024</span>, <span class="number">3</span>, <span class="number">1</span>), <span class="number">70</span>)]</span><br><span class="line">irr_value = irr_with_dates(cashflows)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;IRR: <span class="subst">&#123;irr_value*<span class="number">100</span>:<span class="number">.2</span>f&#125;</span> %&quot;</span>)</span><br><span class="line"><span class="comment"># IRR: 29.98 %</span></span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://highscope.ch.ntu.edu.tw/wordpress/?p=51169">ç‰›é “æ³• ( Newtonâ€™s Method )</a></p>
]]></content>
      <categories>
        <category>Others</category>
      </categories>
      <tags>
        <tag>Newton&#39;s method</tag>
        <tag>IRR</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±å…¥ç­è§£ç¤¾æœƒç¶²çµ¡åˆ†æä¸­çš„ä»‹æ•¸ä¸­å¿ƒæ€§(Betweenness Centrality) - è¨ˆç®—æ–¹æ³•èˆ‡ Python ç¨‹å¼å¯¦ä½œ</title>
    <url>/posts/Others/2023/betweenness-centrality/</url>
    <content><![CDATA[<h1 id="ä»‹ç´¹"><a class="markdownIt-Anchor" href="#ä»‹ç´¹"></a> ä»‹ç´¹</h1>
<p><img src="/images/2023/03/29/Betweenness_Centrality.png" alt="Betweenness Centrality" /></p>
<p>ä»‹æ•¸ä¸­å¿ƒæ€§ï¼ˆBetweenness Centralityï¼‰æ˜¯ç¤¾æœƒç¶²çµ¡åˆ†æä¸­å¸¸ç”¨çš„ä¸€ç¨®æŒ‡æ¨™ï¼Œç”¨æ–¼åº¦é‡ä¸€å€‹ç¯€é»åœ¨æ•´å€‹ç¶²çµ¡ä¸­æ‰®æ¼”äº†å¤šé‡è¦çš„è§’è‰²ï¼Œç°¡å–®ä¾†èªªï¼Œä»‹æ•¸ä¸­å¿ƒæ€§æŒ‡æ¨™è©•ä¼°äº†ä¸€å€‹ç¯€é»åœ¨ç¶²çµ¡ä¸­æ“”ä»»äº†å¤šå°‘æ¢<strong>æœ€çŸ­è·¯å¾‘</strong>çš„ä¸­ä»‹è€…è§’è‰²ã€‚</p>
<p>æ›´ç™½è©±ä¸€é»ï¼Œä»‹æ•¸ä¸­å¿ƒæ€§çœ‹çš„æ˜¯ä¸€å€‹ç¯€é»æœ‰<strong>å¤šå¸¸è¢«å…¶ä»–äººç¶“é</strong>ï¼Œèˆ‰ä¾‹ä¾†èªªï¼šæŸäº›å…¬è»Šç«™é»é€£æ¥äº†ä¸åŒçš„å…¬è»Šè·¯ç·šï¼Œé€™äº›å…¬è»Šç«™é»å°æ–¼é€£æ¥æ•´å€‹å…¬è»Šç¶²çµ¡èµ·è‘—é‡è¦çš„ä½œç”¨ï¼Œå¦‚æœé€™äº›å…¬è»Šç«™ç™¼ç”Ÿäº†ä»»ä½•å•é¡Œï¼Œæ•´å€‹å…¬è»Šè·¯ç·šéƒ½æœƒå—åˆ°å½±éŸ¿ã€‚é€™äº›å…¬è»Šç«™é»å°±æ˜¯å…·æœ‰é«˜ä»‹æ•¸ä¸­å¿ƒæ€§çš„ç¯€é»ã€‚</p>
<span id="more"></span>
<h1 id="è¨ˆç®—æ–¹æ³•"><a class="markdownIt-Anchor" href="#è¨ˆç®—æ–¹æ³•"></a> è¨ˆç®—æ–¹æ³•</h1>
<h2 id="ä»‹æ•¸ä¸­å¿ƒæ€§"><a class="markdownIt-Anchor" href="#ä»‹æ•¸ä¸­å¿ƒæ€§"></a> ä»‹æ•¸ä¸­å¿ƒæ€§</h2>
<p><img src="/images/2023/03/29/formula.png" alt="Betweenness Centrality Formula" /></p>
<p>å…¬å¼ä¸­ï¼Œğœ(sigma)è¡¨ç¤ºæœ€çŸ­è·¯å¾‘çš„æ•¸é‡ï¼Œåˆ†æ¯çš„æ„æ€æ˜¯å¾é»såˆ°é»wçš„æœ€çŸ­è·¯å¾‘çš„æ•¸é‡ï¼Œåˆ†å­çš„æ„æ€æ˜¯å¾é»såˆ°é»wçš„æœ€çŸ­è·¯å¾‘ä¸­ç¶“évé»çš„æ•¸é‡ï¼Œè½èµ·ä¾†æœ‰é»æŠ½è±¡ï¼Œæˆ‘å€‘ç”¨ä¸‹é¢é€™å¼µåœ–ä¾†è§£é‡‹ï¼š</p>
<blockquote>
<p><img src="/images/2023/03/29/simple_network.png" alt="Simple Network" /><br />
å¾sé»åˆ°wé»çš„æœ€çŸ­è·¯å¾‘ç¸½å…±æœ‰4æ¢ï¼Œåˆ†åˆ¥æ˜¯<br />
<code>s -&gt; 1 -&gt; v -&gt; w</code><br />
<code>s -&gt; 2 -&gt; v -&gt; w</code><br />
<code>s -&gt; 3 -&gt; v -&gt; w</code><br />
<code>s -&gt; 3 -&gt; 4 -&gt; w</code><br />
æ‰€ä»¥åˆ†æ¯å°±æ˜¯4ï¼Œå…¶ä¸­ç¶“évçš„æœ‰ä¸‰æ¢æ‰€ä»¥åˆ†å­å°±æ˜¯3ï¼Œèƒ½ç®—å‡ºåœ¨såˆ°wçš„è·¯å¾‘ä¸­ï¼Œvçš„ä»‹æ•¸ä¸­å¿ƒæ€§å°±æ˜¯<code>3/4</code>ã€‚<br />
ä½†è¦æ³¨æ„çš„æ˜¯ç¶²çµ¡ä¸­çš„ä»»ä¸€é»éƒ½æœ‰å¯èƒ½æ˜¯sæˆ–æ˜¯wï¼Œå› æ­¤è‹¥è¦è¨ˆç®—æ•´å€‹ç¶²çµ¡ç•¶ä¸­vçš„ä¸­å¿ƒæ€§ï¼Œæˆ‘å€‘è¦å°‡ç¶²çµ¡ä¸­çš„æ‰€æœ‰çµ„åˆåŠ ç¸½(Î£)æ‰èƒ½å¾—åˆ°æœ€å¾Œçš„çµæœã€‚</p>
</blockquote>
<h2 id="æ¨™æº–åŒ–"><a class="markdownIt-Anchor" href="#æ¨™æº–åŒ–"></a> æ¨™æº–åŒ–</h2>
<p>è°æ˜çš„ä½ å¯èƒ½æœƒç™¼ç¾ç¶²çµ¡ä¸­çš„ç¯€é»è¶Šå¤šï¼Œç®—å‡ºä¾†çš„å€¼ä¹Ÿè¶Šå¤§(å› ç‚ºæ˜¯åŠ ç¸½)ï¼Œå› æ­¤ï¼Œç‚ºäº†è®“ä¸åŒç¶²çµ¡ä¹‹é–“èƒ½è¢«æ‹¿ä¾†æ¯”è¼ƒï¼Œæˆ‘å€‘è¦å°å…¶é€²è¡Œæ¨™æº–åŒ–ã€‚</p>
<p><img src="/images/2023/03/29/normalization_formula.png" alt="Normalization Formula" /></p>
<p>å…¶ä¸­ï¼Œåˆ†æ¯æ˜¯Binomial Coefficientï¼ŒæŒ‡çš„æ˜¯ä¸€å€‹ç¶²çµ¡çš„æœ€å¤§å¯èƒ½ä»‹æ•¸ä¸­å¿ƒæ€§(ç¶²è·¯ä¸­ä»»é¸å…©é»ã€n-1å–2)ï¼š<br />
<img src="/images/2023/03/29/binomial_coefficient.png" alt="Binomial Coefficient" /></p>
<p>(ä¸Šé¢æ¨™æº–åŒ–å…¬å¼çš„å‡è¨­æ˜¯ç¶²çµ¡æ˜¯æ²’æœ‰æ–¹å‘æ€§çš„ï¼Œå¦‚æœæœ‰æ–¹å‘æ€§çš„è©±å°±ä¸ç”¨é™¤2äº†ã€‚)</p>
<h1 id="python-å¯¦ä½œ"><a class="markdownIt-Anchor" href="#python-å¯¦ä½œ"></a> Python å¯¦ä½œ</h1>
<p>ç¶²è·¯ä¸Šå¾ˆå¤šæœ‰é—œBetweenness Centralityçš„æ•™å­¸éƒ½æ˜¯ç›´æ¥å¥—<code>networkx</code>å¥—ä»¶ï¼Œä½†å°æ–¼ç¨‹å¼é‚è¼¯ç©¶ç«Ÿå¦‚ä½•å¯¦ç¾å»æ˜¯è‘—å¢¨å¾ˆå°‘ï¼Œå› æ­¤æ¥ä¸‹ä¾†è¦ä»¥<strong>ä¸ç”¨å¥—ä»¶</strong>çš„æ–¹å¼ä¾†å¯¦ç¾unweighted graphä¸­Betweenness Centralityçš„è¨ˆç®—ï¼</p>
<p>åœ¨é–‹å§‹å¯¦ä½œå‰ï¼Œæˆ‘å€‘è¦å…ˆæŠŠ unweighted graph è½‰æ›æˆä»¥ä¸‹æ ¼å¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">graph = &#123;</span><br><span class="line">    <span class="number">0</span> : [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="comment"># ç¯€é» : [ä»–çš„é„°å±…]</span></span><br><span class="line">    <span class="number">1</span> : [<span class="number">0</span>, <span class="number">4</span>],</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="pseudo-code"><a class="markdownIt-Anchor" href="#pseudo-code"></a> Pseudo Code</h2>
<p>ä¾†çœ‹çœ‹Pseudo Codeï¼Œé€™å€‹ç®—æ³•å¯ä»¥è¨ˆç®—å‡ºgraphä¸­å„å€‹é»çš„Betweenness Centrality:<br />
<img src="/images/2023/03/29/pseudo_code.webp" alt="Pseudo Code for Betweenness Centrality" /></p>
<h2 id="ç¨‹å¼é‚è¼¯"><a class="markdownIt-Anchor" href="#ç¨‹å¼é‚è¼¯"></a> ç¨‹å¼é‚è¼¯</h2>
<p>çœ‹äº†éœ§ç…ç…? æ²’é—œä¿‚ï¼Œä¾†è§£é‡‹ä¸€ä¸‹è®Šæ•¸çš„æ„æ¶µï¼š</p>
<blockquote>
<p>s: èµ·é»<br />
v: ä¸­ä»‹é»<br />
w: çµ‚é»<br />
S: stackï¼Œå¾Œé€²å…ˆå‡ºçš„ä½‡åˆ—ï¼Œç”¨ä¾†å„²å­˜å·²ç¶“éæ­·éçš„ç¯€é»<br />
P: pathï¼Œsåˆ°wçš„æœ€çŸ­è·¯å¾‘ä¸­ï¼Œæ‰€ç¶“éçš„é„°å±…v<br />
Ïƒ: sigmaï¼Œsåˆ°å…¶ä»–é»çš„æœ€çŸ­è·¯å¾‘çš„æ•¸é‡<br />
d: distanceï¼Œsåˆ°å…¶ä»–é»çš„æœ€çŸ­è·é›¢<br />
Q: queueï¼Œå…ˆé€²å…ˆå‡ºçš„ä½‡åˆ—ï¼Œç”¨ä¾†å¯¦ç¾BFS<br />
Î´: deltaï¼Œä»‹æ•¸ä¸­å¿ƒæ€§ (å–®ä¸€å€‹ç¯€é»sçš„çµæœ)<br />
C: centralityï¼Œä»‹æ•¸ä¸­å¿ƒæ€§ (sum of delta)</p>
</blockquote>
<p>ç¨‹å¼é‚è¼¯å…¶å¯¦å¾ˆç°¡å–®ï¼Œå…ˆåˆå§‹åŒ–graphçš„å…±ç”¨çš„è®Šæ•¸(<code>C</code>)ï¼Œæ¥è‘—å°±æ˜¯å°æ¯å€‹ç¯€é»(<code>for s in graph:</code>)åšä¸‹é¢ä¸‰å€‹æ­¥é©Ÿï¼š</p>
<ol>
<li>åˆå§‹åŒ–è®Šé‡</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">S = [] <span class="comment"># stack</span></span><br><span class="line">P = &#123;node: [] <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125; <span class="comment"># path</span></span><br><span class="line">sigma = &#123;node: <span class="number">0</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125; <span class="comment"># åˆå§‹åŒ–ç‚º-1ï¼Œå› ç‚ºåŸé»æ˜¯0</span></span><br><span class="line">sigma[s] = <span class="number">1</span> </span><br><span class="line">d = &#123;node: -<span class="number">1</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125; <span class="comment"># distance</span></span><br><span class="line">d[s] = <span class="number">0</span></span><br><span class="line">Q = deque([s]) <span class="comment"># queue</span></span><br></pre></td></tr></table></figure>
<ul>
<li>é€™éƒ¨åˆ†å°±æ˜¯æ ¹æ“šå„å€‹è®Šé‡çš„æ€§è³ªå»åˆå§‹åŒ–è€Œå·²ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯è·é›¢(<code>d</code>)ä¸€é–‹å§‹è¦åˆå§‹åŒ–ç‚º-1ï¼Œå› ç‚ºåŸé»æœƒæ˜¯0ã€‚</li>
</ul>
<ol start="2">
<li>è¨ˆç®—æœ€çŸ­è·¯å¾‘ (BFS)</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> Q:</span><br><span class="line">    v = Q.popleft()</span><br><span class="line">    S.append(v)</span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> graph[v]: <span class="comment"># for neighbor in neighbors</span></span><br><span class="line">        <span class="keyword">if</span> d[w] &lt; <span class="number">0</span>: <span class="comment"># å¦‚æœé‡åˆ°æ–°çš„ç¯€é»æ‰å»æ›´æ–°ä»–çš„è·é›¢</span></span><br><span class="line">            Q.append(w)</span><br><span class="line">            d[w] = d[v] + <span class="number">1</span></span><br><span class="line">        <span class="comment"># -----------------------------------------------       </span></span><br><span class="line">        <span class="keyword">if</span> d[w] == d[v] + <span class="number">1</span>: <span class="comment"># åˆ¤æ–·væ˜¯å¦åœ¨såˆ°wçš„æœ€çŸ­è·¯å¾‘ä¸­</span></span><br><span class="line">            sigma[w] += sigma[v] <span class="comment"># é€évå»æ›´æ–°wçš„æœ€çŸ­è·¯å¾‘æ•¸</span></span><br><span class="line">            P[w].append(v)</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨é€™æ®µç¨‹å¼ä¸­ï¼Œæˆ‘å€‘å¯ä»¥æŠŠä»–åˆ‡æˆå…©åŠï¼Œå‰åŠæ®µæ˜¯åŸºæœ¬çš„BFSæ¼”ç®—æ³•ï¼Œæ¯”è¼ƒä¸ä¸€æ¨£çš„åœ°æ–¹åœ¨æ–¼æˆ‘å€‘å°‡queueå½ˆå‡ºçš„ç¯€é»å†å­˜å…¥stackä¸­ï¼Œç´€éŒ„æ‰€æœ‰éæ­·éçš„é»ï¼›å¾ŒåŠæ®µå‰‡æ˜¯å¾wçš„é„°å±…ä¸­ï¼Œå»å°‹æ‰¾é„°å±…væ˜¯å¦ä½æ–¼æœ€çŸ­è·¯å¾‘ç•¶ä¸­(é€éåˆ¤æ–·æœ€çŸ­è·é›¢æ˜¯å¦ç›¸å·®1)ï¼Œå¦‚æœæ˜¯çš„è©±é‚£å°±é€évå»æ›´æ–°æ›´æ–°wçš„sigmaï¼Œä¸¦ä¸”å°‡vè¨˜éŒ„è‡³wçš„<code>path</code>ä¸­ã€‚</li>
</ul>
<ol start="3">
<li>è¨ˆç®—Betweenness Centrality</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">delta = &#123;node: <span class="number">0</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125;</span><br><span class="line"><span class="comment"># -----------------------------------------------   </span></span><br><span class="line"><span class="keyword">while</span> S:</span><br><span class="line">    w = S.pop() <span class="comment"># å¾éæ­·éçš„ç¯€é»ä¸­popä¸€å€‹</span></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> P[w]:</span><br><span class="line">        delta[v] += (sigma[v]/sigma[w]) * (<span class="number">1</span> + delta[w])</span><br><span class="line">    <span class="keyword">if</span> w != s:</span><br><span class="line">        C[w] += delta[w]</span><br></pre></td></tr></table></figure>
<ul>
<li>deltaå…¶å¯¦ä¹Ÿæ˜¯åˆå§‹åŒ–è®Šé‡çš„ä¸€éƒ¨åˆ†å•¦ï¼Œåªæ˜¯Pseudo Codeæ”¾åœ¨é€™éƒ¨åˆ†æ‰€ä»¥å¯«åœ¨é€™é‚Šã€‚</li>
<li>æˆ‘å€‘å°‡ç¯€é»å¾stackä¸­å–å‡ºä¾†ï¼Œå»æ›´æ–°é€™äº›é»çš„Betweenness Centralityï¼Œä¹‹æ‰€ä»¥ç”¨stackæœ‰å…©å€‹åŸå› ï¼Œç¬¬ä¸€å€‹åŸå› æ˜¯æˆ‘å€‘åªéœ€è¦è€ƒæ…®èƒ½åˆ°é”çš„ç¯€é»ï¼Œç¬¬äºŒå€‹åŸå› æ˜¯æˆ‘å€‘å¸Œæœ›ç”±çµ‚é»å¾€èµ·é»å»æ›´æ–°ã€‚</li>
<li>æ¥è‘—æˆ‘å€‘å°‡æ¯å€‹wçš„pathä¸­çš„vå–å‡ºï¼Œå»æ›´æ–°é€™äº›vï¼Œ<code>sigma[v]/sigma[w]</code>è¡¨ç¤ºç¶“évçš„æœ€çŸ­è·¯å¾‘æ•¸/ç¶“éwçš„æœ€çŸ­è·¯å¾‘æ•¸ï¼Œé€™é‚Šæ¯”è¼ƒè®“äººconfusedçš„é»æ‡‰è©²æ˜¯ï¼Œæ ¹æ“šå‰é¢æåˆ°çš„Betweenness Centralityå…¬å¼ï¼Œä¸æ˜¯åªæœ‰<code>sigma[v]/sigma[w]</code>å—?ç‚ºä»€éº¼è¦ä¹˜ä»¥<code>1+delta[w]</code>å‘¢?åŸå› æ˜¯ç›®å‰çš„ä»‹æ•¸ä¸­å¿ƒæ€§åªè€ƒæ…®äº†vä¹‹æ–¼wçš„å½±éŸ¿ï¼Œæˆ‘å€‘è¦å°å…¶é€²è¡Œä¿®æ­£ä»¥ç´å…¥wå¾Œé¢çš„ç¯€é»çš„å½±éŸ¿ï¼Œæˆ‘å€‘ä¸€æ¨£æ‹¿å‰é¢ç”¨éçš„ä¾‹å­ä¾†è§£é‡‹ï¼š</li>
</ul>
<blockquote>
<p><img src="/images/2023/03/29/simple_network_2.png" alt="simple network 2" /><br />
æˆ‘å€‘æŠŠåŸæœ¬çš„vç•¶æˆæ–°çš„wï¼ŒæŠŠé»1ç•¶æˆæ–°çš„vï¼Œå¾såˆ°wçš„æœ€çŸ­è·¯å¾‘æœ‰ä¸‰æ¢ï¼Œåˆ†åˆ¥æ˜¯<br />
<code>s -&gt; v -&gt; w</code><br />
<code>s -&gt; 2 -&gt; w</code><br />
<code>s -&gt; 3 -&gt; w</code><br />
å…¶ä¸­ï¼Œç¶“évçš„åªæœ‰ä¸€æ¢ï¼Œæ‰€ä»¥ç®—å‡ºä¾†Betweenness Centralityå°±æ˜¯<code>sigma[v]/sigma[w] = 1/3</code>ï¼Œä½†æ˜¯!!! vä¸åªåœ¨<code>s -&gt; w</code>çš„æœ€çŸ­çš„è·¯å¾‘ä¸Šï¼Œä»–ä¹Ÿä½æ–¼<code>s -&gt; w'</code>çš„æœ€çŸ­è·¯å¾‘ä¸­ï¼Œé€™éƒ¨åˆ†ä¹Ÿè¦è€ƒæ…®é€²å»ï¼Œå‰é¢æåˆ°å¾<code>s -&gt; w'</code>å…±æœ‰4æ¢æœ€çŸ­è·¯å¾‘ï¼Œç¶“éç¾åœ¨çš„vçš„åªæœ‰1æ¢ï¼Œå› æ­¤é€™éƒ¨åˆ†æ˜¯<code>sigma[v]/sigma[w'] = 1/4</code>ï¼Œè€Œé€™å€‹å€¼å…¶å¯¦æœƒç­‰æ–¼<code>1/3 * 3/4</code>ï¼Œå…¶ä¸­<code>3/4</code>æ˜¯æˆ‘å€‘å‰é¢ç®—å¾—çš„<code>delta[w]</code>ï¼Œå› æ­¤æŠŠ<code>s -&gt; w</code>èˆ‡<code>s -&gt; w'</code>çš„çµæœåŠ èµ·ä¾†ï¼Œå°±æœƒæ˜¯ï¼š<br />
<code>(sigma[v]/sigma[w]) + (sigma[v]/sigma[w'])</code><br />
=<code>(sigma[v]/sigma[w]) + (sigma[v]/sigma[w])*delta[w]</code><br />
=<code>(sigma[v]/sigma[w]) * (1+delta[w])</code></p>
</blockquote>
<ul>
<li>æœ€å¾Œï¼Œé‡å°éèµ·é»sçš„ç¯€é»ï¼Œæˆ‘å€‘å°‡å…¶æ›´æ–°åˆ°æœ€çµ‚çµæœä¸­ã€‚</li>
</ul>
<p>æ¨™æº–åŒ–çš„éƒ¨åˆ†é›–ç„¶ä¸åœ¨Pseudo Codeä¸­ï¼Œä½†ä¸€èˆ¬ä¾†èªªæœƒé †ä¾¿åšï¼Œæ–¹æ³•å¦‚åŒå…¬å¼çš„éƒ¨åˆ†æåˆ°çš„ï¼Œé™¤ä»¥<code>((n-1)*(n-2))/2</code>å°±å¥½ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> graph:</span><br><span class="line">    C[node] /= ((n-<span class="number">1</span>)*(n-<span class="number">2</span>))/<span class="number">2</span></span><br></pre></td></tr></table></figure>
<h2 id="ç°¡åŒ–ç‰ˆæ¶æ§‹"><a class="markdownIt-Anchor" href="#ç°¡åŒ–ç‰ˆæ¶æ§‹"></a> ç°¡åŒ–ç‰ˆæ¶æ§‹</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">betweenness_centrality</span>(<span class="params">graph</span>):</span><br><span class="line">    C = &#123;node: <span class="number">0</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> graph:</span><br><span class="line">        <span class="number">1.</span> åˆå§‹åŒ–è®Šé‡</span><br><span class="line">        <span class="number">2.</span> è¨ˆç®—æœ€çŸ­è·¯å¾‘ (BFS)</span><br><span class="line">        <span class="number">3.</span> è¨ˆç®—centrality</span><br><span class="line">    </span><br><span class="line">    do Normalization</span><br><span class="line">    <span class="keyword">return</span> C</span><br></pre></td></tr></table></figure>
<h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a class="markdownIt-Anchor" href="#å®Œæ•´ç¨‹å¼ç¢¼"></a> å®Œæ•´ç¨‹å¼ç¢¼</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">betweenness_centrality</span>(<span class="params">graph</span>):</span><br><span class="line"></span><br><span class="line">    C = &#123;node: <span class="number">0</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125; <span class="comment"># centrality</span></span><br><span class="line">    n = <span class="built_in">len</span>(C)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éæ­·æ¯å€‹ç¯€é»</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> graph:</span><br><span class="line">        <span class="comment"># 1. åˆå§‹åŒ–è®Šé‡</span></span><br><span class="line">        S = [] <span class="comment"># stack</span></span><br><span class="line">        P = &#123;node: [] <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125; <span class="comment"># path</span></span><br><span class="line">        sigma = &#123;node: <span class="number">0</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125; <span class="comment"># åˆå§‹åŒ–ç‚º-1ï¼Œå› ç‚ºåŸé»æ˜¯0</span></span><br><span class="line">        sigma[s] = <span class="number">1</span> </span><br><span class="line">        d = &#123;node: -<span class="number">1</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125; <span class="comment"># distance</span></span><br><span class="line">        d[s] = <span class="number">0</span></span><br><span class="line">        Q = deque([s]) <span class="comment"># queue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. è¨ˆç®—æœ€çŸ­è·¯å¾‘ (BFS)</span></span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            v = Q.popleft()</span><br><span class="line">            S.append(v)</span><br><span class="line">            <span class="keyword">for</span> w <span class="keyword">in</span> graph[v]: <span class="comment"># for neighbor in neighbors</span></span><br><span class="line">                <span class="keyword">if</span> d[w] &lt; <span class="number">0</span>: <span class="comment"># å¦‚æœé‡åˆ°æ–°çš„ç¯€é»æ‰å»æ›´æ–°ä»–çš„è·é›¢</span></span><br><span class="line">                    Q.append(w)</span><br><span class="line">                    d[w] = d[v] + <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> d[w] == d[v] + <span class="number">1</span>: <span class="comment"># åˆ¤æ–·væ˜¯å¦åœ¨såˆ°wçš„æœ€çŸ­è·¯å¾‘ä¸­</span></span><br><span class="line">                    sigma[w] += sigma[v] <span class="comment"># é€évå»æ›´æ–°wçš„æœ€çŸ­è·¯å¾‘æ•¸</span></span><br><span class="line">                    P[w].append(v)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. è¨ˆç®—centrality</span></span><br><span class="line">        delta = &#123;node: <span class="number">0</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125;</span><br><span class="line">        <span class="keyword">while</span> S:</span><br><span class="line">            w = S.pop() <span class="comment"># å¾éæ­·éçš„ç¯€é»ä¸­popä¸€å€‹</span></span><br><span class="line">            <span class="keyword">for</span> v <span class="keyword">in</span> P[w]:</span><br><span class="line">                delta[v] += (sigma[v]/sigma[w]) * (<span class="number">1</span> + delta[w])</span><br><span class="line">            <span class="keyword">if</span> w != s:</span><br><span class="line">                C[w] += delta[w]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Normalization</span></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> graph:</span><br><span class="line">        C[node] /= ((n-<span class="number">1</span>)*(n-<span class="number">2</span>))/<span class="number">2</span> <span class="comment"># å°‡æ¯å€‹ç¯€é»é™¤ä»¥æœ€å¤§å¯èƒ½å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> C</span><br></pre></td></tr></table></figure>
<h1 id="çµèª"><a class="markdownIt-Anchor" href="#çµèª"></a> çµèª</h1>
<p>å¦‚æœçœŸçš„é‡åˆ°è¦è¨ˆç®—Betweenness Centralityçš„æƒ…æ³ï¼Œç•¶ç„¶é‚„æ˜¯ç›´æ¥ç”¨<code>networkx</code>å¥—ä»¶è£¡çš„<code>betweenness_centrality</code>å°±å¥½äº†å•¦ï¼Œå¯«é€™ç¯‡å–®ç´”æ˜¯å› ç‚ºç¶²è·¯ä¸Šéƒ½æ‰¾ä¸åˆ°æœ‰äººèªªæ˜ç®—æ³•çš„é‚è¼¯ï¼Œæ‰€ä»¥å¸Œæœ›å¯«é€™ç¯‡èƒ½å¹«åŠ©åˆ°å…¶ä»–æƒ³äº†è§£ç®—æ³•çš„äººã€‚<br />
è¦æ³¨æ„ä¸Šé¢çš„ç®—æ³•å»ºç«‹åœ¨æ‰€æœ‰edgeçš„æ¬Šé‡éƒ½æ˜¯ä¸€æ¨£çš„æƒ…æ³ä¸‹ï¼Œä¹Ÿå°±æ˜¯é»èˆ‡é»ä¹‹é–“ä¸æ˜¯1å°±æ˜¯0çš„binaryé—œä¿‚ï¼Œé‚£å¦‚æœæ¯æ¢edgeæœ‰ä¸åŒçš„æ¬Šé‡å‘¢?æ–¹æ³•å…¶å¯¦ä¹Ÿä¸å¤ªæ„å¤–ï¼Œå°±æ˜¯æŠŠç¨‹å¼ä¸­è¨ˆç®—æœ€çŸ­è·¯å¾‘çš„éƒ¨åˆ†æ›æ‰å°±å¥½äº†ï¼Œæ ¹æ“šå¯¦éš›æƒ…æ³å¯ä»¥é¸æ“‡Dijkstraæˆ–æ˜¯Bellmanâ€“Fordç­‰ã€‚</p>
]]></content>
      <categories>
        <category>Others</category>
      </categories>
      <tags>
        <tag>Social Network Analysis</tag>
        <tag>Betweenness Centrality</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 01 - Basics</title>
    <url>/posts/Java/2024/java-learning-01/</url>
    <content><![CDATA[<h2 id="jvm-jre-jdk"><a class="markdownIt-Anchor" href="#jvm-jre-jdk"></a> JVM, JRE &amp; JDK</h2>
<p><img src="/images/2024/03/18/JVM_JRE_JDK.png" alt="JVM, JRE &amp; JDK" /></p>
<h3 id="java-vs-c"><a class="markdownIt-Anchor" href="#java-vs-c"></a> Java vs C</h3>
<p>ç•¶é–‹ç™¼ C æˆ– C++ ç¨‹å¼æ™‚ï¼Œé€šå¸¸æœƒå…ˆå°‡åŸå§‹ç¢¼é€éç·¨è­¯å™¨è½‰æ›æˆç›®æ¨™æ©Ÿå™¨å¯ä»¥ç†è§£çš„ Object Codeã€‚é€™å€‹ Object Code æ˜¯ç‰¹å®šæ–¼ç›®æ¨™æ©Ÿå™¨æ¶æ§‹çš„ï¼Œå› æ­¤åœ¨ä¸åŒçš„ç¡¬é«”å¹³å°ä¸Šå¯èƒ½æœƒç”¢ç”Ÿä¸åŒçš„æ©Ÿå™¨ç¢¼ã€‚å› æ­¤ï¼Œç•¶å°‡ç¨‹å¼ç§»æ¤åˆ°ä¸åŒçš„æ©Ÿå™¨æˆ–æ¶æ§‹æ™‚ï¼Œé€šå¸¸éœ€è¦é‡æ–°ç·¨è­¯åŸå§‹ç¢¼ä»¥ç”Ÿæˆé©ç”¨æ–¼è©²ç‰¹å®šå¹³å°çš„æ–° Object Codeã€‚</p>
<span id="more"></span>
<h3 id="jvm-java-virtual-machine"><a class="markdownIt-Anchor" href="#jvm-java-virtual-machine"></a> JVM (Java Virtual Machine)</h3>
<p>Java é€šé JVM ä¾†è§£æ±ºè·¨å¹³å°çš„å•é¡Œï¼Œç¨‹å¼åœ¨ç·¨è­¯æ™‚æ˜¯å…ˆç¿»è­¯æˆ JVM çš„ Byte codeï¼ŒåŸ·è¡Œæ™‚æ‰ç”± JVM è½‰æ›ç‚ºæ©Ÿå™¨ç¢¼ï¼Œç”±æ–¼ä¸æ˜¯ç›´æ¥ç·¨è­¯æˆæ©Ÿæ¢°ç¢¼ï¼Œé€™è¡¨ç¤ºåªè¦æ–°çš„å¹³å°æœ‰å®‰è£ JVMï¼Œå°±ä¸ç”¨é‡æ–°ç·¨è­¯ä¸€éäº†ã€‚<br />
æŸæ–¹é¢ä¾†èªª JVM ç®—æ˜¯ä¸€ç¨® interpreterï¼Œè² è²¬åŸ·è¡Œ Byte codeã€‚<br />
<img src="/images/2024/03/18/JVM.png" alt="JVM" /></p>
<h3 id="jre-java-runtime-environment"><a class="markdownIt-Anchor" href="#jre-java-runtime-environment"></a> JRE (Java Runtime Environment)</h3>
<p>JRE åŒ…å«äº†åŸ·è¡Œ Java ç¨‹å¼æ‰€éœ€çš„æ‰€æœ‰æª”æ¡ˆå’Œåº«ï¼ŒåŒ…æ‹¬ JVMã€Class Librariesã€Java API ç­‰ï¼Œä¹Ÿå°±æ˜¯èªªå–®å–®æ˜¯åŸ·è¡Œè€Œä¸éœ€è¦é–‹ç™¼çš„è©±å®‰è£ JRE å°±å¤ äº†ã€‚</p>
<h3 id="jdk-java-development-kit"><a class="markdownIt-Anchor" href="#jdk-java-development-kit"></a> JDK (Java Development Kit)</h3>
<p>JDK æ˜¯ä¸€å€‹å®Œæ•´çš„ Java é–‹ç™¼å¥—ä»¶ï¼ŒåŒ…æ‹¬äº† JREã€ç·¨è­¯å™¨ (javac) ä»¥åŠé–‹ç™¼æ‰€éœ€è¦çš„å„ç¨®å·¥å…·å’Œåº«ã€‚</p>
<h2 id="hello-java"><a class="markdownIt-Anchor" href="#hello-java"></a> Hello Java</h2>
<ul>
<li>Hello.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hello</span> <span class="comment">//Class çš„åç¨±è¦è·Ÿæª”åä¸€æ¨¡ä¸€æ¨£</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">   &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Hello Java&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>compile</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">javac Hello.java</span></span><br></pre></td></tr></table></figure>
<ul>
<li>run</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">java Hello</span></span><br></pre></td></tr></table></figure>
<h2 id="data-type"><a class="markdownIt-Anchor" href="#data-type"></a> Data Type</h2>
<p><img src="/images/2024/03/18/java_data_type.png" alt="Java Data Type" /></p>
<h3 id="è³‡æ–™å‹æ…‹è½‰æ›"><a class="markdownIt-Anchor" href="#è³‡æ–™å‹æ…‹è½‰æ›"></a> è³‡æ–™å‹æ…‹è½‰æ›</h3>
<ul>
<li>æµ®é»æ•¸å¤§æ–¼æ•´æ•¸<br />
double &gt; float &gt; long &gt; int &gt; short &gt; byte</li>
<li>å°è½‰å¤§OKï¼Œå¤§è½‰å°error<br />
<img src="/images/2024/03/18/java_casting.png" alt="Java Casting" /></li>
<li>å¤§è½‰å°å¯ä»¥å¼·åˆ¶è½‰æ›ï¼Œä½†å¯èƒ½å¤±çœŸ</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="number">1024</span>;</span><br><span class="line"><span class="type">byte</span> <span class="variable">n2</span> <span class="operator">=</span> (<span class="type">byte</span>)n1; <span class="comment">// ä¸ä¸€æ¨£ (2é€²ä½é«˜ä½è¢«æˆªæ–·)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å­—ä¸²è½‰æ•¸å­—</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> Integer.parseInt(<span class="string">&quot;1234&quot;</span>)</span><br><span class="line"><span class="type">long</span> <span class="variable">n2</span> <span class="operator">=</span> Long.parseLong(<span class="string">&quot;1234&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>æ•¸å­—è½‰å­—ä¸²</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> String.valueOf(<span class="number">1234</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> String.valueOf(<span class="number">1.234</span>);</span><br></pre></td></tr></table></figure>
<h3 id="æ¨™æº–è¼¸å…¥"><a class="markdownIt-Anchor" href="#æ¨™æº–è¼¸å…¥"></a> æ¨™æº–è¼¸å…¥</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="type">Scanner</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> s.nextInt();</span><br><span class="line"><span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> s.next();</span><br></pre></td></tr></table></figure>
<h2 id="array"><a class="markdownIt-Anchor" href="#array"></a> Array</h2>
<p>Java çš„é™£åˆ—è·Ÿ C ä¸ä¸€æ¨£ï¼Œä¸æ˜¯ä»¥é€£çºŒçš„è¨˜æ†¶é«”è¡¨é”é™£åˆ—ï¼Œè€Œæ˜¯ä»¥ä¸€ç¨® object çš„å½¢å¼å¯¦ä½œï¼Œå› æ­¤å¤šç¶­çš„é™£åˆ—ä¿‚ç”±å‰ä¸€å±¤æŒ‡å‘å¾Œä¸€å±¤ï¼Œæ‰€ä»¥ä¸åŒå±¤çš„ Array é•·åº¦å¯ä»¥ä¸ä¸€æ¨£ !!!</p>
<p><img src="/images/2024/03/18/java_array.png" alt="Java Array" /></p>
<p>Array çš„å®£å‘Šèˆ‡åˆå§‹åŒ–æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span>[][] x = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">x = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">3</span>,<span class="number">4</span>&#125;&#125;;</span><br><span class="line">x.length <span class="comment">// xçš„é•·åº¦</span></span><br></pre></td></tr></table></figure>
<h2 id="class-and-object"><a class="markdownIt-Anchor" href="#class-and-object"></a> Class and Object</h2>
<ul>
<li>Object ç”¢ç”Ÿæ™‚ä¸€å®šè¦å‘¼å«çš„æ–¹æ³•ï¼Œç¨±ç‚º Constructor (å»ºæ§‹å­)</li>
<li>Objec æ¶ˆæ»…éœ€è¦å‘¼å«çš„æ–¹æ³•ï¼Œç¨±ç‚º Destructor (è§£æ§‹å­)</li>
<li>è¡¨é” Object å…§éƒ¨ç‹€æ…‹çš„è®Šæ•¸ï¼Œç¨±ç‚º Object Variable (ç‰©ä»¶è®Šæ•¸æˆå“¡)</li>
<li>Object å¯ä»¥æ¥æ”¶çš„è¨Šæ¯ï¼Œç¨±ç‚º Object Method (ç‰©ä»¶æ–¹æ³•æˆå“¡)</li>
<li>ä¸Šè¿°å…©å€‹å¯ç¸½ç¨±ç‚º Object Member</li>
<li>å±¬æ–¼ Class çš„è®Šæ•¸ï¼Œç¨±ç‚ºClass Variable (é¡åˆ¥è®Šæ•¸)</li>
<li>å±¬æ–¼ Class çš„æ–¹æ³•ï¼Œç¨±ç‚º Class Method (é¡åˆ¥æ–¹æ³•)</li>
<li>ä¸Šè¿°å…©å€‹å¯ç¸½ç¨±ç‚º Class Member</li>
<li>å’Œå…¶ä»– Class é–“çš„ç¹¼æ‰¿é—œä¿‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> speed; <span class="comment">// Object Variable</span></span><br><span class="line">    <span class="keyword">private</span> String direction; <span class="comment">// Object Variable, direction is a reference to String Object</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">numVehicle</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// Class Variable</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Vehicle</span><span class="params">()</span> &#123; <span class="comment">// Constructor, called when new a Object</span></span><br><span class="line">        <span class="built_in">this</span>(<span class="number">0</span>,<span class="string">&quot;north&quot;</span>); <span class="comment">// call another constructor to do initialization</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Vehicle</span><span class="params">(<span class="type">int</span> s, String dir)</span> &#123; <span class="comment">// Another Constructor. Use overloading to define two constructors</span></span><br><span class="line">        <span class="type">float</span> speed; <span class="comment">// define a local variable</span></span><br><span class="line">        speed = s; <span class="comment">// the speed here refers to the above local variable</span></span><br><span class="line">        <span class="built_in">this</span>.speed = s; <span class="comment">// If we want to set object variable, use this.speed to refer object variable speed</span></span><br><span class="line">        direction = dir; <span class="comment">// dir is a reference to object, not the object itself</span></span><br><span class="line">        numVehicle++;   <span class="comment">// increase the Vehicle number</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">finalize</span><span class="params">()</span> &#123; <span class="comment">// Destructor, called when the object is garbage collected by JVM</span></span><br><span class="line">        System.out.println(<span class="string">&quot;finalize has been called&quot;</span>);</span><br><span class="line">        numVehicle--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setSpeed</span><span class="params">(<span class="type">int</span> newSpeed)</span> &#123; <span class="comment">// Object Method</span></span><br><span class="line">        <span class="built_in">this</span>.speed = newSpeed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setDir</span><span class="params">(String dir)</span> &#123; <span class="comment">// Object Method</span></span><br><span class="line">        <span class="built_in">this</span>.direction = dir;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123; <span class="comment">// Object Method</span></span><br><span class="line">        <span class="keyword">return</span> speed;</span><br><span class="line">    &#125;</span><br><span class="line">    String <span class="title function_">getDir</span><span class="params">()</span> &#123; <span class="comment">// Object Method</span></span><br><span class="line">        <span class="keyword">return</span> direction;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">totalVehicle</span><span class="params">()</span> &#123; <span class="comment">// Class Method</span></span><br><span class="line">        <span class="keyword">return</span> numVehicle;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://www.geeksforgeeks.org/differences-jdk-jre-jvm/">https://www.geeksforgeeks.org/differences-jdk-jre-jvm/</a><br />
<a href="https://programming.im.ncnu.edu.tw/J_index.html">https://programming.im.ncnu.edu.tw/J_index.html</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Spectral Clustering - ç®—æ³•è§£æèˆ‡ numpy ç¨‹å¼å¯¦ä½œ</title>
    <url>/posts/Others/2023/spectral-clustering/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p><img src="/images/2023/04/27/cluster_analysis.jpg" alt="Spectral Clustering" /></p>
<p>åœ¨ç¤¾ç¾¤ç¶²çµ¡ä¸­åˆ†æä¸­ï¼Œæœ‰æ™‚å€™æœƒæƒ³è¦æ‰¾å‡ºç¶²çµ¡ç•¶ä¸­çš„ç¤¾ç¾¤(community detection)ï¼Œä¸€å€‹æœ€ç›´è§€çš„æƒ³æ³•æ˜¯ç›´æ¥å°ç¶²çµ¡é€²è¡Œåˆ†ç¾¤ï¼Œé‚£éº¼åˆ†ç¾¤çµæœå°±æ˜¯å„å€‹communityäº†ã€‚<br />
å¦‚æœæˆ‘å€‘èƒ½å¤ è¨ˆç®—å„å€‹ç¯€é»ä¹‹é–“çš„ç›¸ä¼¼æ€§ï¼Œé‚£éº¼æˆ‘å€‘ç•¶ç„¶å¯ä»¥ç›´æ¥å¥—ç”¨å‚³çµ±çš„åˆ†ç¾¤æ–¹æ³•ï¼Œå¦‚cosine similiarityï¼Œä½†ä¸€ä¾†æ˜¯ç›¸ä¼¼åº¦ç‰¹å¾µå¯èƒ½å¾ˆé›£å–å¾—ï¼ŒäºŒä¾†æ˜¯é€™æ¨£åˆ†ç¾¤çš„è©±å°±æ²’æœ‰åˆ©ç”¨åˆ°ç¶²çµ¡çš„çµæ§‹äº†ï¼Œé€™æ™‚æˆ‘å€‘å¯ä»¥æ”¹ç‚ºä½¿ç”¨åŸºæ–¼åœ–è«–çš„åˆ†ç¾¤æ–¹æ³•ã€‚<br />
ä»Šå¤©é€™ç¯‡æ–‡ç« æœƒå¸¶å¤§å®¶ç°¡å–®ç­è§£ä»€éº¼æ˜¯cut approach, balanced-cut approachä»¥åŠå…¶ä»£è¡¨æ–¹æ³•spectral clusteringï¼Œä¸¦ç¤ºç¯„ä¸ä¾è³´å…¶ä»–å¥—ä»¶ï¼Œåƒ…ä½¿ç”¨numpyå¯¦ä½œspectral clusteringã€‚</p>
<span id="more"></span>
<h1 id="å¤§ç¶±"><a class="markdownIt-Anchor" href="#å¤§ç¶±"></a> å¤§ç¶±</h1>
<ul>
<li><a href="#Mini-cut-Approach">Mini-cut approach</a></li>
<li><a href="#Balanced-cut-Approach">Balanced-cut approach</a></li>
<li><a href="#Spectral-Clustering">Spectral clustering</a></li>
</ul>
<h1 id="å…§æ–‡"><a class="markdownIt-Anchor" href="#å…§æ–‡"></a> å…§æ–‡</h1>
<h2 id="mini-cut-approach"><a class="markdownIt-Anchor" href="#mini-cut-approach"></a> Mini-cut Approach</h2>
<p>Cut approachï¼Œé¡§åæ€ç¾©æ˜¯å°‡ç¶²çµ¡çµ¦åˆ‡é–‹ä¾†å½¢æˆå¤šå€‹ç¶²çµ¡ï¼Œå±¬æ–¼partitional clusteringçš„ä¸€ç¨®ï¼Œæ¯å€‹ç¯€é»åªæœƒå±¬æ–¼ä¸€å€‹communityï¼Œä¸¦ä¸”communityä¹‹é–“ä¹Ÿä¸æœƒoverlappingï¼Œè€ŒMini-cut Approachå‰‡æ˜¯å¸Œæœ›åœ¨åˆ‡å‰²ç¶²çµ¡æ™‚èƒ½æœ€å°åŒ–åˆ‡æ‰çš„edgeæ•¸é‡ã€‚<br />
è½èµ·ä¾†å¾ˆç›´è§€ï¼Œä½†é€™æ¨£åˆ‡æœƒæœ‰ä¸€å€‹å•é¡Œï¼Œé‚£å°±æ˜¯æœ‰å¯èƒ½æœƒåˆ‡å‡ºä¸€äº›éå¸¸å°çš„communityï¼Œå°è‡´åˆ†ç¾¤ä¸å¤ balanceã€‚</p>
<h2 id="balanced-cut-approach"><a class="markdownIt-Anchor" href="#balanced-cut-approach"></a> Balanced-cut Approach</h2>
<p>ç‚ºäº†è§£æ±ºMini-cut Approachçš„ç¼ºé»ï¼ŒBalanced-cut Approachåœ¨åˆ‡å‰²ç¶²çµ¡æ™‚é™¤äº†è€ƒé‡åŸæœ¬çš„edgeï¼Œå¦å¤–é™¤ä»¥communityçš„nodeæ•¸åšåŠ æ¬Šèª¿æ•´ï¼Œåˆ‡å‰²çš„ç›®æ¨™å¾æœ€å°åŒ–edgeæ•¸è½‰ç‚ºæœ€å°åŒ–ratio cutï¼Œå…¬å¼å¦‚ä¸‹:<br />
<img src="/images/2023/04/27/ratio_cut.png" alt="Ratio Cut formula" /></p>
<p>å…¬å¼è§£é‡‹: åˆ†æˆkç¾¤(kè¦è‡ªå·±æ±ºå®š)ï¼Œæ¯æ¬¡å–ä¸€å€‹ç¾¤<code>Pi</code>å‡ºä¾†çœ‹ï¼Œåˆ†å­éƒ¨åˆ†è¡¨ç¤ºå°‡<code>Pi</code>åˆ‡é–‹çš„è©±æœƒåˆ‡åˆ°çš„edgeæ•¸ï¼Œåˆ†æ¯éƒ¨åˆ†è¡¨ç¤º<code>Pi</code>å…§éƒ¨çš„nodeæ•¸ï¼Œå°‡kå€‹ç¾¤çš„çµæœåŠ ç¸½èµ·ä¾†å°±æœƒæ˜¯æ•´å€‹ç¶²è·¯çš„ratio cutåˆ†æ•¸ã€‚</p>
<h3 id="matrixs"><a class="markdownIt-Anchor" href="#matrixs"></a> Matrixs</h3>
<p>ç‚ºäº†è¦è¨ˆç®—Ratio Cutï¼Œæˆ‘å€‘å…ˆè¦ä¾†èªè­˜ä¸€ä¸‹ä¸‰ç¨®çŸ©é™£:</p>
<ol>
<li>Diagonal Degree Matrix åº¦æ•¸çŸ©é™£<br />
Degree(åº¦æ•¸)æŒ‡çš„æ˜¯ä¸€å€‹nodeæœ‰å¤šå°‘å€‹é„°å±…ï¼Œå°‡é€™äº›Degreeè½‰æ›ç‚ºå°è§’çŸ©é™£(Diagonal Matrix)å°±å¾—åˆ°Diagonal Degree Matrixã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">D = np.array([</span><br><span class="line">  [<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>]])</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Adjacency Matrix é„°æ¥çŸ©é™£<br />
åªè¦æ˜¯å°Graphæœ‰äº›æ¦‚å¿µçš„äººæ‡‰è©²éƒ½å°Adjacency Matrixä¸å¤ªé™Œç”Ÿï¼ŒAdjacency Matrixæè¿°äº†nodeä¹‹é–“çš„é—œä¿‚ï¼Œä¸‹é¢ä¾‹å­å‡è¨­nodeä¹‹é–“çš„é—œä¿‚éƒ½æ˜¯é›™å‘çš„ï¼Œæ‰€ä»¥æœƒæ˜¯å€‹å°ç¨±çŸ©é™£ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">A = np.array([</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]])</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Laplacian Matrix èª¿å’ŒçŸ©é™£(æ‹‰æ™®æ‹‰æ–¯çŸ©é™£)<br />
Laplacian Matrix çš„ç®—æ³•å°±æ˜¯ç›´æ¥å°‡Diagonal Degree Matrix æ¸›å» Adjacency Matrixï¼Œè½èµ·ä¾†å¯èƒ½è®“äººæ»¿é ­å•è™Ÿï¼Œç‚ºä»€éº¼è¦é€™éº¼åš? é€™é‚Šå…ˆè³£å€‹é—œå­ï¼Œç¹¼çºŒçœ‹ä¸‹å»å°±çŸ¥é“äº†ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">L = np.array([</span><br><span class="line">  [ <span class="number">2</span>, -<span class="number">1</span>,  <span class="number">0</span>,  <span class="number">0</span>, -<span class="number">1</span>,  <span class="number">0</span>,  <span class="number">0</span>],</span><br><span class="line">  [-<span class="number">1</span>,  <span class="number">4</span>, -<span class="number">1</span>, -<span class="number">1</span>,  <span class="number">0</span>,  <span class="number">0</span>, -<span class="number">1</span>],</span><br><span class="line">  [ <span class="number">0</span>, -<span class="number">1</span>,  <span class="number">2</span>, -<span class="number">1</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>],</span><br><span class="line">  [ <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>,  <span class="number">3</span>,  <span class="number">0</span>, -<span class="number">1</span>,  <span class="number">0</span>],</span><br><span class="line">  [-<span class="number">1</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">2</span>, -<span class="number">1</span>,  <span class="number">0</span>],</span><br><span class="line">  [ <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>,  <span class="number">3</span>, -<span class="number">1</span>],</span><br><span class="line">  [ <span class="number">0</span>, -<span class="number">1</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>, -<span class="number">1</span>,  <span class="number">2</span>]])</span><br></pre></td></tr></table></figure>
<h3 id="calculation"><a class="markdownIt-Anchor" href="#calculation"></a> Calculation</h3>
<p>ç¾åœ¨å…ˆå‡è¨­æˆ‘å€‘å·²ç¶“çŸ¥é“åˆ†ç¾¤çš„çµæœäº†ï¼Œä¸¦å°‡çµæœä»¥0,1çš„å½¢å¼è¡¨ç¤ºç‚ºä¸€å€‹matrixï¼Œä»¤é€™å€‹çµæœç‚ºXï¼Œä¸‹é¢çµæœæ˜¯æˆ‘éš¨ä¾¿åˆ†çš„ï¼Œåˆ†3ç¾¤ï¼Œ<code>X[i][j]==1</code>è¡¨ç¤ºnode<code>i</code>å±¬æ–¼cluster<code>j</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X = np.array([</span><br><span class="line">  [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]])</span><br></pre></td></tr></table></figure>
<ol>
<li>Diagonal Degree Matrix è§£é‡‹<br />
æˆ‘å€‘å…ˆå°‡Xçš„è½‰ç½®çŸ©é™£èˆ‡Dåšå…§ç©(<code>X.T.dot(D)</code>):</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([[<span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]])</span><br></pre></td></tr></table></figure>
<p>è§€å¯Ÿä¸€ä¸‹çµæœæœƒç™¼ç¾ï¼Œé€™å€‹çŸ©é™£å°±åªæ˜¯æ˜¯æŠŠDegreeå¡«åˆ°å°æ‡‰çš„clusterä¸­è€Œå·²ã€‚<br />
æ¥è‘—æˆ‘å€‘å†æŠŠä¸Šé¢çµæœèˆ‡Xåšå…§ç©(<code>X.T.dot(D).dot(X)</code>):</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([[<span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>]])</span><br></pre></td></tr></table></figure>
<p>é€™å€‹çµæœå…¶å¯¦å°±è¡¨ç¤º<strong>æ¯å€‹clusterçš„degreeç¸½å’Œ</strong>ã€‚</p>
<ol start="2">
<li>Adjacency Matrix è§£é‡‹<br />
æ¥è‘—æˆ‘å€‘ç›´æ¥å°‡ä¸Šé¢å…¬å¼çš„Dæ›æˆA(<code>X.T.dot(A).dot(X)</code>):</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([[<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>]])</span><br></pre></td></tr></table></figure>
<p>æœƒç™¼ç¾çµæœè¡¨ç¤ºåœ¨<strong>clusterèˆ‡clusteré–“äº’ç›¸é€£æ¥çš„edgeæ•¸</strong>ã€‚</p>
<ol start="3">
<li>Laplacian Matrix è§£é‡‹<br />
å¦‚æœæˆ‘å€‘å°‡å…©å€‹çµæœç›¸æ¸›çš„è©±ï¼Œæœƒç™¼ç¾æ¯ä¸€è¡Œçš„ç¬¬iå€‹å…ƒç´ (å°è§’)å°±æ˜¯æˆ‘å€‘æƒ³è¦è¨ˆç®—çš„cutæ•¸(åˆ†å­éƒ¨åˆ†)!!!</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([[ <span class="number">4</span>, -<span class="number">2</span>, -<span class="number">2</span>],  <span class="comment"># i=0, 4</span></span><br><span class="line">       [-<span class="number">2</span>,  <span class="number">3</span>, -<span class="number">1</span>],  <span class="comment"># i=1, 3</span></span><br><span class="line">       [-<span class="number">2</span>, -<span class="number">1</span>,  <span class="number">3</span>]]) <span class="comment"># i=2, 3</span></span><br></pre></td></tr></table></figure>
<p>æ¥è‘—æˆ‘å€‘å¦å¤–è¨ˆç®—æ¯å€‹clusterè£¡é¢å…±æœ‰å¤šå°‘å€‹nodeï¼Œæˆ‘å€‘å¯ä»¥å°‡Xçš„è½‰ç½®å¾Œèˆ‡è‡ªå·±ç›¸ä¹˜(<code>X.T.dot(X)</code>):</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([[<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>]])</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œå°‡å°è§’çš„çµæœç›¸é™¤å¾ŒåŠ èµ·ä¾†å°±æ˜¯ç®—å¹³å‡å°±å¾—åˆ°Ratio Cutçš„åˆ†æ•¸å•¦~~~<br />
(æˆ‘é€™é‚Šç›´æ¥çŸ©é™£ç›¸é™¤ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±ç®—ã€‚)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([[ <span class="number">2.</span> , -inf, -inf],</span><br><span class="line">       [-inf,  <span class="number">1.</span> , -inf],</span><br><span class="line">       [-inf, -inf,  <span class="number">1.5</span>]])</span><br></pre></td></tr></table></figure>
<p>æ ¹æ“šä¸Šé¢çŸ©é™£é‹ç®—çš„éç¨‹ï¼Œæˆ‘å€‘èƒ½å°‡å…¬å¼é‡æ–°æ•´ç†ç‚º:<br />
<img src="/images/2023/04/27/ratio_cut_2.png" alt="ratio cut formula extended" /></p>
<p>åœ¨ç¬¬ä¸‰è¡Œçš„éƒ¨åˆ†ï¼Œæˆ‘å€‘å¦å¤–å°Xé€²è¡Œæ¨™æº–åŒ–(åŒé™¤ä»¥åˆ†æ¯)è®Šæˆäº†<code>X prime</code>ã€‚</p>
<h3 id="minimize"><a class="markdownIt-Anchor" href="#minimize"></a> Minimize</h3>
<p>å›åˆ°æœ€ä¸€é–‹å§‹çš„å•é¡Œï¼Œæˆ‘å€‘çš„ç›®æ¨™æ˜¯è¦æœ€å°åŒ–ratio cutçš„åˆ†æ•¸ï¼Œæ–¹æ³•å°±æ˜¯é€éä¸Šé¢çš„å…¬å¼å»æ±‚è§£<code>X prime</code>çŸ©é™£ï¼Œé›£éçš„æ˜¯ï¼Œé‚„è¨˜çš„XçŸ©é™£è£¡æœ€ä¸€é–‹å§‹åªèƒ½å¡«å…¥0è·Ÿ1å—ï¼Œæƒ³è¦åœ¨é€™æ¨£åš´æ ¼çš„é™åˆ¶ä¸‹æ±‚å‡ºæœ€ä½³è§£æ˜¯å€‹<strong>NP-hard</strong>çš„å•é¡Œã€‚<br />
ä¸éä¸è¦ç°å¿ƒï¼Œæˆ‘å€‘é‚„æ˜¯å¯ä»¥æ”¾å¯¬æ¢ä»¶ï¼Œå¥—ç”¨è¿‘ä¼¼æ¼”ç®—æ³•ï¼Œå…¶ä¸­ä¸€ç¨®æ–¹æ³•å°±æ˜¯æ¥ä¸‹ä¾†è¦ä»‹ç´¹çš„Spectral Clustering~~~</p>
<h2 id="spectral-clustering"><a class="markdownIt-Anchor" href="#spectral-clustering"></a> Spectral Clustering</h2>
<p>Spectral Clustering åŸºæ–¼ratio cutï¼Œä¸éXçŸ©é™£ä¸­å¯ä»¥å¡«å…¥çš„å€¼è®Šæˆä»‹æ–¼0~1ä¹‹é–“ï¼Œåœ¨æ”¾å¯¬æ¢ä»¶å¾Œï¼Œé€™å€‹æœ€å°åŒ–å•é¡Œçš„è§£å¯ä»¥è¢«è­‰æ˜æ˜¯æ±‚è§£Laplacian Matrixçš„å‰kå°å€‹ç‰¹å¾µå€¼çš„ç‰¹å¾µå‘é‡ã€‚</p>
<ol>
<li>Eigenvalue &amp; Eigenvactors<br />
æˆ‘å€‘å¯ä»¥ç”¨<code>np.linalg.eig</code>ä¾†æ›¿æˆ‘å€‘è¨ˆç®—ç‰¹å¾µå€¼èˆ‡ç‰¹å¾µå‘é‡ï¼Œä¸¦ä½¿ç”¨<code>np.argsort</code>ä¾†æ›¿æˆ‘å€‘æ‰¾å‡ºæœ€å°çš„kå€‹ç‰¹å¾µå‘é‡ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># calculate eigenvalue and eigenvector</span></span><br><span class="line">eig_value, eig_vector = np.linalg.eig(L)</span><br><span class="line"></span><br><span class="line"><span class="comment"># get eigenvector with smallest eigenvalue</span></span><br><span class="line">k = <span class="number">3</span></span><br><span class="line">top_k = np.argsort(eig_value)[:k]</span><br><span class="line">top_k_vector = eig_vector[:, top_k]</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„çµæœå¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([[ <span class="number">0.37796447</span>, -<span class="number">0.45244521</span>, -<span class="number">0.41243936</span>],</span><br><span class="line">       [ <span class="number">0.37796447</span>,  <span class="number">0.17351892</span>, -<span class="number">0.08541899</span>],</span><br><span class="line">       [ <span class="number">0.37796447</span>,  <span class="number">0.54280925</span>, -<span class="number">0.41243936</span>],</span><br><span class="line">       [ <span class="number">0.37796447</span>,  <span class="number">0.32598548</span>, -<span class="number">0.08541899</span>],</span><br><span class="line">       [ <span class="number">0.37796447</span>, -<span class="number">0.58986844</span>, -<span class="number">0.08541899</span>],</span><br><span class="line">       [ <span class="number">0.37796447</span>, -<span class="number">0.09036404</span>,  <span class="number">0.37705765</span>],</span><br><span class="line">       [ <span class="number">0.37796447</span>,  <span class="number">0.09036404</span>,  <span class="number">0.70407803</span>]])</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>K-means<br />
ç”±æ–¼å¾—åˆ°çš„ç‰¹å¾µå€¼ä¸¦ç„¡æ³•ç›´æ¥æ‹¿ä¾†åšè§£é‡‹ï¼Œå› æ­¤Spectral Clusteringå¦å¤–ä½¿ç”¨äº†K-meansä¾†ç‚ºé€™äº›ç‰¹å¾µå€¼åšåˆ†ç¾¤ï¼Œå› ç‚ºæœ€å°çš„ç‰¹å¾µå€¼ç‚º0ã€ç‰¹å¾µå‘é‡ä¸€å®šæ˜¯å¸¸æ•¸ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥æŠŠå®ƒåˆªå»ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œå¦‚æœæˆ‘å€‘æƒ³è¦åˆ†æˆkç¾¤ï¼Œé‚£æˆ‘å€‘è‡³å°‘éœ€è¦ä½¿ç”¨k-1å€‹ç‰¹å¾µå‘é‡ã€‚<br />
ä¸‹é¢ç¨‹å¼æä¾›ä¸€å€‹ç°¡å–®çš„K-meansç¯„ä¾‹ï¼Œå¯ä»¥æ ¹æ“šè‡ªå·±çš„éœ€æ±‚å¦å¤–è¨­ç½®åœæ­¢æ¢ä»¶ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">k_means</span>(<span class="params">X, k, max_iters=<span class="number">10000</span></span>):</span><br><span class="line">    <span class="comment"># randomly initialize centroids</span></span><br><span class="line">    centroids = X[np.random.choice(<span class="built_in">len</span>(X), k, replace=<span class="literal">False</span>)]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(max_iters):</span><br><span class="line">       <span class="comment"># calculate distances</span></span><br><span class="line">       distances = np.linalg.norm(X[:, np.newaxis] - centroids, axis=<span class="number">2</span>)</span><br><span class="line">       <span class="comment"># assign labels </span></span><br><span class="line">       labels = np.argmin(distances, axis=<span class="number">1</span>)</span><br><span class="line">       <span class="comment"># calculate new centroids</span></span><br><span class="line">       centroids = np.array([np.mean(X[labels == i], axis=<span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)])</span><br><span class="line">    <span class="keyword">return</span> labels</span><br><span class="line"></span><br><span class="line"><span class="comment"># remove first vector</span></span><br><span class="line">features = top_k_vector[:, <span class="number">1</span>:]</span><br><span class="line"><span class="comment"># do k-maens</span></span><br><span class="line">labels = k_means(features, k)</span><br></pre></td></tr></table></figure>
<p>é€™æ¨£å°±å¾—åˆ°åˆ†ç¾¤çµæœå•¦~~~(æ³¨æ„: å¯¦éš›åŸ·è¡Œæ•¸å­—çš„é †åºå¯èƒ½ä¸ä¸€æ¨£)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>], dtype=int64)</span><br></pre></td></tr></table></figure>
<h1 id="çµèª"><a class="markdownIt-Anchor" href="#çµèª"></a> çµèª</h1>
<p>å…¶å¯¦å¿½ç•¥åˆ°è¤‡é›œçš„æ•¸å­¸è­‰æ˜çš„è©±ï¼ŒSpectral Clusteringçš„æ¦‚å¿µé‚„æŒºç›´è§€çš„ï¼Œæ–‡ç« åƒè€ƒäº†å°å¤§è³‡ç®¡ç³»çš„é™³å»ºéŒ¦æ•™æˆæ‰€ä½¿ç”¨çš„ä¸Šèª²è¬›ç¾©ï¼Œç¶“éæœ¬äººå¸æ”¶è½‰åŒ–æ’°å¯«è€Œæˆã€‚</p>
]]></content>
      <categories>
        <category>Others</category>
      </categories>
      <tags>
        <tag>Social Network Analysis</tag>
        <tag>Spectral Clustering</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 03 - Interface &amp; Abstract</title>
    <url>/posts/Java/2024/java-learning-03/</url>
    <content><![CDATA[<p><img src="/images/2024/03/19/java_interface_abstract.png" alt="Interface &amp; Abstract" /></p>
<p>OOP é™¤äº†æœ‰ Encapsulationã€Inheritance èˆ‡ Polymorphism ä¸‰å¤§è¦ç´ å¤–ï¼Œ<strong>Interface</strong> èˆ‡ <strong>Abstract</strong> ä¹Ÿæ˜¯ OOP ä¸­çš„é‡è¦æ¦‚å¿µã€‚</p>
<span id="more"></span>
<h2 id="interface-ä»‹é¢"><a class="markdownIt-Anchor" href="#interface-ä»‹é¢"></a> Interface (ä»‹é¢)</h2>
<p>å› ç‚º java çš„ class ä¸èƒ½å¤šé‡ç¹¼æ‰¿ï¼Œæ‰€ä»¥ç™¼å±•å‡º Interface:</p>
<h3 id="å®£å‘Š-interface"><a class="markdownIt-Anchor" href="#å®£å‘Š-interface"></a> å®£å‘Š interface</h3>
<p>interface è£¡çš„è®Šæ•¸éƒ½æ˜¯ <strong>piblic</strong>ã€<strong>static</strong> ä»¥åŠ <strong>final</strong> çš„<br />
interface è£¡çš„æ–¹æ³•å‰‡æ˜¯ <strong>public</strong> ä»¥åŠ <strong>abstract</strong> çš„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Listener</span> &#123;</span><br><span class="line">    <span class="type">double</span> <span class="variable">PI</span> <span class="operator">=</span> <span class="number">3.14149</span>; <span class="comment">// åŒpublic static final</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">listen</span><span class="params">()</span>; <span class="comment">// åŒpublic abstract</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Runnalbe</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">PERIOD</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>; <span class="comment">// æ³¨æ„é€™è£¡åªæœ‰ ()ï¼Œæ²’æœ‰ &#123;&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AnotherRun</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">PERIOD</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">run</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="interface-çš„ç¹¼æ‰¿"><a class="markdownIt-Anchor" href="#interface-çš„ç¹¼æ‰¿"></a> Interface çš„ç¹¼æ‰¿</h3>
<p>Interface å¯ä»¥å¤šé‡ç¹¼æ‰¿</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ActionListener</span> <span class="keyword">extends</span> <span class="title class_">Listener</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MultiInterface</span> <span class="keyword">extends</span> <span class="title class_">Listener</span>, Runnalbe &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="class-å¯¦ä½œ-interface"><a class="markdownIt-Anchor" href="#class-å¯¦ä½œ-interface"></a> Class å¯¦ä½œ Interface</h3>
<p><strong>ç›¸åŒè®Šæ•¸åç¨±</strong>: ç”¨ interfaceA.var ä»¥åŠ interfaceB.var å€åˆ†<br />
<strong>ç›¸åŒå‡½æ•¸åç¨±</strong>: å¯¦ä½œä¸€æ¬¡å°±å¥½</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">implements</span> <span class="title class_">Listener</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listen</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">implements</span> <span class="title class_">Listener</span>, Runnable &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listen</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">C</span> <span class="keyword">implements</span> <span class="title class_">MultiInterface</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listen</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">D</span> <span class="keyword">extends</span> <span class="title class_">A</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>, AnotherRun &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">run</span><span class="params">(<span class="type">int</span> period)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="abstarct-æŠ½è±¡"><a class="markdownIt-Anchor" href="#abstarct-æŠ½è±¡"></a> Abstarct (æŠ½è±¡)</h2>
<p>åªæœ‰åƒæ•¸å®£å‘Šï¼Œæ²’æœ‰å¯¦ä½œçš„æ–¹æ³•ï¼Œç¨±ç‚ºabstract methodã€‚</p>
<ul>
<li><strong>å…·æœ‰ abstract method çš„ class å¿…é ˆå®£å‘Šç‚º abstract classã€‚</strong></li>
<li>ç¹¼æ‰¿ abstract class çš„å­é¡åˆ¥å¿…é ˆ <strong>override æ‰€æœ‰çˆ¶é¡åˆ¥çš„ abstract method</strong>ï¼Œå¦å‰‡å­é¡åˆ¥ä¹Ÿå¿…é ˆå®£å‘Šç‚º abstract classã€‚</li>
<li>å¯¦ä½œ Interface A çš„ Class å¿…é ˆ<strong>å¯¦ä½œ A è£¡çš„æ‰€æœ‰method</strong>ï¼Œå¦å‰‡å¿…é ˆå®£å‘Šè‡ªå·±ç‚º abstract classã€‚</li>
<li><strong>ä¸èƒ½ç›´æ¥ new abstract class</strong>ï¼Œåªèƒ½ new å…¶é abstract class çš„å­é¡åˆ¥ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractExample</span> &#123;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="keyword">abstract</span> <span class="title function_">abstractMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AbstractExample</span><span class="params">()</span> &#123;</span><br><span class="line">        x = <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubClass</span> <span class="keyword">extends</span> <span class="title class_">AbstractExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">abstractMethod</span><span class="params">()</span> &#123; <span class="comment">// must override this method, or SubClass be declared as abstract class</span></span><br><span class="line">        x = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> &#123;</span><br><span class="line">        <span class="type">AbstractExample</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubClass</span>(); <span class="comment">// correct</span></span><br><span class="line">        a.abstractMethod(); <span class="comment">// virtual function, call SubClass&#x27;s abstractMethod</span></span><br><span class="line">        a = <span class="keyword">new</span> <span class="title class_">AbstractExample</span>(); <span class="comment">// Compile error, you can&#x27;t new abstract class</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://programming.im.ncnu.edu.tw/J_index.html">https://programming.im.ncnu.edu.tw/J_index.html</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 02 - OOP</title>
    <url>/posts/Java/2024/java-learning-02/</url>
    <content><![CDATA[<p><img src="/images/2024/03/18/java_oop.png" alt="Java OOP" /></p>
<p>Java æ˜¯ä¸€å€‹ç‰©ä»¶å°å‘çš„ç¨‹å¼èªè¨€ï¼Œé‡é»åœ¨æ–¼å¦‚ä½•å®šç¾©ç‰©ä»¶ä¹‹é–“çš„äº’å‹•ï¼ŒObject Oriented Programming (OOP) çš„ä¸‰å¤§ç‰¹æ€§åˆ†åˆ¥æ˜¯: <strong>Encapsulation (å°è£)</strong>ã€<strong>Inheritance (ç¹¼æ‰¿)</strong> èˆ‡ <strong>Polymorphism (å¤šå‹)</strong> ã€‚</p>
<span id="more"></span>
<h2 id="encapsulation-å°è£"><a class="markdownIt-Anchor" href="#encapsulation-å°è£"></a> Encapsulation (å°è£)</h2>
<p>æ‰€è¬‚å°è£(Encapsulation)ï¼Œæ˜¯æŒ‡class Açš„è¨­è¨ˆè€…å¯ä»¥æŒ‡å®šå…¶ä»–çš„classèƒ½å¦å­˜å–Açš„æŸå€‹memberã€‚</p>
<h3 id="access-modifier"><a class="markdownIt-Anchor" href="#access-modifier"></a> Access Modifier</h3>
<p>é¡åˆ¥ä¸­æ¯å€‹ member çš„æ¬Šé™éƒ½æ˜¯åˆ†é–‹æ§åˆ¶çš„ï¼Œå­˜å–ç¯„åœçš„å¤§å°æ˜¯public &gt; protected &gt; package &gt; privateã€‚</p>
<ul>
<li><strong>private</strong>: åªæœ‰Aè‡ªå·±æ‰å¯ä»¥å­˜å–ï¼Œä½¿ç”¨keywordÂ <strong>private</strong></li>
<li><strong>package (default)</strong>: åªæœ‰å’ŒAåŒä¸€å€‹packageçš„classæ‰å¯ä»¥å­˜å–ï¼Œæ²’æœ‰ç›¸å°æ‡‰çš„keyword</li>
<li><strong>protected</strong>: åªæœ‰åŒä¸€å€‹packageæˆ–æ˜¯Açš„å­é¡åˆ¥æ‰å¯ä»¥å­˜å–ï¼Œä½¿ç”¨keywordÂ <strong>protected</strong></li>
<li><strong>public</strong>: æ‰€æœ‰çš„classéƒ½å¯ä»¥å­˜å–ï¼Œä½¿ç”¨keywordÂ <strong>public</strong></li>
</ul>
<h3 id="package"><a class="markdownIt-Anchor" href="#package"></a> Package</h3>
<p>å°æ‡‰åˆ°è³‡æ–™å¤¾åç¨±ï¼Œä¸åŒå±¤çš„è³‡æ–™å¤¾è¦–ç‚ºä¸åŒå°åŒ…:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> math;</span><br><span class="line"><span class="keyword">package</span> math.geometry;</span><br></pre></td></tr></table></figure>
<p>è¦ä½¿ç”¨å°åŒ…å…§çš„é¡åˆ¥:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math.BasicMath;</span><br><span class="line"><span class="keyword">import</span> math.geometry.*;</span><br></pre></td></tr></table></figure>
<h2 id="inheritance-ç¹¼æ‰¿"><a class="markdownIt-Anchor" href="#inheritance-ç¹¼æ‰¿"></a> Inheritance (ç¹¼æ‰¿)</h2>
<p>Javaä½¿ç”¨é—œéµå­—extendsä¾†è¡¨é”ç¹¼æ‰¿ï¼Œè‹¥classå®£å‘Šæ™‚æ²’æœ‰æŒ‡å®šextendsï¼Œå‰‡Javaæœƒè‡ªå‹•extends <strong>java.lang.Object</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">moveMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Unspecified&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bird</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">moveMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Fly&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="override-è¦†å¯«"><a class="markdownIt-Anchor" href="#override-è¦†å¯«"></a> Override (è¦†å¯«)</h3>
<p>å­é¡åˆ¥é‡æ–°å®šç¾©å®ƒæ‰€èƒ½çœ‹åˆ°çš„çˆ¶é¡åˆ¥ä¸­çš„ method (å¦‚ publicã€protectedï¼Œå¦‚æœå­é¡åˆ¥å’Œçˆ¶é¡åˆ¥åœ¨åŒä¸€å€‹ package è£¡ï¼Œå‰‡æ²’æœ‰ä¿®é£¾å­—çš„methodä¹Ÿå¯ä»¥)ï¼Œç¨±ç‚ºoverrideã€‚</p>
<ul>
<li>å¦‚æœå­é¡åˆ¥çœ‹ä¸åˆ°çˆ¶é¡åˆ¥çš„æ–¹æ³• (å¦‚çˆ¶é¡åˆ¥çš„ private æ–¹æ³•ï¼Œæˆ–å­çˆ¶é¡åˆ¥ä¸åœ¨åŒä¸€å€‹ package è€Œå­é¡åˆ¥å®šç¾©äº†çˆ¶é¡åˆ¥å…§çš„ package method)ï¼Œå‰‡å°±ç®—å®šç¾©äº†åŒæ¨£çš„ method ä¹Ÿä¸æ˜¯override</li>
<li>é‡è¤‡å®šç¾© static method ä¹Ÿä¸ç®— override</li>
<li>å­é¡åˆ¥ä¸å¯ç¸®å°çˆ¶é¡åˆ¥æ–¹æ³•çš„å­˜å–ç¯„åœ</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">C2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">C1</span> <span class="keyword">extends</span> <span class="title class_">C2</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">()</span> &#123; <span class="comment">// Compile Errorï¼Œä¸å¾—ç¸®å°å­˜å–ç¯„åœ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="final-ä¿®é£¾å­—"><a class="markdownIt-Anchor" href="#final-ä¿®é£¾å­—"></a> final ä¿®é£¾å­—</h3>
<p>final é™¤å¯ç”¨ä¾†ä¿®é£¾è®Šæ•¸å¤–ï¼Œä¹Ÿå¯æ”¾åœ¨classå’Œobject methodå‰é¢:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">FinalClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">finalMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>finalæ”¾åœ¨classå‰é¢è¡¨ç¤ºclassä¸å¯è¢«ç¹¼æ‰¿ï¼Œæ”¾åœ¨object methodè¡¨ç¤ºä¸å¯è¢«Overrideã€‚</p>
<h2 id="polymorphism-å¤šå½¢"><a class="markdownIt-Anchor" href="#polymorphism-å¤šå½¢"></a> Polymorphism (å¤šå½¢)</h2>
<h3 id="upcasting-å‘ä¸Šè½‰å‹"><a class="markdownIt-Anchor" href="#upcasting-å‘ä¸Šè½‰å‹"></a> UpCasting (å‘ä¸Šè½‰å‹)</h3>
<p>å­é¡åˆ¥å¯ä»¥å‘ä¸Šç›¸å®¹æ–¼çˆ¶é¡åˆ¥ï¼Œèˆ‰ä¾‹ä¾†èªªï¼ŒBird æ˜¯ä¸€ç¨® Animalï¼Œæ‰€ä»¥å¯ä»¥é †åˆ©å‘ä¸Šè½‰å‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Animal a;</span><br><span class="line">Bird b;</span><br><span class="line">a = b; <span class="comment">// upcasting, Bird is a kind of Animal</span></span><br></pre></td></tr></table></figure>
<h3 id="downcasting-å‘ä¸‹è½‰å‹"><a class="markdownIt-Anchor" href="#downcasting-å‘ä¸‹è½‰å‹"></a> DownCasting (å‘ä¸‹è½‰å‹)</h3>
<p>ç›¸åçš„ï¼Œçˆ¶é¡åˆ¥ä¸¦ä¸èƒ½åƒä¸‹ç›¸å®¹å­é¡åˆ¥ï¼Œå› ç‚º Animal ä¸¦ä¸ä¸€å®šéƒ½æ˜¯ Birdï¼Œå¦‚æœè¦å‘ä¸‹è½‰å‹å¿…é ˆè¦å¼·åˆ¶castingã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Animal</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bird</span>(); <span class="comment">// upcasting</span></span><br><span class="line">Bird b;</span><br><span class="line">b = (Bird)a; <span class="comment">// downcasting, compile correct</span></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">instanceof</span> Bird) &#123; <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>InheritanceExample.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InheritanceExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> &#123;</span><br><span class="line">        Animal a1, a2, a3, a4;</span><br><span class="line">        Bird b;</span><br><span class="line">        Dog d;</span><br><span class="line">        Fish f;</span><br><span class="line">        a2 = a1 = <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line">        b = <span class="keyword">new</span> <span class="title class_">Bird</span>();</span><br><span class="line">        d = <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">        f = <span class="keyword">new</span> <span class="title class_">Fish</span>();</span><br><span class="line">        System.out.println(a1.moveMethod());</span><br><span class="line">        System.out.println(b.moveMethod());</span><br><span class="line">        System.out.println(d.moveMethod());</span><br><span class="line">        System.out.println(f.moveMethod());</span><br><span class="line">        a1 = b; <span class="comment">// Correct, we call this upcasting</span></span><br><span class="line">        b = a1; <span class="comment">// Compile Error, type not compatible</span></span><br><span class="line">        b = (Bird)a1; <span class="comment">// downcasting, Compile Correct</span></span><br><span class="line">        a2 = b; <span class="comment">// Correct,we call this upcasting</span></span><br><span class="line">        d = a2; <span class="comment">// Compile Error, type not compatible</span></span><br><span class="line">        d = (Dog)a2; <span class="comment">// Compile Correct, but runtime error</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="instanceof-é—œéµå­—"><a class="markdownIt-Anchor" href="#instanceof-é—œéµå­—"></a> instanceof é—œéµå­—</h2>
<p>ç”¨ä¾†åˆ¤æ–·æŸ reference æ‰€æŒ‡åˆ°çš„ç‰©ä»¶èˆ‡é¡åˆ¥æ˜¯å¦ç›¸å®¹ (including upcasting):</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Object ref;</span><br><span class="line">ref = <span class="keyword">new</span> <span class="title class_">Bird</span>();</span><br><span class="line"><span class="keyword">if</span> (ref <span class="keyword">instanceof</span> Animal) &#123; <span class="comment">// correct</span></span><br><span class="line">    System.out.println(<span class="string">&quot;ref is currently pointing to an Animal Object.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="virtual-functionè™›æ“¬å‡½æ•¸"><a class="markdownIt-Anchor" href="#virtual-functionè™›æ“¬å‡½æ•¸"></a> Virtual Function(è™›æ“¬å‡½æ•¸)</h3>
<p>ç•¶çˆ¶é¡åˆ¥ reference åˆ°å­é¡åˆ¥çš„ objectï¼Œex: <code>Animal a = new Bird()</code>ï¼Œå¦‚æœå­é¡åˆ¥ override çˆ¶é¡åˆ¥çš„ methodï¼Œjava æœƒå‘¼å«å­é¡åˆ¥çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ Virtual Functionï¼Œ(å¦‚æœæ˜¯å‘¼å«çˆ¶é¡åˆ¥çš„æ–¹æ³•å°±æ˜¯ Non-Virtual Function)ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InheritanceExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> &#123;</span><br><span class="line">        Animal a1;</span><br><span class="line">        a1 = <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line">        System.out.println(a1.moveMethod()); <span class="comment">// print out &quot;Unspecified&quot;</span></span><br><span class="line">        a1 = <span class="keyword">new</span> <span class="title class_">Bird</span>(); <span class="comment">// polymorphism</span></span><br><span class="line">        System.out.println(a1.moveMethod()); <span class="comment">// print out &quot;Fly&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦æ³¨æ„ override çš„ç¯„åœï¼Œåªæœ‰è¢« override çš„ method æ‰æœƒå‘¼å« virtual functionï¼Œèˆ‰ä¾‹ä¾†èªªï¼Œstatic method ã€private method ä¸èƒ½è¢« overrideï¼Œæ‰€ä»¥ä¹Ÿä¸æœƒæœ‰ virtual functionã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">moveMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Unspecified&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> &#123;</span><br><span class="line">        Animal a1;</span><br><span class="line">        a1 = <span class="keyword">new</span> <span class="title class_">Bird</span>();</span><br><span class="line">        System.out.println(a1.moveMethod()); <span class="comment">// print out &quot;Unspecified&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="comment">// this is not override because Bird can&#x27;t see Animal&#x27;s moveMethod</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">moveMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Fly&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://programming.im.ncnu.edu.tw/J_index.html">https://programming.im.ncnu.edu.tw/J_index.html</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 04 - List &amp; Queue</title>
    <url>/posts/Java/2024/java-learning-04/</url>
    <content><![CDATA[<h2 id="collection"><a class="markdownIt-Anchor" href="#collection"></a> Collection</h2>
<p>Collection æ˜¯ Java ä¸­ç”¨ä¾†å­˜å„²ã€æ“ä½œæ•¸æ“šçµæ§‹çš„ä¸€ç¨®æ¡†æ¶ï¼Œåœ¨æ­¤ä¹‹ä¸‹æä¾›äº†è¨±å¤šå¯¦ç”¨çš„ Interfaceï¼ŒåŒ…æ‹¬ <strong>List</strong>ã€<strong>Queue</strong> ä»¥åŠ <strong>Set</strong> (Map æ˜¯åˆ†é–‹çš„)ã€‚</p>
<p><img src="/images/2024/03/19/java_collection.png" alt="Java Collection" /></p>
<span id="more"></span>
<h2 id="list"><a class="markdownIt-Anchor" href="#list"></a> List</h2>
<p>List åŸºæœ¬ä¸Šå°±æ˜¯å‹•æ…‹æ•¸çµ„ï¼Œå…¶ä¸‹æœ‰ <strong>ArrayList</strong>ã€<strong>LinkedList</strong>ã€<strong>Vector</strong> ç­‰ä¸åŒçš„å¯¦ç¾ã€‚</p>
<p><img src="/images/2024/03/19/java_list_interface.png" alt="Java List Interface" /></p>
<ul>
<li><strong>ArrayList</strong>: é€éç´¢å¼•è¨ªå•çš„å‹•æ…‹é™£åˆ—ï¼ŒæŸ¥å°‹çš„æ™‚é–“è¤‡é›œåº¦ç‚º <strong>O(1)</strong>ï¼Œç„¶è€Œæ’å…¥æ™‚æœƒå°‡å¾Œé¢çš„å…ƒç´ å…¨éƒ¨å¾€å³ç§» (åˆªé™¤æ™‚å‰‡æ˜¯å…¨éƒ¨å¾€å·¦ç§»)ï¼Œå› æ­¤æ™‚é–“è¤‡é›œåº¦æœ€å·®ç‚º <strong>O(n)</strong>ã€‚<strong>é©åˆç”¨åœ¨éš¨æ©ŸæŸ¥æ‰¾ã€é »ç¹è¨ªå•åŠæ›´æ–°çš„è³‡æ–™ä¸Šã€‚</strong></li>
<li><strong>LinkedList</strong>: é€éé›™å‘éˆçµå¯¦ç¾çš„å‹•æ…‹é™£åˆ—ï¼Œæ’å…¥èˆ‡åˆªé™¤çš„æ•ˆç‡é«˜ï¼Œæ“ä½œæœ¬èº«çš„æ™‚é–“è¤‡é›œåº¦ç‚º <strong>O(1)</strong>ï¼Œä½†æŸ¥æ‰¾æ™‚éœ€è¦éæ­·æ•´å€‹éˆè¡¨ï¼Œå› æ­¤æ™‚é–“è¤‡é›œåº¦æœ€å·®ç‚º <strong>O(n)</strong>ã€‚<strong>é©ç”¨æ–¼éœ€è¦å¤§é‡æ’å…¥å’Œåˆªé™¤æ“ä½œçš„æƒ…æ³ã€‚</strong></li>
</ul>
<blockquote>
<p>Vector æ˜¯è€èˆŠçš„èªæ³•ï¼Œé€é <code>synchronized</code> åŒæ­¥ä»¥å¯¦ç¾ç·šç¨‹å®‰å…¨ï¼Œæ€§èƒ½ä¸ä½³ï¼Œå¤§å¤šæ™‚å€™éƒ½å¯ä»¥è¢« ArrayList å–ä»£æ‰ï¼Œå…©è€…çš„ç”¨æ³•å¹¾ä¹ä¸€æ¨¡ä¸€æ¨£ã€‚</p>
</blockquote>
<h3 id="array-to-arraylist"><a class="markdownIt-Anchor" href="#array-to-arraylist"></a> Array to ArrayList</h3>
<p><code>Arrays.asList()</code> å¯ä»¥å°‡ Array è½‰æ›ç‚º <code>java.util.Arrays.ArrayList</code>ï¼Œèˆ‡ collections ä¸­æ‰€æŒ‡çš„ ArrayList ä¸¦ä¸ä¸€æ¨£ï¼Œè½‰æ›è€Œæˆçš„ ArrayList ä¸¦ä¸èƒ½é€²è¡Œæ·»åŠ æˆ–åˆªé™¤çš„æ“ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;String&gt; names = Arrays.asList(<span class="string">&quot;Sandy&quot;</span>, <span class="string">&quot;Jack&quot;</span>);</span><br><span class="line"><span class="comment">// names.add(&quot;Frank&quot;); // é‚„æ˜¯å¯ä»¥ compileï¼Œä½†åŸ·è¡Œæœƒå ±éŒ¯</span></span><br></pre></td></tr></table></figure>
<h3 id="basic-usage"><a class="markdownIt-Anchor" href="#basic-usage"></a> Basic Usage</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); <span class="comment">// Interface&lt;Object&gt;</span></span><br><span class="line"><span class="comment">// List&lt;String&gt; list = new LinkedList&lt;&gt;(); </span></span><br><span class="line">list.add(<span class="string">&quot;Jack&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;Emma&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;Jack&quot;</span>);</span><br><span class="line">list.addAll(names);</span><br><span class="line">System.out.println(list); <span class="comment">// [Jack, Emma, Jack, Sandy, Jack]</span></span><br><span class="line"></span><br><span class="line">list.get(<span class="number">0</span>); <span class="comment">// Jack</span></span><br><span class="line">list.indexOf(<span class="string">&quot;Jack&quot;</span>); <span class="comment">// 0</span></span><br><span class="line">list.size(); <span class="comment">// 5</span></span><br><span class="line">list.isEmpty(); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">list.set(<span class="number">0</span>, <span class="string">&quot;Timmy&quot;</span>);</span><br><span class="line">System.out.println(list);  <span class="comment">// [Timmy, Emma, Jack, Sandy, Jack]</span></span><br><span class="line"></span><br><span class="line">list.remove(<span class="number">0</span>); <span class="comment">// remove(index): return element or throw exception</span></span><br><span class="line">list.remove(<span class="string">&quot;Jack&quot;</span>); <span class="comment">// remove(Object): return True or False</span></span><br><span class="line">System.out.println(list);  <span class="comment">// [Emma, Sandy, Jack]</span></span><br><span class="line"></span><br><span class="line">list.removeIf(x-&gt;x.contains(<span class="string">&quot;J&quot;</span>));</span><br><span class="line">System.out.println(list);  <span class="comment">// [Emma, Sandy]</span></span><br><span class="line"></span><br><span class="line">list.clear();</span><br></pre></td></tr></table></figure>
<h2 id="queue"><a class="markdownIt-Anchor" href="#queue"></a> Queue</h2>
<p>Queue æ˜¯ä¸€å€‹<strong>å…ˆé€²å…ˆå‡º (FIFO)</strong> çš„è³‡æ–™é›†åˆï¼Œå…¶ä¸‹å¤§è‡´ä¸Šå¯ä»¥åˆ†ç‚º Deque åŠ Priority Queue å…©é¡ï¼ŒDeque æœ‰ <strong>ArrayDeque</strong>ã€<strong>LinkedList</strong> ç­‰å¯¦ç¾ï¼ŒPriority Queue çš„å¯¦ç¾å‰‡æ˜¯ <strong>PriorityQueue</strong>ã€‚<br />
<img src="/images/2024/03/19/java_queue_interface.png" alt="Java Queue Interface" /></p>
<ul>
<li><strong>LinkedList</strong>: å‰é¢å°±æåˆ°éäº†ï¼Œé›™å‘éˆçµçš„ç‰¹æ€§ä½¿å…¶èƒ½å¤ å¿«é€Ÿåœ°å°é ­å°¾å…ƒç´ é€²è¡Œæ“ä½œã€‚</li>
<li><strong>ArrayDeque</strong>: åŒæ™‚æœ‰ Deque ä»¥åŠ Array çš„æ€§è³ªï¼Œèƒ½å¿«é€Ÿåœ°è¨ªå•å…ƒç´ ï¼Œä¹Ÿå¯ä»¥å¿«é€Ÿåœ°å°é ­å°¾å…ƒç´ é€²è¡Œæ“ä½œã€‚</li>
<li><strong>PriorityQueue</strong>: å…¶å¯¦å°±æ˜¯ Min Heapã€‚</li>
</ul>
<h3 id="deque"><a class="markdownIt-Anchor" href="#deque"></a> Deque</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Deque&lt;Integer&gt; deque = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// Deque&lt;Integer&gt; deque = new ArrayDeque&lt;&gt;();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// add from first</span></span><br><span class="line">deque.addFirst(<span class="number">1</span>);</span><br><span class="line">deque.addFirst(<span class="number">2</span>);</span><br><span class="line">deque.addFirst(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// add from last</span></span><br><span class="line">deque.addLast(<span class="number">4</span>);</span><br><span class="line">deque.addLast(<span class="number">5</span>);</span><br><span class="line">deque.addLast(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(deque);  <span class="comment">// [3, 2, 1, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get from first</span></span><br><span class="line">deque.getFirst();           <span class="comment">// return 3</span></span><br><span class="line">System.out.println(deque);  <span class="comment">// [3, 2, 1, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get from last</span></span><br><span class="line">deque.getLast();            <span class="comment">// return 6</span></span><br><span class="line">System.out.println(deque);  <span class="comment">// [3, 2, 1, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// remove from first</span></span><br><span class="line">deque.removeFirst();        <span class="comment">// return 3</span></span><br><span class="line">System.out.println(deque);  <span class="comment">// [2, 1, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// remove from last</span></span><br><span class="line">deque.removeLast();         <span class="comment">// return 6</span></span><br><span class="line">System.out.println(deque);  <span class="comment">// [2, 1, 4, 5]</span></span><br></pre></td></tr></table></figure>
<h3 id="priority-queue"><a class="markdownIt-Anchor" href="#priority-queue"></a> Priority Queue</h3>
<p>å°‡ pq å°å‡ºä¾†æœƒç™¼ç¾æœ€å°å€¼æ°¸é åœ¨ç¬¬ä¸€å€‹ï¼Œå¾Œé¢é †åºå‰‡ä¸ä¸€å®šï¼Œæœ‰èˆˆè¶£å¯ä»¥è‡ªå·±å»çœ‹ heap çš„è¦å‰‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Queue&lt;Integer&gt; pq = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">7</span>; i&gt;<span class="number">0</span>; i--)&#123;</span><br><span class="line">    pq.offer(i);        <span class="comment">// similar to pq.add()</span></span><br><span class="line">&#125;</span><br><span class="line">System.out.println(pq); <span class="comment">// [1, 4, 2, 7, 5, 6, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get first one</span></span><br><span class="line">pq.peek();</span><br><span class="line">System.out.println(pq); <span class="comment">// [1, 4, 2, 7, 5, 6, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// remove first one</span></span><br><span class="line">pq.poll();</span><br><span class="line">System.out.println(pq); <span class="comment">// [2, 4, 3, 7, 5, 6]</span></span><br></pre></td></tr></table></figure>
<p>Butï¼éƒ½ç”¨åˆ° PriorityQueue äº†ï¼Œè‚¯å®šä¸åªæ˜¯æ‹¿ä¾†è™•ç†é€™éº¼ç°¡å–®çš„ä»»å‹™ï¼Œé€šå¸¸æœƒå„²å­˜ä¸€çµ„è³‡æ–™ï¼Œä¾‹å¦‚ <code>&quot;apple&quot;, 2</code>ã€<code>&quot;banana&quot;, 3</code> ç­‰ï¼Œé€™æ™‚å€™ PriorityQueue å°±ä¸çŸ¥é“è©²å¦‚ä½•é€²è¡Œæ’åºäº†ï¼Œé€™æ™‚æˆ‘å€‘å¯èƒ½å°±éœ€è¦è‡ªè¨‚ç¾©é¡åˆ¥èˆ‡æ¯”è¼ƒå™¨:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Self-defined Class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pair</span>&#123;</span><br><span class="line">    String first;</span><br><span class="line">    <span class="type">int</span> second;</span><br><span class="line"></span><br><span class="line">    Pair(String first, <span class="type">int</span> second)&#123;</span><br><span class="line">        <span class="built_in">this</span>.first = first;</span><br><span class="line">        <span class="built_in">this</span>.second = second;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Self-defined Comparator</span></span><br><span class="line">Comparator&lt;Pair&gt; customComparator = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Pair p1, Pair p2)</span> &#123;</span><br><span class="line">        <span class="comment">// compare with second element</span></span><br><span class="line">        <span class="keyword">return</span> Integer.compare(p1.second, p2.second);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// initialize PriorityQueue with Comparator</span></span><br><span class="line">PriorityQueue&lt;Pair&gt; pq2 = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(customComparator);</span><br><span class="line"></span><br><span class="line"><span class="comment">// offer</span></span><br><span class="line">pq2.offer(<span class="keyword">new</span> <span class="title class_">Pair</span>(<span class="string">&quot;apple&quot;</span>, <span class="number">2</span>));</span><br><span class="line">pq2.offer(<span class="keyword">new</span> <span class="title class_">Pair</span>(<span class="string">&quot;banana&quot;</span>, <span class="number">3</span>));</span><br><span class="line">pq2.offer(<span class="keyword">new</span> <span class="title class_">Pair</span>(<span class="string">&quot;cherry&quot;</span>, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// poll</span></span><br><span class="line"><span class="keyword">while</span> (!pq2.isEmpty()) &#123;</span><br><span class="line">    <span class="type">Pair</span> <span class="variable">pair</span> <span class="operator">=</span> pq2.poll();</span><br><span class="line">    System.out.println(<span class="string">&quot;(&quot;</span> + pair.first + <span class="string">&quot;, &quot;</span> + pair.second + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// result</span></span><br><span class="line"><span class="comment">// (cherry, 1)</span></span><br><span class="line"><span class="comment">// (apple, 2)</span></span><br><span class="line"><span class="comment">// (banana, 3)</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 05 - Set &amp; Map</title>
    <url>/posts/Java/2024/java-learning-05/</url>
    <content><![CDATA[<h2 id="set"><a class="markdownIt-Anchor" href="#set"></a> Set</h2>
<p>Set çš„é—œä¿‚åœ–å¦‚ä¸‹:<br />
<img src="/images/2024/03/19/java_set_interface.png" alt="Java Set Interface" /></p>
<p>æ¯”è¼ƒå¸¸ç”¨çš„:</p>
<ul>
<li><strong>HashSet</strong>: ä¸ä¿è­‰ä¿å­˜é †åºï¼Œé€Ÿåº¦æœ€å¿«</li>
<li><strong>LinkedHashSet</strong>: ä¿å­˜é †åºèˆ‡å­˜å…¥é †åºç›¸åŒ</li>
<li><strong>TreeSet</strong>: ä¾å…ƒç´ çš„å¤§å°æ’åºï¼Œå­˜å…¥çš„å…ƒç´ å¿…é ˆæ˜¯å¯æ¯”è¼ƒçš„</li>
</ul>
<span id="more"></span>
<h3 id="basic-usage"><a class="markdownIt-Anchor" href="#basic-usage"></a> Basic Usage</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Set&lt;String&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(); </span><br><span class="line"><span class="comment">// Set&lt;String&gt; set = new LinkedHashSet&lt;&gt;(); </span></span><br><span class="line"><span class="comment">// Set&lt;String&gt; set = new TreeSet&lt;&gt;();</span></span><br><span class="line"></span><br><span class="line">set.add(<span class="string">&quot;Jack&quot;</span>);</span><br><span class="line">set.add(<span class="string">&quot;Emma&quot;</span>);   </span><br><span class="line">set.add(<span class="string">&quot;Kevin&quot;</span>);   </span><br><span class="line">set.add(<span class="string">&quot;Jack&quot;</span>);</span><br><span class="line"></span><br><span class="line">set.contains(<span class="string">&quot;Tom&quot;</span>) <span class="comment">// False</span></span><br><span class="line">set.remove(<span class="string">&quot;Tom&quot;</span>); <span class="comment">// False</span></span><br><span class="line"></span><br><span class="line">set.size(); <span class="comment">// 3 ([Kevin, Jack, Emma])</span></span><br><span class="line">set.isEmpty(); <span class="comment">// False</span></span><br><span class="line"><span class="comment">// set.clear();</span></span><br></pre></td></tr></table></figure>
<h3 id="iterations"><a class="markdownIt-Anchor" href="#iterations"></a> Iterations</h3>
<p>Iterator æ˜¯è€ç”¨æ³•äº†ä¸å¤ªæ¨è–¦ï¼Œç”¨ for è·Ÿ forEach å¥½å¤šäº†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Iterator&lt;String&gt; newSet = set.iterator();     </span><br><span class="line"><span class="keyword">while</span> (newSet.hasNext()) &#123;   </span><br><span class="line">    System.out.println(newSet.next());   </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="keyword">for</span> (String name: set)&#123;</span><br><span class="line">    System.out.println(name); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">set.forEach((name)-&gt;&#123;</span><br><span class="line">    System.out.println(name);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="set-operations"><a class="markdownIt-Anchor" href="#set-operations"></a> Set Operations</h3>
<p>set å¾ˆé©åˆç”¨ä¾†åšäº¤é›†è¯é›†ç­‰æ“ä½œã€‚</p>
<p><img src="/images/2024/03/19/set_operation.png" alt="Set Operation" /></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String[] source = &#123;<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Tom&quot;</span>&#125;;</span><br><span class="line">Set&lt;String&gt; set2 = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(Arrays.asList(source)); </span><br><span class="line"></span><br><span class="line"><span class="comment">// union</span></span><br><span class="line">set.addAll(set2); <span class="comment">// [Kevin, Tom, Jack, Emma]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// intersection</span></span><br><span class="line">set.retainAll(set2); <span class="comment">// [Jack]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// difference (è‡ªå·±é‚£é‚Š)</span></span><br><span class="line">set.removeAll(set2); <span class="comment">// [Kevin, Emma]</span></span><br></pre></td></tr></table></figure>
<h2 id="map"><a class="markdownIt-Anchor" href="#map"></a> Map</h2>
<p>Map çš„é—œä¿‚åœ–ä¸‹:<br />
<img src="/images/2024/03/19/java_map_interface.png" alt="Java Map Interface" /></p>
<blockquote>
<p>ä¸Šåœ–æœ€å·¦é‚Šçš„ Hashtable è·Ÿ Vector ä¸€æ¨£æ˜¯è€èˆŠçš„èªæ³•ï¼Œé€é <code>synchronized</code> åŒæ­¥ä»¥å¯¦ç¾ç·šç¨‹å®‰å…¨ï¼Œæ€§èƒ½ä¸ä½³ï¼Œå¤§å¤šæ™‚å€™éƒ½å¯ä»¥è¢«å–ä»£æ‰ï¼ŒçœŸçš„è¦ç¢ºä¿ç·šç¨‹å®‰å…¨å¯ä»¥æ”¹ç”¨ <code>ConcurrentHashMap</code>ã€‚</p>
</blockquote>
<p>åŒæ¨£æœ‰ä¸‰ç¨®å¸¸ç”¨çš„ Mapï¼Œå„è‡ªçš„ç‰¹è‰²è·Ÿå°æ‡‰åˆ°çš„ Set ä¸€æ¨¡ä¸€æ¨£ï¼Œåªæ˜¯æ”¹æˆå­˜éµå€¼å°:</p>
<ul>
<li><strong>HashMap</strong>: ä¸ä¿è­‰ä¿å­˜é †åºï¼Œé€Ÿåº¦æœ€å¿«</li>
<li><strong>LinkedHashMap</strong>: ä¿å­˜é †åºèˆ‡å­˜å…¥é †åºç›¸åŒ</li>
<li><strong>TreeMap</strong>: ä¾å…ƒç´ çš„å¤§å°æ’åºï¼Œå­˜å…¥çš„å…ƒç´ å¿…é ˆæ˜¯å¯æ¯”è¼ƒçš„</li>
</ul>
<h3 id="basic-usage-2"><a class="markdownIt-Anchor" href="#basic-usage-2"></a> Basic Usage</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Map&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// Map&lt;String, Integer&gt; set = new LinkedHashMap&lt;&gt;(); </span></span><br><span class="line"><span class="comment">// Map&lt;String, Integer&gt; set = new TreeMap&lt;&gt;();</span></span><br><span class="line"></span><br><span class="line">map.put(<span class="string">&quot;apple&quot;</span>, <span class="number">3</span>);</span><br><span class="line">map.put(<span class="string">&quot;banana&quot;</span>, <span class="number">2</span>);</span><br><span class="line">map.put(<span class="string">&quot;orange&quot;</span>, <span class="number">4</span>);  <span class="comment">// return null</span></span><br><span class="line">map.put(<span class="string">&quot;orange&quot;</span>, <span class="number">5</span>); <span class="comment">// return 4 (previous value)</span></span><br><span class="line">System.out.println(map); <span class="comment">// &#123;banana=2, orange=5, apple=3&#125;</span></span><br><span class="line"></span><br><span class="line">map.get(<span class="string">&quot;apple&quot;</span>); <span class="comment">// return 3</span></span><br><span class="line">map.get(<span class="string">&quot;peach&quot;</span>); <span class="comment">// return null</span></span><br><span class="line">map.getOrDefault(<span class="string">&quot;peach&quot;</span>, <span class="number">0</span>); <span class="comment">// return default 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// map.remove(&quot;apple&quot;); // return 3</span></span><br><span class="line">map.remove(<span class="string">&quot;peach&quot;</span>); <span class="comment">// return null</span></span><br><span class="line"></span><br><span class="line">map.isEmpty(); <span class="comment">// return false</span></span><br><span class="line">map.size(); <span class="comment">// return 3</span></span><br><span class="line"><span class="comment">// map.clear(); </span></span><br></pre></td></tr></table></figure>
<h3 id="keys-and-values"><a class="markdownIt-Anchor" href="#keys-and-values"></a> Keys and Values</h3>
<p>å–ç”¨æ–¹å¼åŸºæœ¬ä¸Šé¡ä¼¼æ–¼ python çš„ <code>keys()</code> å’Œ <code>values()</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// get keys</span></span><br><span class="line">Set&lt;String&gt; keys = map.keySet();</span><br><span class="line">System.out.println(keys); <span class="comment">// [banana, orange, apple]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get values</span></span><br><span class="line">Collection&lt;Integer&gt; values = map.values();</span><br><span class="line">System.out.println(values); <span class="comment">// [2, 5, 3]</span></span><br></pre></td></tr></table></figure>
<h3 id="iterations-2"><a class="markdownIt-Anchor" href="#iterations-2"></a> Iterations</h3>
<p>éæ­· Map æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œé€™è£¡ç¤ºç¯„ä¸‰ç¨®ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. keySet()ï¼Œ</span></span><br><span class="line"><span class="keyword">for</span> (String key: map.keySet())&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;key=&quot;</span> + key + <span class="string">&quot;, value=&quot;</span> + map.get(key));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. entrySet()ï¼Œé¡æ„ˆ python çš„ items()</span></span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, Integer&gt; entry: map.entrySet())&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;key=&quot;</span> + entry.getKey() + <span class="string">&quot;, value=&quot;</span> + entry.getValue());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. forEach()ï¼Œå»ºè­°ä½¿ç”¨</span></span><br><span class="line">map.forEach((key, value) -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;key=&quot;</span> + key + <span class="string">&quot;, value=&quot;</span> + value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="map-operations"><a class="markdownIt-Anchor" href="#map-operations"></a> Map Operations</h3>
<p>è·Ÿ Set ä¸€æ¨£ Map ä¹Ÿå¯ä»¥åš operationsï¼Œå¾ˆé…·çš„æ˜¯æˆ‘å€‘å° <code>keySet()</code> é€²è¡Œæ“ä½œæ™‚ï¼Œå…¶å¯¦ä¹Ÿæœƒå½±éŸ¿åˆ° Map æœ¬èº«ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Map&lt;String, Integer&gt; map2 = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;()&#123;&#123;</span><br><span class="line">    put(<span class="string">&quot;orange&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    put(<span class="string">&quot;lemon&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    put(<span class="string">&quot;starwberry&quot;</span>, <span class="number">2</span>);</span><br><span class="line">&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// union</span></span><br><span class="line">map.putAll(map2); </span><br><span class="line">System.out.println(map); <span class="comment">// &#123;banana=2, orange=1, apple=3, lemon=1, starwberry=2&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// intersection</span></span><br><span class="line">map.keySet().retainAll(map2.keySet());</span><br><span class="line">System.out.println(map); <span class="comment">// &#123;orange=5&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// difference (left half)</span></span><br><span class="line">map.keySet().removeAll(map2.keySet());</span><br><span class="line">System.out.println(map); <span class="comment">// &#123;banana=2, apple=3&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://www.javatpoint.com/set-in-java">Set in Java - Javapoint</a><br />
<a href="https://www.javatpoint.com/java-map">Java Map - Javapoint</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 06 - Multi Thread</title>
    <url>/posts/Java/2024/java-learning-06/</url>
    <content><![CDATA[<h2 id="java-thread"><a class="markdownIt-Anchor" href="#java-thread"></a> Java Thread</h2>
<p>There are two ways to new a thread in Java:</p>
<p><img src="/images/2024/03/20/java_thread.png" alt="Java Thread" /></p>
<span id="more"></span>
<h3 id="implemented-from-runnable-interface"><a class="markdownIt-Anchor" href="#implemented-from-runnable-interface"></a> Implemented from Runnable Interface</h3>
<p>Runnable æ˜¯ä¸€å€‹ interfaceï¼Œ<code>run()</code> è£¡é¢æ”¾çš„å°±æ˜¯ thread è¦åŸ·è¡Œçš„å…§å®¹ï¼Œä¸€å®šè¦ <strong>override</strong> ä¸”ä¸€å®šè¦è¨­ç‚º <strong>public</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestRunnable</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// ... </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// to new</span></span><br><span class="line"><span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">TestRunnable</span>());</span><br></pre></td></tr></table></figure>
<h3 id="extended-from-thread-class"><a class="markdownIt-Anchor" href="#extended-from-thread-class"></a> Extended from Thread Class</h3>
<p>Thread æ˜¯ Runnable çš„å¯¦ç¾ï¼Œç”¨æ³•ä¸€æ¨£æ˜¯æŠŠè¦åŸ·è¡Œçš„ç¨‹å¼æ”¾é€² <code>run()</code> è£¡é¢ï¼Œæ¦‚å¿µä¸€æ¨£æ˜¯ <strong>override</strong> + <strong>public</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// to new</span></span><br><span class="line"><span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TestThread</span>()</span><br></pre></td></tr></table></figure>
<p>æˆ‘å€‘ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ lambda ä¾† new threadã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="start-and-join"><a class="markdownIt-Anchor" href="#start-and-join"></a> Start and Join</h2>
<p>æˆ‘å€‘å¯ä»¥ç”¨ <code>start()</code> ä¾†é–‹å§‹åŸ·è¡Œ threadï¼Œä¸¦ç”¨ <code>join()</code> ä¾†ç­‰å¾… thread å®Œæˆä¸¦å›æ­¸ main threadã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Run in thread&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Run in main&quot;</span>);</span><br><span class="line">thread.start();</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    thread.join();</span><br><span class="line">&#125;<span class="keyword">catch</span>(InterruptedException e)&#123;ã€€<span class="comment">// ä¸€å®šè¦è™•ç† Exception</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;Back to main&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>åŸ·è¡Œçµæœå¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Run in main</span><br><span class="line">Run in thread</span><br><span class="line">Back to main</span><br></pre></td></tr></table></figure>
<h2 id="shared-resources"><a class="markdownIt-Anchor" href="#shared-resources"></a> Shared Resources</h2>
<p>åŒæ™‚æœ‰å¤šå€‹ thread å°åŒä¸€å€‹è³‡æºé€²è¡Œæ“ä½œæ™‚ï¼Œå¯èƒ½æœƒå‡ºç¾ <strong>race condition</strong>ï¼Œå°è‡´çµæœä¸å¦‚é æœŸï¼Œèˆ‰ä¾‹ä¾†èªª:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SyncThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10000</span>; i++)&#123;</span><br><span class="line">            addOne();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addOne</span><span class="params">()</span>&#123;</span><br><span class="line">        sum += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SharedResources</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SyncThread</span>();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SyncThread</span>();</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            thread1.join();</span><br><span class="line">            thread2.join();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(SyncThread.sum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸€å€‹ thread å„åˆ¥å° <code>sum</code> é€²è¡Œ <code>addOne()</code> 10000 æ¬¡ï¼Œç†è«–ä¸Šæœ€å¾Œçš„çµæœæ‡‰è©²æ˜¯<code>sum = 20000</code>ï¼Œä½†æœ€å¾Œçµæœå»å°æ–¼ 20000 (æ¯æ¬¡è·‘æœƒä¸å¤ªä¸€æ¨£)ï¼ŒåŸå› å¤§è‡´ä¸Šæ˜¯é€™æ¨£:</p>
<p><img src="/images/2024/03/20/race_condition.png" alt="race_condition" /></p>
<h3 id="synchronized"><a class="markdownIt-Anchor" href="#synchronized"></a> Synchronized</h3>
<p>æˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>synchronized</code> é—œéµå­—ä¾†å¯¦ç¾åŒæ­¥ï¼Œç¢ºä¿åœ¨åŒä¸€æ™‚é–“åªæœ‰ä¸€å€‹ thread åœ¨åŸ·è¡ŒæŒ‡å®šçš„ä»£ç¢¼ï¼Œä½¿ç”¨æ–¹æ³•æœ‰:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. ä¿®é£¾æ–¹æ³•</span></span><br><span class="line"><span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">addOne</span><span class="params">()</span>&#123;</span><br><span class="line">        sum += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. ä¿®é£¾ä»£ç¢¼å¡Š</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">addOne</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="built_in">this</span>)&#123;</span><br><span class="line">        sum += <span class="number">1</span>;</span><br><span class="line">    &#125;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸é <code>synchronized</code> æ˜¯æ¯”è¼ƒå¤è€çš„ç”¨æ³•äº†ï¼Œåœ¨é«˜ä½µç™¼çš„æƒ…æ³ä¸‹æ€§èƒ½å¯èƒ½æœƒä¸å¤ªå¥½ï¼Œæ‰€ä»¥å¯ä»¥è€ƒæ…®ç”¨å¾Œé¢çš„æ–¹æ³•ã€‚</p>
<h3 id="atomic"><a class="markdownIt-Anchor" href="#atomic"></a> Atomic</h3>
<p>Atomic è¡¨ç¤ºä¸å¯è¢«åˆ‡åˆ†çš„å‹•ä½œï¼Œä»¥æˆ‘å€‘çš„ä¾‹å­ä¾†èªªå°±æ˜¯ï¼Œæˆ‘å€‘å¯ä»¥å°‡ <code>sum</code> æŒ‡å®šç‚º  <strong>AtomicInteger</strong>ï¼Œç¢ºä¿å° <code>sum</code> çš„æ“ä½œä¸æœƒè¢«ä¸­æ–·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SyncThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">AtomicInteger</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">            sum.addAndGet(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="concurrent-lock"><a class="markdownIt-Anchor" href="#concurrent-lock"></a> Concurrent Lock</h3>
<p><code>java.util.concurrent</code> æ˜¯ Java ä¸­ç”¨ä¾†å–ä»£ <code>synchronized</code> çš„ä¸€å€‹ packageï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨è£¡é¢çš„ Lock æ©Ÿåˆ¶ï¼Œé€é Lock çš„å–å¾—ä»¥åŠé‡‹æ”¾ä¾†æ§åˆ¶ thread çš„å‹•ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Lock;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SyncThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">            addOne();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addOne</span><span class="params">()</span> &#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sum += <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="concurrent-collection"><a class="markdownIt-Anchor" href="#concurrent-collection"></a> Concurrent Collection</h3>
<p>å‰å…©ç¯‡åœ¨ä»‹ç´¹ Collections çš„æ™‚å€™æœ‰ç¨å¾®æåˆ°ï¼ŒVectorã€Hashtable ç­‰å®¹å™¨é€é <code>synchronized</code> ä¾†å¯¦ç¾åŒæ­¥ï¼Œåœ¨é«˜ä½µç™¼æ™‚æ•ˆç‡ä¸å¤ªå¥½ï¼Œå› æ­¤ Java å¾Œä¾†åˆæä¾›äº† <strong>ConcurrentHashMap</strong>ã€<strong>ConcurrentLinkedQueue</strong> ç­‰åŸºæ–¼ concurrent å¯¦ç¾çš„å®¹å™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SyncThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> ConcurrentHashMap&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;()&#123;</span><br><span class="line">        &#123;</span><br><span class="line">            put(<span class="string">&quot;sum&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">            map.compute(<span class="string">&quot;sum&quot;</span>, (key, value) -&gt; value + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://popcornylu.gitbooks.io/java_multithread/content/">Javaå¤šåŸ·è¡Œç·’çš„åŸºæœ¬çŸ¥è­˜</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 07 - Concurrent Queue (w/ Producer Consumer Problem)</title>
    <url>/posts/Java/2024/java-learning-07/</url>
    <content><![CDATA[<p>åœ¨ Java çš„å¤šç·šç¨‹æ“ä½œä¸­ï¼ŒConcurrent Queue æ˜¯ä¸€ç¨®éå¸¸é‡è¦çš„å®¹å™¨ï¼Œåœ¨å…±äº«è³‡æºçš„åŒæ™‚ä¹Ÿèƒ½å¤ å¹«æˆ‘å€‘é€²è¡Œæµç¨‹æ§åˆ¶ã€‚<br />
Java çš„ Concurrent Queue å¯ä»¥åˆ†ç‚ºå…©é¡ï¼Œåˆ†åˆ¥æ˜¯ <strong>Blocking Queue</strong> ä»¥åŠ <strong>Non Blocking Queue</strong>ï¼Œå…©ç¨®éƒ½æ˜¯ç·šç¨‹å®‰å…¨çš„ï¼Œæ–‡ç« çš„æœ€å¾Œæœƒç”¨ Blocking Queue ä¾†å¯¦ä½œ <strong>Producer Consumer Problem</strong> !</p>
<p><img src="/images/2024/03/20/consumer_producer.png" alt="Consumer Producer" /></p>
<span id="more"></span>
<h2 id="non-blocking-queue"><a class="markdownIt-Anchor" href="#non-blocking-queue"></a> Non Blocking Queue</h2>
<p>Non Blocking Queue å…¶å¯¦å°±æ˜¯ä¸€èˆ¬çš„ Queueï¼Œå° Queue é€²è¡Œæ“ä½œè¦é¦¬æˆåŠŸè¦é¦¬å¤±æ•—ï¼Œç„¡è«–å¦‚ä½•æœƒç«‹åˆ»çŸ¥é“çµæœã€‚<br />
<strong>ConcurrentLinkedQueue</strong> ä½¿ç”¨ <strong>CAS (Compare-And-Swap)</strong> çš„æ©Ÿåˆ¶ä¾†å¯¦ç¾åŒæ­¥åŠŸèƒ½ï¼Œå°æ–¼éŸ¿æ‡‰å¼çš„æ‡‰ç”¨ä¾†èªªï¼Œç­‰å¾…æ™‚é–“é€šå¸¸æ˜¯ä¸è¢«å…è¨±çš„ï¼Œé€™æ™‚å€™ Non Blocking Queue æœƒæ˜¯å¥½é¸æ“‡ã€‚</p>
<blockquote>
<p><strong>ä»€éº¼æ˜¯ CAS (Compare-And-Swap) ?</strong><br />
CAS æ˜¯åŸå­æ“ä½œçš„ä¸€ç¨® (atomic)ï¼Œå®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯æ¯”è¼ƒç›®æ¨™å…§å­˜ä½ç½®çš„å€¼èˆ‡é æœŸå€¼ï¼Œåªæœ‰åœ¨ç›¸ç­‰çš„æƒ…æ³ä¸‹æ‰å°‡è©²ä½ç½®çš„å€¼æ›´æ–°ç‚ºæ–°å€¼ã€‚<br />
ä»¥ queue çš„æ’å…¥ä¾†èªªï¼Œé¦–å…ˆè¦è¨˜éŒ„ queue å°¾éƒ¨ä½ç½®ï¼Œæ¯æ¬¡æ“ä½œæ™‚å»æª¢æŸ¥ç¾åœ¨çš„ä½ç½®è·Ÿæ‰€è¨˜éŒ„çš„æ˜¯å¦ä¸€æ¨£ï¼Œå¦‚æœæ”¹è®Šäº†å°±é‡ä¾†ä¸€éï¼Œæ²’è®Šçš„è©±å°±æ’å…¥ä¸¦è¨˜éŒ„ä¸‹æ–°çš„å°¾éƒ¨ä½ç½®ã€‚</p>
</blockquote>
<h2 id="blocking-queue"><a class="markdownIt-Anchor" href="#blocking-queue"></a> Blocking Queue</h2>
<p>Blocking Queue ç›¸æ¯”æ–¼ Non Blocking Queue å¤šäº†<strong>é˜»å¡ç­‰å¾…</strong>çš„å‹•ä½œï¼Œå¤§éƒ¨åˆ†çš„ Concurrent Queue éƒ½æ˜¯å±¬æ–¼ Blocking Queueï¼Œå¦‚ <strong>ArrayBlockingQueue</strong>ã€<strong>LinkedBlockingQueue</strong> ç­‰ï¼Œå…¶é˜»å¡æ˜¯åŸºæ–¼ <strong>Lock</strong> ä¾†å¯¦ç¾çš„ï¼Œå…·é«”ä¾†èªª Blocking Queue å¤šäº†å››ç¨®æ“ä½œ:</p>
<p><img src="/images/2024/03/20/blocking_queue.png" alt="Blocking Queue" /></p>
<ul>
<li><strong>put(e)</strong>: å¾å°¾éƒ¨æ”¾å…¥å…ƒç´ ï¼Œå¦‚æœä½‡åˆ—å·²æ»¿å‰‡é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°å‡ºç¾ç©ºä½ä¸¦æ”¾å…¥ã€‚</li>
<li><strong>take(e)</strong>: å¾é ­éƒ¨å–å‡ºå…ƒç´ ï¼Œå¦‚æœä½‡åˆ—ç‚ºç©ºå‰‡é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°å‡ºç¾å…ƒç´ ä¸¦å–å‡ºã€‚</li>
<li><strong>offer(e, æ™‚é–“, æ™‚é–“å–®ä½)</strong>: å¾å°¾éƒ¨æ”¾å…¥å…ƒç´ ï¼Œå¦‚æœä½‡åˆ—å·²æ»¿å‰‡é˜»å¡ç­‰å¾…ä¸€æ®µæ™‚é–“ï¼Œè¶…éæ™‚é–“å‰‡åœæ­¢ç­‰å¾…ä¸¦å›å‚³ falseã€‚</li>
<li><strong>poll(e, æ™‚é–“, æ™‚é–“å–®ä½)</strong>: å¾é ­éƒ¨å–å‡ºå…ƒç´ ï¼Œå¦‚æœä½‡åˆ—å·²æ»¿å‰‡é˜»å¡ç­‰å¾…ä¸€æ®µæ™‚é–“ï¼Œè¶…éæ™‚é–“å‰‡åœæ­¢ç­‰å¾…ä¸¦å›å‚³ falseã€‚</li>
</ul>
<h2 id="producer-consumer-problem"><a class="markdownIt-Anchor" href="#producer-consumer-problem"></a> Producer Consumer Problem</h2>
<p>ç”¨ä¸€å€‹ç°¡å–®çš„ Producer Consumer Problem ä¾†ç·´ç¿’ï¼š</p>
<p><em>6 Producers * 5 messages --&gt; 3 Consumers * 10 messages</em></p>
<ul>
<li>ä½¿ç”¨ <strong>LinkedBlockingQueue</strong> ä½œç‚ºå‚³éè¨Šæ¯çš„å®¹å™¨</li>
<li>Producer ä½¿ç”¨ <code>put()</code> å°‡è¨Šæ¯æ”¾å…¥ queueï¼Œå› ç‚ºæ²’æœ‰é™åˆ¶é•·åº¦æ‰€ä»¥åŸºæœ¬ä¸æœƒé˜»å¡</li>
<li>Consumer ä½¿ç”¨ <code>take()</code> å°‡è¨Šæ¯å¾ queue ä¸­å–å‡ºï¼Œå› ç‚º è¦ç­‰ Producer ç”¢å‡ºè¨Šæ¯æ‰€ä»¥æœƒé˜»å¡</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.BlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.LinkedBlockingQueue;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éš¨æ©Ÿ Sleep ä¸€æ®µæ™‚é–“</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RandomSleep</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Random</span> <span class="variable">rand</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">    RandomSleep(<span class="type">int</span> second)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.MILLISECONDS.sleep(rand.nextInt(second));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Producer</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> idx;</span><br><span class="line">    <span class="keyword">private</span> BlockingQueue&lt;Integer&gt; queue;</span><br><span class="line">    </span><br><span class="line">    Producer(<span class="type">int</span> idx, BlockingQueue&lt;Integer&gt; queue)&#123;</span><br><span class="line">        <span class="built_in">this</span>.idx = idx;</span><br><span class="line">        <span class="built_in">this</span>.queue = queue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;  <span class="comment">//  5 messages</span></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">RandomSleep</span>(<span class="number">500</span>); <span class="comment">// time to produce a message</span></span><br><span class="line">                queue.put(idx);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Consumer</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> idx;</span><br><span class="line">    <span class="keyword">private</span> BlockingQueue&lt;Integer&gt; queue;</span><br><span class="line">    <span class="keyword">private</span> Queue&lt;Integer&gt; reveived = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    Consumer(<span class="type">int</span> idx, BlockingQueue&lt;Integer&gt; queue)&#123;</span><br><span class="line">        <span class="built_in">this</span>.idx = idx;</span><br><span class="line">        <span class="built_in">this</span>.queue = queue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (reveived.size() &lt; <span class="number">10</span>)&#123;  <span class="comment">// 10 messages</span></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                reveived.offer(queue.take());</span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Consumer &quot;</span> + idx + <span class="string">&quot; received: &quot;</span> + reveived);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerProducerProblem</span>&#123;</span><br><span class="line">    <span class="keyword">static</span> BlockingQueue&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;<span class="number">7</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Producer</span>(i, queue).start();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;<span class="number">4</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Consumer</span>(i, queue).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŸ·è¡Œçµæœå¦‚ä¸‹ï¼Œæ¯æ¬¡è·‘éƒ½æœƒä¸å¤ªä¸€æ¨£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Consumer 2 received: [1, 3, 4, 2, 4, 5, 4, 1, 3, 3]</span><br><span class="line">Consumer 1 received: [6, 1, 3, 5, 1, 2, 4, 6, 4, 2]</span><br><span class="line">Consumer 3 received: [2, 6, 5, 5, 5, 1, 2, 6, 3, 6]</span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://www.baeldung.com/java-concurrent-queues">A Guide to Concurrent Queues in Java</a><br />
<a href="https://blog.csdn.net/lzxlfly/article/details/86710382">LinkedBlockingQueueä¸ConcurrentLinkedQueueçš„åŒºåˆ«</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 09 - Stream API</title>
    <url>/posts/Java/2024/java-learning-09/</url>
    <content><![CDATA[<h2 id="java-stream"><a class="markdownIt-Anchor" href="#java-stream"></a> Java Stream</h2>
<p><img src="/images/2024/03/25/java_stream.png" alt="Java Stream" /></p>
<p><strong>Stream</strong> æ˜¯ä¸€å€‹å…ƒç´ å½¢æˆçš„éšŠåˆ—ï¼Œå…¶<strong>ä¾†æº (Source)</strong> å¯ä»¥æ˜¯é›†åˆæˆ–æ•¸çµ„ï¼ŒStream æœ¬èº«ä¸¦ä¸æœƒå­˜å„²å…ƒç´ ï¼Œå…¶æ“ä½œä¹Ÿä¸æœƒå½±éŸ¿åˆ°åŸå§‹ä¾†æºï¼Œå–®ç´”ä»¥æ•¸æ“šæµçš„æ–¹å¼ä¾†è™•ç†æ•¸æ“šï¼Œä¾æ€§è³ªå¯ä»¥åˆ†ç‚ºå…©é¡ï¼š</p>
<ul>
<li><strong>ä¸­é–“æ“ä½œ (Intermediate Operations)</strong><br />
Stream çš„ä¸­é–“æ­¥é©Ÿï¼Œä¸€å€‹ Stream å¯ä»¥æœ‰å¤šå€‹ä¸­é–“æ“ä½œï¼Œæœƒè¿”å›ä¸€å€‹æ–°çš„ streamï¼Œå±¬æ–¼<strong>æƒ°æ€§æ±‚å€¼ (Lazy Evaluation)</strong>ï¼Œæ„æ€æ˜¯ä¸æœƒé¦¬ä¸Šè¨ˆç®—çµæœï¼Œè€Œæ˜¯ç­‰åˆ°çµ‚ç«¯æ“ä½œæ™‚æ‰ä¸€ä½µè¨ˆç®—ã€‚</li>
<li><strong>çµ‚ç«¯æ“ä½œ (Terminal Operations)</strong><br />
Stream çš„æœ€å¾Œä¸€æ­¥ï¼Œä¸€å€‹ stream åªèƒ½æœ‰ä¸€å€‹çµ‚ç«¯æ“ä½œï¼Œæœƒç”¢ç”Ÿä¸€å€‹æ–°çš„é›†åˆæˆ–å€¼ã€‚</li>
</ul>
<span id="more"></span>
<h3 id="å‰µå»º-stream"><a class="markdownIt-Anchor" href="#å‰µå»º-stream"></a> å‰µå»º Stream</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// array to stream</span></span><br><span class="line"><span class="type">int</span>[] array = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">Arrays.stream(array);</span><br><span class="line">Stream.of(array);</span><br><span class="line"></span><br><span class="line"><span class="comment">// collecitions to stream</span></span><br><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">Set&lt;Integer&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(numbers);</span><br><span class="line">Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;()&#123;&#123;</span><br><span class="line">    put(<span class="number">1</span>, <span class="number">1</span>); put(<span class="number">2</span>, <span class="number">2</span>); put(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">&#125;&#125;;</span><br><span class="line"></span><br><span class="line">numbers.stream();</span><br><span class="line">set.stream();</span><br><span class="line">map.keySet().stream();</span><br><span class="line">map.values().stream();</span><br></pre></td></tr></table></figure>
<h3 id="parallel-stream"><a class="markdownIt-Anchor" href="#parallel-stream"></a> Parallel Stream</h3>
<p>Stream æ”¯æ´<strong>ä½µè¡Œæµ (parallelStream)</strong>ï¼Œåº•å±¤é»˜èªä½¿ç”¨ <strong>ForkJoinPool</strong>ï¼Œæ‰€è¬‚çš„ ForkJoinPool å…¶å¯¦å°±æ˜¯ divide and conquer ç®—æ³•ï¼Œå°‡ä»»å‹™ä¸æ–·æ‹†åˆ†æˆå°ä»»å‹™è™•ç†ï¼Œèƒ½å……åˆ†åˆ©ç”¨ CPU çš„æ•ˆèƒ½ï¼Œç´°ç¯€å¯ä»¥åƒè€ƒ: <a href="https://popcornylu.gitbooks.io/java_multithread/content/threadpool/forkjoin.html">ForkJoin Pool</a></p>
<p><img src="/images/2024/03/25/ForkJoinPool.png" alt="ForkJoinPool" /></p>
<p>å¯ä»¥ç›´æ¥å‰µå»º Parallel Stream ä¹Ÿå¯ä»¥å¾ Stream è½‰æ›ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">numbers.parallelStream();    <span class="comment">// or</span></span><br><span class="line">numbers.stream().parallel();</span><br></pre></td></tr></table></figure>
<h2 id="éæ­·åŒ¹é…-foreachfindmatch"><a class="markdownIt-Anchor" href="#éæ­·åŒ¹é…-foreachfindmatch"></a> éæ­·/åŒ¹é… (foreach/find/match)</h2>
<p>findFirstã€findAny ç­‰æ“ä½œè¿”å›çš„ç‚ºä¸€å€‹ <strong>Optional</strong> ç‰©ä»¶ï¼Œç”¨ä¾†è¡¨ç¤ºä¸€å€‹å¯èƒ½ç‚º null çš„å€¼ï¼Œå¸¸ç”¨æ–¹æ³•ç‚º:</p>
<ul>
<li><strong>get()</strong>ï¼šè·å– Optional å¯¹è±¡ä¸­çš„å€¼ï¼Œå¦‚æœå€¼ä¸º nullï¼Œåˆ™æŠ›å‡º NoSuchElementException å¼‚å¸¸ã€‚</li>
<li><strong>orElse(T other)</strong>ï¼šè·å– Optional å¯¹è±¡ä¸­çš„å€¼ï¼Œå¦‚æœå€¼ä¸º nullï¼Œåˆ™è¿”å›æŒ‡å®šçš„é»˜è®¤å€¼ã€‚</li>
<li><strong>isPresent()</strong>ï¼šåˆ¤æ–­ Optional å¯¹è±¡æ˜¯å¦åŒ…å«å€¼ã€‚</li>
<li><strong>ifPresent(Consumer&lt;? super T&gt; consumer)</strong>ï¼šå¦‚æœ Optional å¯¹è±¡åŒ…å«å€¼ï¼Œåˆ™æ‰§è¡ŒæŒ‡å®šçš„æ“ä½œã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// forEach</span></span><br><span class="line">numbers.stream()</span><br><span class="line">    .forEach(System.out:: println);</span><br><span class="line"></span><br><span class="line"><span class="comment">// findFirst (è¿”å›ç¬¬ä¸€å€‹)</span></span><br><span class="line">Optional&lt;Integer&gt; first = numbers.stream()</span><br><span class="line">    .filter(n -&gt; n &gt; <span class="number">2</span>)</span><br><span class="line">    .findFirst();</span><br><span class="line">first.get();</span><br><span class="line"></span><br><span class="line"><span class="comment">// findAny (è¿”å›ä»»ä¸€å€‹)</span></span><br><span class="line">numbers.parallelStream()</span><br><span class="line">    .filter(n -&gt; n &gt; <span class="number">2</span>)</span><br><span class="line">    .findAny()</span><br><span class="line">    .get();</span><br><span class="line"></span><br><span class="line"><span class="comment">// anyMatch (ä»»ä¸€ç¬¦åˆ)</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">match</span> <span class="operator">=</span> numbers.parallelStream()</span><br><span class="line">    .filter(n -&gt; n &gt; <span class="number">2</span>)</span><br><span class="line">    .anyMatch();</span><br></pre></td></tr></table></figure>
<h2 id="ç¯©é¸-filter"><a class="markdownIt-Anchor" href="#ç¯©é¸-filter"></a> ç¯©é¸ (filter)</h2>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">numbers.stream()</span><br><span class="line">    .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    .sorted((n1, n2)-&gt; n2 - n1)    <span class="comment">// Descending </span></span><br><span class="line">    .forEach(System.out::println);</span><br></pre></td></tr></table></figure>
<h2 id="æ˜ å°„-mapflatmap"><a class="markdownIt-Anchor" href="#æ˜ å°„-mapflatmap"></a> æ˜ å°„ (map/flatMap)</h2>
<ul>
<li><strong>map</strong>: æŠŠä¸€å€‹å…ƒç´ æ˜ å°„åˆ°ä¸€å€‹æ–°çš„å…ƒç´ </li>
<li><strong>flatMap</strong>: æŠŠä¸€å€‹å…ƒç´ æ˜ å°„åˆ°ä¸€å€‹æ–°çš„ stream</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">numbers.stream()</span><br><span class="line">    .map(n -&gt; n * n)</span><br><span class="line">    .collect(Collectors.toList());</span><br></pre></td></tr></table></figure>
<p>å‡è¨­è¦å°‡ <code>&#123;&quot;Hello&quot;, &quot;World&quot;&#125;</code> è½‰æ›æˆ <code>&#123;&quot;H&quot;, &quot;e&quot;, &quot;l&quot;, &quot;o&quot;, &quot;W&quot;, &quot;r&quot;, &quot;d&quot;&#125;</code>ï¼Œé‚£æˆ‘å€‘ä¸èƒ½ç›´æ¥ç”¨ <code>map(s-&gt;s.split(&quot;&quot;))</code>ï¼Œå› ç‚º map å›å‚³çš„æ˜¯ä¸€å€‹å…ƒç´ ï¼Œæ‰€ä»¥æœƒæ˜¯ <code>String[]</code>ï¼Œé€™æ™‚å€™å°±å¯ä»¥æ”¹ç”¨<strong>flatMap</strong>:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">helloworld = &#123;<span class="string">&quot;H&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;d&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">helloworld.stream()</span><br><span class="line">    .flatMap(word-&gt; Arrays.stream(word.split(<span class="string">&quot;&quot;</span>)))</span><br><span class="line">    .distinct()</span><br><span class="line">    .collect(Collectors.toList());</span><br></pre></td></tr></table></figure>
<h2 id="æ­¸ç´„-reduce"><a class="markdownIt-Anchor" href="#æ­¸ç´„-reduce"></a> æ­¸ç´„ (reduce)</h2>
<ul>
<li><strong>identity</strong>: åˆå§‹å€¼ï¼Œæ²’è¨­ç½®å°±æ˜¯ç”¨ç¬¬ä¸€ç­†è³‡æ–™ç•¶åˆå§‹å€¼ã€‚</li>
<li><strong>accumulator</strong>: ç´¯åŠ å™¨å‡½æ•¸ï¼Œç¬¬ä¸€å€‹åƒæ•¸æ˜¯ç´¯åŠ å€¼ï¼Œç¬¬äºŒå€‹åƒæ•¸æ˜¯ç•¶å‰å€¼ã€‚</li>
<li><strong>combiner</strong>: çµ„åˆå™¨å‡½æ•¸ï¼Œåœ¨ parallel æƒ…æ³ä¸‹ç”¨ä¾†åˆä½µå„å€‹ç·šç¨‹çš„çµæœã€‚</li>
</ul>
<h3 id="accumulator"><a class="markdownIt-Anchor" href="#accumulator"></a> accumulator</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Optional&lt;T&gt; reduce(</span></span><br><span class="line"><span class="comment">//     BinaryOperator&lt;T&gt; accumulator</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line">Optional&lt;Integer&gt; opt_sum = numbers.stream()</span><br><span class="line">    .reduce((acc, x) -&gt; acc + x);</span><br><span class="line"><span class="type">int</span> <span class="variable">sum1</span> <span class="operator">=</span> opt_sum.get();</span><br></pre></td></tr></table></figure>
<h3 id="identity-accumulator"><a class="markdownIt-Anchor" href="#identity-accumulator"></a> identity + accumulator</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// T reduce(</span></span><br><span class="line"><span class="comment">//     T identity, </span></span><br><span class="line"><span class="comment">//     BinaryOperator&lt;T&gt; accumulator</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line"><span class="type">int</span> <span class="variable">sum2</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">    .reduce(<span class="number">0</span>, (acc, x) -&gt; acc + x);</span><br></pre></td></tr></table></figure>
<h3 id="identity-accumulator-combiner"><a class="markdownIt-Anchor" href="#identity-accumulator-combiner"></a> identity + accumulator + combiner</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// &lt;U&gt; U reduce(</span></span><br><span class="line"><span class="comment">//     U identity, </span></span><br><span class="line"><span class="comment">//     BiFunction&lt;U, ? super T, U&gt; accumulator,</span></span><br><span class="line"><span class="comment">//     BinaryOperator&lt;U&gt; combiner</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line">numbers.parallelStream()</span><br><span class="line">    .reduce(<span class="number">0</span>, (acc, x)-&gt;&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;acc: &quot;</span> + acc + <span class="string">&quot;, x: &quot;</span> + x);</span><br><span class="line">        <span class="keyword">return</span> acc+x;</span><br><span class="line">    &#125;,(comb, x)-&gt;&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;comb: &quot;</span> + comb + <span class="string">&quot;, x: &quot;</span> + x);</span><br><span class="line">        <span class="keyword">return</span> comb+x;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">acc: 0, x: 2    // å„ç·šç¨‹</span><br><span class="line">acc: 0, x: 1</span><br><span class="line">acc: 0, x: 3</span><br><span class="line">comb: 2, x: 3   // åˆä½µç·šç¨‹</span><br><span class="line">comb: 1, x: 5</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç™¼ç¾æ¯å€‹å…ƒç´ éƒ½è¢«ç•¶ä½œæ˜¯ä¸€å€‹æ–°çš„ç·šç¨‹äº† (acc éƒ½æ˜¯ 0)ï¼Œç­‰æ–¼ accumulator æ ¹æœ¬æ²’æ´¾ä¸Šç”¨å ´ï¼Œäº‹å¯¦ä¸Šï¼Œaccumulator åœ¨é€™è£¡çš„ä½œç”¨åè€Œæ›´åƒæ˜¯ä¸€å€‹ä¸­ä»‹çš„è½‰æ›å™¨ï¼Œè² è²¬å°‡åŸæœ¬çš„é¡å‹ <strong>T</strong> è½‰æ›åˆ° <strong>U</strong>ï¼Œå¯ä»¥åƒè€ƒ: <a href="https://stackoverflow.com/questions/24308146/why-is-a-combiner-needed-for-reduce-method-that-converts-type-in-java-8">Why is a combiner needed for reduce method that converts type in java 8</a></p>
<h2 id="æ”¶é›†-collect"><a class="markdownIt-Anchor" href="#æ”¶é›†-collect"></a> æ”¶é›† (collect)</h2>
<p><strong>collect</strong> çš„ç›®çš„æ˜¯ç”¨ä¾†å°‡ stream è½‰å­˜ç‚ºå…¶ä»–è³‡æ–™å‹æ…‹ã€‚</p>
<h3 id="stream-to-collections"><a class="markdownIt-Anchor" href="#stream-to-collections"></a> stream to collections</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">numbers.stream()</span><br><span class="line">    .collect(Collectors.toList());</span><br><span class="line">numbers.stream()</span><br><span class="line">    .collect(Collectors.toSet());</span><br><span class="line">numbers.stream()</span><br><span class="line">    .collect(Collectors.toMap(x-&gt;x, x-&gt;x));</span><br></pre></td></tr></table></figure>
<h3 id="partitioningby-groupingby"><a class="markdownIt-Anchor" href="#partitioningby-groupingby"></a> partitioningBy / groupingBy</h3>
<ul>
<li><strong>partitioningBy</strong>: åˆ†ç‚ºå…©ç¾¤ (<code>Map&lt;boolean, List&lt;T&gt;&gt;</code>)</li>
<li><strong>groupingBy</strong>: åˆ†ç‚ºå¤šç¾¤ (<code>Map&lt;T, List&lt;T&gt;&gt;</code>)</li>
</ul>
<p><img src="/images/2024/03/25/partitioningBy.png" alt="partitioningBy" /></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">numbers.stream()</span><br><span class="line">    .collect(Collectors.partitioningBy(x -&gt; x&gt;<span class="number">2</span>));</span><br><span class="line">numbers.stream()</span><br><span class="line">    .collect(Collectors.groupingBy(x -&gt; x%<span class="number">4</span>));</span><br></pre></td></tr></table></figure>
<h3 id="joining-string"><a class="markdownIt-Anchor" href="#joining-string"></a> joining (String)</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">joined</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">    .map(String::valueOf)</span><br><span class="line">    .collect(Collectors.joining(<span class="string">&quot;-&quot;</span>));</span><br></pre></td></tr></table></figure>
<h2 id="çµ±è¨ˆ-maxminsumaveragecount"><a class="markdownIt-Anchor" href="#çµ±è¨ˆ-maxminsumaveragecount"></a> çµ±è¨ˆ (max/min/sum/average/count)</h2>
<h3 id="max-min"><a class="markdownIt-Anchor" href="#max-min"></a> max / min</h3>
<p>max / min ç›¸é—œçš„æ“ä½œéƒ½æ˜¯è¿”å› <strong>Optional</strong> ç‰©ä»¶ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// int</span></span><br><span class="line">Optional&lt;Integer&gt; max = numbers.stream()</span><br><span class="line">    .max(Integer::compareTo);</span><br><span class="line">max.get();</span><br><span class="line"></span><br><span class="line"><span class="comment">// String</span></span><br><span class="line">names.stream()</span><br><span class="line">    .min(Comparator.comparing(String::valueOf))</span><br><span class="line">    .get();</span><br><span class="line"></span><br><span class="line"><span class="comment">// stream</span></span><br><span class="line">numbers.stream()</span><br><span class="line">    .collect(Collectors.maxBy(Integer::compareTo))</span><br><span class="line">    .get();</span><br></pre></td></tr></table></figure>
<h3 id="sum-average-count"><a class="markdownIt-Anchor" href="#sum-average-count"></a> sum / average / count</h3>
<p>æ³¨æ„ average å›å‚³çš„æ˜¯ double</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// sum</span></span><br><span class="line">numbers.stream()</span><br><span class="line">    .collect(Collectors.summingInt(x-&gt;x));</span><br><span class="line"></span><br><span class="line"><span class="comment">// average</span></span><br><span class="line"><span class="type">double</span> <span class="variable">average</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">    .collect(Collectors.averagingInt(x-&gt;x));</span><br><span class="line"></span><br><span class="line"><span class="comment">// count</span></span><br><span class="line">names.stream().count();</span><br><span class="line">names.stream().collect(Collectors.counting());</span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://www.runoob.com/java/java8-streams.html">Java 8 Stream | èœé¸Ÿæ•™ç¨‹</a><br />
<a href="https://blog.csdn.net/m0_58093863/article/details/123165069">Java8 Stream æµçš„åˆ›å»ºã€ç­›é€‰ã€æ˜ å°„ã€æ’åºã€å½’çº¦ã€åˆ†ç»„ã€èšåˆã€æå–ä¸ç»„åˆã€æ”¶é›†ã€æ¥åˆã€foreachéå†</a><br />
<a href="https://www.cnblogs.com/lijingran/p/8727507.html">java8ä¸­streamçš„mapå’Œflatmapçš„ç†è§£</a><br />
<a href="https://blog.csdn.net/IO_Field/article/details/54971679">Java 8ç³»åˆ—ä¹‹Streamä¸­ä¸‡èƒ½çš„reduce</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java è‡ªå­¸ç­†è¨˜ 08 - ExecutorService &amp; Future</title>
    <url>/posts/Java/2024/java-learning-08/</url>
    <content><![CDATA[<p>åœ¨ <a href="/posts/Java/2024/java-learning-08">Java è‡ªå­¸ç­†è¨˜ 07 - Concurrent Queue</a> ä¸­æˆ‘å€‘ä½¿ç”¨ concurrent queue ä¾†å¯¦ä½œ <strong>Producer Consumer Problem</strong>ï¼Œå°‡ç”Ÿç”¢è€…ç”¢å‡ºçš„ task ä¸Ÿçµ¦ queueï¼Œæ¶ˆè²»è€…ä¸€æœ‰ç©ºé–’å°±æœƒå» queue ä¸­æ‹¿æ–°çš„ task å‡ºä¾†ï¼Œå¯¦éš›ä¸Šé€™å°±æ˜¯ <strong>Thread Pool</strong> çš„æ¦‚å¿µï¼Œä¸ééç¨‹ä¸­æˆ‘å€‘æ˜¯è‡ªå·±å»å‰µå»ºèˆ‡ç®¡ç† thread å’Œ queueï¼Œè€Œ Java å…¶å¯¦æä¾›äº†è¨±å¤šè·Ÿ Thread Pool æœ‰é—œçš„ä»‹é¢ï¼Œè®“æˆ‘å€‘èƒ½å¤ æ›´ç°¡å–®çš„å¯¦ç¾é€™äº›åŠŸèƒ½ã€‚</p>
<h2 id="executorservice"><a class="markdownIt-Anchor" href="#executorservice"></a> ExecutorService</h2>
<p><img src="/images/2024/03/22/executor_service.png" alt="Executor Service" /></p>
<span id="more"></span>
<p><strong>ExecutorService</strong> æ˜¯ Java ä¸­ç”¨æ–¼ç®¡ç† Thread Pool çš„ Interfaceï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ <strong>Executors</strong> é¡åˆ¥ä¸‹çš„ method ä¾†å»å¯¦ä½œä¸€å€‹ ExecutorServiceï¼Œå¸¸è¦‹çš„æ–¹æ³•æœ‰:</p>
<ul>
<li><strong>newSingleThreadExecutor()</strong>: å‰µå»ºä¸€å€‹å–®å€‹å·¥ä½œç·šç¨‹çš„ç·šç¨‹æ± ã€‚</li>
<li><strong>newFixedThreadPool(int n)</strong>: å‰µå»ºä¸€å€‹ n å€‹ç·šç¨‹çš„ç·šç¨‹æ± ã€‚</li>
<li><strong>newCachedThreadPool()</strong>: å‰µå»ºä¸€å€‹å¯æ ¹æ“šéœ€è¦è‡ªå‹•æ“´å±•çš„ç·šç¨‹æ± ã€‚</li>
</ul>
<p>å¸¸ç”¨æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// new a ExecutorService</span></span><br><span class="line"><span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// submit runnable tasks to ExecutorService</span></span><br><span class="line">executor.submit(<span class="keyword">new</span> <span class="title class_">RunnableTask</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// submit callable tasks to ExecutorService</span></span><br><span class="line">executor.submit(<span class="keyword">new</span> <span class="title class_">CallableTask</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// shutdown ExecutorService</span></span><br><span class="line">executor.shutdown();     <span class="comment">// smooth shutdown</span></span><br><span class="line">executor.shutdownNow();  <span class="comment">// force shutdown</span></span><br></pre></td></tr></table></figure>
<p>å¾ä¸Šé¢çš„ç¨‹å¼ç¢¼ä¸­å¯ä»¥ç™¼ç¾ï¼Œ ExecutorService é™¤äº†è·Ÿ Thread ä¸€æ¨£å¯ä»¥åŸ·è¡Œ <strong>Runnable</strong> å¤–ï¼Œé‚„å¤šäº†ä¸€å€‹ <strong>Callable</strong>ï¼Œå…©è€…éå¸¸ç›¸ä¼¼ï¼Œå·®åˆ¥åªåœ¨æ–¼ Callable æœƒå›å‚³æ±è¥¿è€Œ Runnable ä¸æœƒï¼Œå¯¦ä½œ Callable çš„æ–¹æ³•å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CallableTask</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;Integer&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">call</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>call()</code> å±¬æ–¼ abstract methodï¼Œä¸€å®šè¦ override æ‰ï¼Œå¦å¤–å°±æ˜¯è¦æ³¨æ„æ³›å‹çš„è³‡æ–™å‹æ…‹ã€‚</p>
<h2 id="future"><a class="markdownIt-Anchor" href="#future"></a> Future</h2>
<p><code>submit()</code> æ–¹æ³•æœƒè¿”å›ä¸€å€‹ <strong>Future</strong> ç‰©ä»¶ï¼Œç°¡å–®ä¾†èªª Future æ˜¯ä¸€å€‹æœªä¾†æœƒå¾—åˆ°çš„çµæœï¼Œä»¥ submit ä¸€å€‹ Callable  ä¾†çš„è©±ï¼Œå…¶ Futrue å°±æ˜¯æœªä¾†çš„æŸä¸€æ™‚é–“é»æˆ‘å€‘æœƒå¾—åˆ° Callable çš„è¿”å›å€¼ã€‚è¶Šçœ‹è¦ºå¾—è¶Šç†Ÿæ‚‰ï¼Œé€™å°±æ˜¯ javascript è£¡çš„ promise è·ŸéåŒæ­¥çš„æ¦‚å¿µå‘€ !<br />
æˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>get()</code> æ–¹æ³•ä¾†å–å¾—çµæœï¼Œç•¶å‘¼å« <code>get()</code> æ™‚ï¼Œä¸»é€²ç¨‹æœƒè¢«é˜»æ“‹ï¼Œç›´åˆ° get() å–å¾—è¿”å›å€¼æ‰æœƒç¹¼çºŒï¼Œèˆ‰ä¾‹ä¾†èªªï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CallableTask</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;String&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Task started.&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Task finished.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadPool</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException, ExecutionException&#123;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        Future&lt;String&gt; future = executor.submit(<span class="keyword">new</span> <span class="title class_">CallableTask</span>());</span><br><span class="line">        System.out.println(<span class="string">&quot;Main thread keeps running.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// main thread is blocked until task return</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> future.get();</span><br><span class="line">        System.out.println(str);;</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;Main thread continues.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        executor.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åŸ·è¡Œçµæœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Main thread keeps running.</span><br><span class="line">Task started.</span><br><span class="line">Task finished.</span><br><span class="line">Main thread continues.</span><br></pre></td></tr></table></figure>
<h2 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h2>
<p><a href="https://popcornylu.gitbooks.io/java_multithread/content/">Javaå¤šåŸ·è¡Œç·’çš„åŸºæœ¬çŸ¥è­˜</a><br />
<a href="https://javarevisited.blogspot.com/2017/02/difference-between-executor-executorservice-and-executors-in-java.html#axzz7ZGX8FDUO">Difference between Executor, ExecutorService and Executers class in Java</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello Hexoï¼ç”¨ Hexo åœ¨ GitHub Pages ä¸Šæ¶è¨­å€‹äººéƒ¨è½æ ¼å§ï¼(1)</title>
    <url>/posts/Blog/2023/Hello-Hexo-1/</url>
    <content><![CDATA[<h1 id="hexo-ä»‹ç´¹"><a class="markdownIt-Anchor" href="#hexo-ä»‹ç´¹"></a> Hexo ä»‹ç´¹</h1>
<p>Hexo æ˜¯ä¸€å€‹åŸºæ–¼Node.js çš„è‡ªå‹•åŒ–éƒ¨è½æ ¼éƒ¨ç½²æ¡†æ¶ï¼Œæœ‰è¿‘400ç¨®ç¶²é ä¸»é¡Œå¯ä¾›é¸æ“‡ï¼Œæ”¯æ´Markdownèªè¨€æ’°å¯«æ–‡ç« å…§å®¹è€Œä¸”éƒ¨ç½²ç›¸ç•¶è¿…é€Ÿï¼Œç°¡ç›´æ˜¯è‡ªå·±æ¶è¨­éƒ¨è½æ ¼çš„å¿…å‚™ç¥å™¨å‘€ï¼ä»€éº¼ï¼Ÿä½ èªªä¹‹å‰æ²’ç”¨éNode.jsæ€éº¼è¾¦ï¼Ÿæ²’é—œä¿‚ï¼Œå› ç‚ºæˆ‘ä¹‹å‰ä¹Ÿæ²’ç”¨éXDã€‚äº‹å¯¦ä¸Šï¼Œåªè¦æŒæ¡å¹¾å€‹åŸºæœ¬çš„æŒ‡ä»¤ï¼Œå°±èƒ½å¤ æ¶å‡ºæ¼‚æ¼‚äº®äº®ã€åŠŸèƒ½é½Šå…¨çš„å€‹äººéƒ¨è½æ ¼å›‰ï¼å°±è®“æˆ‘å€‘ä¸€èµ·çœ‹ä¸‹å»å§ï½<br />
Hexo å®˜ç¶²ï¼š<a href="https://hexo.io/zh-cn/">https://hexo.io/zh-cn/</a><br />
Hexo GitHubï¼š<a href="https://github.com/hexojs/hexo">https://github.com/hexojs/hexo</a></p>
<span id="more"></span>
<h1 id="å‰ç½®ä½œæ¥­"><a class="markdownIt-Anchor" href="#å‰ç½®ä½œæ¥­"></a> å‰ç½®ä½œæ¥­</h1>
<ul>
<li>å®‰è£ Node.js<br />
å®˜æ–¹è¼‰é»ï¼š<a href="https://nodejs.org/zh-tw/download/">https://nodejs.org/zh-tw/download/</a></li>
</ul>
<blockquote>
<p>é€²å…¥ç¶²ç«™å¾Œé¸æ“‡LTSç‰ˆæœ¬ï¼Œç„¶å¾Œé¸æ“‡ä¸‹è¼‰å®‰è£ç¨‹å¼ï¼Œæˆ‘è‡ªå·±æ˜¯ç”¨Windowsä½œæ¥­ç³»çµ±ï¼Œç›´æ¥é»æ“ŠWindows iconå°±é–‹å§‹ä¸‹è¼‰äº†ï¼Œä¸‹è¼‰å¥½å¾Œæ‰“é–‹å®‰è£ç¨‹å¼ä¸€è·¯ç¢ºèªåˆ°æœ€å¾Œå°±å®‰è£å¥½å•¦ï½å®‰è£å®Œæˆå¾Œå¯ä»¥ç”¨ <code>npm --version</code> ä¾†ç¢ºèªæ˜¯å¦å®‰è£æˆåŠŸã€‚<br />
<img src="/images/2023/03/14/nodejs.png" alt="Node.js" /></p>
</blockquote>
<ul>
<li>å®‰è£ git<br />
å®˜æ–¹è¼‰é»ï¼š<a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a></li>
</ul>
<blockquote>
<p>é¸æ“‡å°æ‡‰çš„ä½œæ¥­ç³»çµ±ç›´æ¥ä¸‹è¼‰å°±å¥½ï½é€™è£¡ä¸€æ¨£ä»¥Windowsç‚ºä¾‹ï¼Œé¸æ“‡çš„æ˜¯Standalone Installerä¸‹çš„64-bit Git for Windows Setupï¼Œä¸‹è¼‰å¥½å¾Œæ‰“é–‹å®‰è£ç¨‹å¼ä¸€è·¯ç¢ºèªåˆ°æœ€å¾Œå°±å®‰è£å¥½å•¦ï½å®‰è£å®Œæˆå¾Œå¯ä»¥ç”¨ <code>git --version</code> ä¾†ç¢ºèªæ˜¯å¦å®‰è£æˆåŠŸã€‚<br />
<img src="/images/2023/03/14/git.png" alt="git" /></p>
</blockquote>
<ul>
<li>è¨»å†ŠGitHubå¸³è™Ÿ<br />
å®˜ç¶²é€£çµï¼š<a href="https://github.com/">https://github.com/</a></li>
</ul>
<h1 id="å®‰è£-hexo"><a class="markdownIt-Anchor" href="#å®‰è£-hexo"></a> å®‰è£ Hexo</h1>
<ul>
<li>å®‰è£ Hexo</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆå§‹åŒ–è³‡æ–™å¤¾ï¼Œä¸¦å°‡ç•¶å‰è·¯å¾‘ç§»å‹•åˆ°è©²è³‡æ–™å¤¾ä¸‹(blog æ˜¯è³‡æ–™å¤¾åç¨±ï¼Œå¯ä»¥æ”¹æˆè‡ªå·±å–œæ­¡çš„åå­—)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo init blog</span><br><span class="line">cd blog</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸‹è¼‰ Hexo æ‰€éœ€å¥—ä»¶</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>
<p>åšå®Œä¸Šé¢é€™äº›æ­¥é©Ÿå¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥å•Ÿå‹•ä¼ºæœå™¨ä¾†çœ‹çœ‹ç›®å‰éƒ¨è½æ ¼çš„æ¨£å­å›‰ã€‚</p>
<ul>
<li>å•Ÿå‹•ä¼ºæœå™¨</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo server #or</span><br><span class="line">hexo s      </span><br></pre></td></tr></table></figure>
<blockquote>
<p>é è¨­ä¸»é¡Œæ˜¯landscapeï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä¸»é¡Œï¼Œä¸‹ä¸€ç¯‡æ–‡ç« æœƒæ•™å¤§å®¶å¦‚ä½•å¥—ç”¨Hexoä¸Šçš„ç†±é–€ä¸»é¡ŒnexTï¼<br />
<img src="/images/2023/03/14/landscape.png" alt="landscape" /></p>
</blockquote>
<h1 id="hexo-æ¶æ§‹"><a class="markdownIt-Anchor" href="#hexo-æ¶æ§‹"></a> Hexo æ¶æ§‹</h1>
<p>åœ¨é–‹å§‹åŠ å·¥æˆ‘å€‘çš„ç¶²ç«™ä¹‹å‰ï¼Œå…ˆä¾†èªè­˜ä¸€ä¸‹Hexoçš„è³‡æ–™å¤¾æ¶æ§‹ï¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">|</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ scaffolds</span><br><span class="line">|   â”œâ”€â”€ draft</span><br><span class="line">|   â”œâ”€â”€ page</span><br><span class="line">|   â””â”€â”€ post</span><br><span class="line">â”œâ”€â”€ source</span><br><span class="line">|   â”œâ”€â”€ _drafts</span><br><span class="line">|   â””â”€â”€ _posts</span><br><span class="line">â”œâ”€â”€ themes</span><br><span class="line">|   â””â”€â”€ yourTheme</span><br><span class="line">|       â””â”€â”€ _config.yml</span><br><span class="line">â””â”€â”€ _config.yml</span><br></pre></td></tr></table></figure>
<ul>
<li>package.json<br />
ç”¨ä¾†å­˜æ”¾node.jsçš„å„ç¨®å¥—ä»¶ï¼Œä¸€ç­æƒ…æ³ä¸‹ä¸å¤ªéœ€è¦å‹•åˆ°é€™å€‹è³‡æ–™å¤¾ã€‚</li>
<li>scaffolds<br />
é·¹æ¶è³‡æ–™å¤¾ï¼Œè£¡é¢æœ‰ä¸‰å€‹æª”æ¡ˆdraftã€pageèˆ‡postï¼Œåˆ†åˆ¥å°æ‡‰äº†æˆ‘å€‘èƒ½å»ºç«‹çš„ä¸‰ç¨®ä½ˆå±€ï¼ŒHexoæœƒä¾æ“šé€™äº›ä½ˆå±€ä¾†ç”Ÿæˆæ–°çš„é é¢ã€‚</li>
<li>source<br />
ä¾†æºè³‡æ–™å¤¾ï¼Œç”¨ä¾†å­˜æ”¾æ–‡ç« ã€é é¢ä»¥åŠåœ–ç‰‡ç­‰å…§å®¹ï¼Œå…¶ä¸­_draftsç”¨ä¾†å­˜æ”¾è‰ç¨¿ï¼Œ_postsç”¨ä¾†å­˜æ”¾å·²ç¶“ç™¼å¸ƒçš„æ–‡ç« ã€‚</li>
<li>themes<br />
ä¸»é¡Œè³‡æ–™å¤¾ï¼Œå¯ä»¥ä¸‹è¼‰è‡ªå·±å–œæ­¡çš„ä¸»é¡Œæ”¾åˆ°è£¡é¢ï¼Œåœ¨æ¯å€‹ä¸»é¡Œåº•ä¸‹æœƒæœ‰ä¸€å€‹èˆ‡ä¸»é¡Œè¨­å®šæª”ï¼Œèˆ‡ä¸»é¡Œæœ‰é—œçš„æ±è¥¿éƒ½åœ¨é‚£è£¡é€²è¡Œè¨­å®šã€‚</li>
<li>_config.yml<br />
ç¶²é è¨­å®šæª”ï¼Œèˆ‡ç¶²é æœ‰é—œçš„æ±è¥¿éƒ½åœ¨é€™è£¡é€²è¡Œè¨­å®šã€‚ (è·Ÿä¸»é¡Œè¨­å®šæª”ä¸ä¸€æ¨£ï¼)</li>
</ul>
<h1 id="config-è¨­ç½®"><a class="markdownIt-Anchor" href="#config-è¨­ç½®"></a> Config è¨­ç½®</h1>
<p>é€²åˆ°_config.ymlæª”æ¡ˆä¸­ï¼Œå°Siteéƒ¨åˆ†é€²è¡Œä¿®æ”¹ï¼Œå¯ä»¥åƒè€ƒä¸‹é¢çš„è¨­ç½®ï¼š</p>
<blockquote>
<p>subtitleè·Ÿdescriptionå¯å¯«å¯ä¸å¯«<br />
languageé è¨­æ˜¯è‹±æ–‡ï¼Œå¯ä»¥æ”¹æˆzh-TWé¡¯ç¤ºç¹é«”ä¸­æ–‡<br />
keywordè·ŸGoogleé—œéµå­—æœå°‹æœ‰é—œï¼Œé€™è£¡å…ˆå¿½ç•¥ä¸ç®¡ä»–ï¼Œæœªä¾†æœ‰æ©Ÿæœƒå†ä¾†è©³ç´°ä»‹ç´¹ï¼<br />
<img src="/images/2023/03/14/config_site.png" alt="config_site" /></p>
</blockquote>
<h1 id="æ’°å¯«æ–‡ç« æ–°å¢é é¢"><a class="markdownIt-Anchor" href="#æ’°å¯«æ–‡ç« æ–°å¢é é¢"></a> æ’°å¯«æ–‡ç« /æ–°å¢é é¢</h1>
<p>åœ¨Hexoç•¶ä¸­å…±æœ‰ä¸‰ç¨®ä½ˆå±€ï¼Œåˆ†åˆ¥æ˜¯draftã€postèˆ‡pageï¼Œå…¶ä¸­draftè·Ÿpageå±¬æ–¼æ–‡ç« ï¼Œpageå‰‡å±¬æ–¼é é¢ã€‚</p>
<ul>
<li>post<br />
æ‰€æœ‰draftéƒ½æœƒè¢«å­˜æ”¾åœ¨_postsè³‡æ–™å¤¾ç•¶ä¸­ï¼Œæœƒå‡ºç¾åœ¨ç¶²é ä¸Šã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># post å¯ä»¥çœç•¥</span><br><span class="line">hexo new post &quot;My Post&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>draft<br />
draftæ˜¯è‰ç¨¿ï¼Œæœƒå¦å¤–å¾æ”¾æ–¼_draftsè³‡æ–™å¤¾ä¸‹ï¼Œä¸”ä¸æœƒå‡ºç¾åœ¨ç¶²é ä¸Šã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new draft &quot;My Draft&quot;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç”¨æŒ‡ä»¤å°‡draftè½‰æˆpostï¼ŒåŸç†åªæ˜¯æ›å€‹è³‡æ–™å¤¾è€Œå·²ï¼Œå…¶å¯¦ä¹Ÿå¯ä»¥æ‰‹å‹•ä½œï¼Œåéä¾†æ‰‹å‹•æŠŠpostä¸Ÿåˆ°draftä¹Ÿè¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo publish &quot;My Draft&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>page<br />
pageæ˜¯åŠŸèƒ½é é¢ï¼Œå¸¸è¦‹çš„æœ‰aboutã€tagsã€categoriesç­‰ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« å°±æœƒä»‹ç´¹å¦‚ä½•åœ¨nexTä¸»é¡Œä¸‹å»ºç«‹å°æ‡‰çš„pageï¼</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new page &quot;My Page&quot;</span><br></pre></td></tr></table></figure>
<h1 id="ç”Ÿæˆéœæ…‹æ–‡ä»¶"><a class="markdownIt-Anchor" href="#ç”Ÿæˆéœæ…‹æ–‡ä»¶"></a> ç”Ÿæˆéœæ…‹æ–‡ä»¶</h1>
<p>æ¯æ¬¡ä¿®æ”¹configæª”æˆ–æ˜¯å¯«å®Œæ–‡ç« å¾Œï¼Œè¨˜å¾—ä¸è¦å¿˜è¨˜é‡æ–°ç”Ÿæˆä¸€æ¬¡ç¶²é çš„éœæ…‹æ–‡ä»¶ï¼Œä¸ç„¶å‰›å‰›åšçš„è®Šå‹•ç¶²é ä¸Šæ˜¯ä¸æœƒå‘ˆç¾å‡ºä¾†çš„å–”ï¼</p>
<ul>
<li>æ¸…ç©ºåŸæœ¬çš„éœæ…‹æ–‡ä»¶/æš«å­˜<br />
é€™å€‹æ­¥é©Ÿç›¸ç•¶é‡è¦ï¼å¦å‰‡å®¹æ˜“å‡ºç¾æ–°åŠ çš„æ±è¥¿æ›´æ–°ä¸ä¸Šå»çš„æƒ…æ³ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clear #or</span><br><span class="line">hexo cl</span><br></pre></td></tr></table></figure>
<ul>
<li>ç”Ÿæˆéœæ…‹æ–‡ä»¶</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo generate #or</span><br><span class="line">hexo g</span><br></pre></td></tr></table></figure>
<ul>
<li>åšå®Œè¨˜å¾—æ‰“é–‹serverç¢ºèªä¸€ä¸‹çµæœï¼</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo server #or</span><br><span class="line">hexo s </span><br></pre></td></tr></table></figure>
<p>é€™ä¸‰å€‹æŒ‡ä»¤<br />
éå¸¸é‡è¦ï¼ï¼ï¼<br />
éå¸¸é‡è¦ï¼ï¼ï¼<br />
éå¸¸é‡è¦ï¼ï¼ï¼<br />
ç°¡å–®ä¾†èªªæœ‰å‹•åˆ°æ±è¥¿è«‹åŸ·è¡Œä¸€ä¸‹å°±å°äº†ï¼</p>
<h1 id="éƒ¨ç½²è‡³-github-pages"><a class="markdownIt-Anchor" href="#éƒ¨ç½²è‡³-github-pages"></a> éƒ¨ç½²è‡³ GitHub Pages</h1>
<ol>
<li>
<p>åœ¨GitHubä¸­å‰µå»ºä¸€å€‹æ–°çš„repository (é»å³ä¸Šè§’åŠ è™Ÿ)<br />
<img src="/images/2023/03/14/repository.png" alt="repository" /></p>
</li>
<li>
<p>repositoryåç¨±å–ç‚º<code>user_name.github.io</code>ï¼Œç„¶å¾Œç›´æ¥create repository<br />
<img src="/images/2023/03/14/repository_create.png" alt="repository_create" /></p>
</li>
<li>
<p>ä¿®æ”¹ç¶²é _config.ymlä¸­çš„URLè¨­ç½®</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url: https://user_name.github.io/</span><br><span class="line">root: /</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é€™è£¡çš„urlæ˜¯GitHub Pagesçš„ç¶²å€<br />
rootè¨­æˆ /<br />
<img src="/images/2023/03/14/config_url.png" alt="config_url" /></p>
</blockquote>
<ol start="4">
<li>ä¿®æ”¹ç¶²é _config.ymlä¸­çš„deployè¨­ç½®</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https://github.com/user_name/user_name.github.io.git</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é€™è£¡é¸æ“‡ç”¨HTTPSçš„æ–¹å¼é€£çµï¼Œéƒ¨ç½²æ™‚ç›´æ¥è¼¸å…¥å¸³è™Ÿå¯†ç¢¼å°±è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨SSHï¼Œä¸éå°±è¦è¨­ç½®é‡‘é‘°ï¼Œæ¯”è¼ƒéº»ç…©ä¸€äº›<br />
<img src="/images/2023/03/14/config_deploy.png" alt="config_deploy" /></p>
</blockquote>
<ol start="5">
<li>ä¿®æ”¹å®Œå¾Œè¨˜å¾—é‡æ–°ç”Ÿæˆä¸€æ¬¡éœæ…‹æ–‡ä»¶</li>
<li>é–‹å§‹éƒ¨ç½²</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo deploy #or</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>æ‰“é–‹GitHub Pagesçš„ç¶²å€å°±èƒ½çœ‹åˆ°æˆ‘å€‘å‰›å‰›éƒ¨ç½²ä¸Šå»çš„ç¶²é å•¦ï¼<br />
<img src="/images/2023/03/14/gitpage.png" alt="Alt text" /></li>
</ol>
<h1 id="é å‘Š"><a class="markdownIt-Anchor" href="#é å‘Š"></a> é å‘Š</h1>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘å°‡æœƒä»‹ç´¹å¦‚ä½•å¥—ç”¨nexTä¸»é¡Œï¼Œé™¤äº†è¬›è§£å¤–è§€è¨­å®šä»¥å¤–ï¼Œä¹Ÿå°‡å¸¶è‘—å¤§å®¶æ‰“é€ æ¨™ç±¤é åŠç«™å…§æœå°‹ç­‰åŠŸèƒ½ï¼</p>
]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello Hexoï¼å¥—ç”¨ NexT ä¸»é¡Œæ‰“é€ ç°¡æ½”é é¢ï¼(2)</title>
    <url>/posts/Blog/2023/Hello-Hexo-2/</url>
    <content><![CDATA[<h1 id="next-ä»‹ç´¹"><a class="markdownIt-Anchor" href="#next-ä»‹ç´¹"></a> NexT ä»‹ç´¹</h1>
<p>NexTæ˜¯ä¸€å€‹ç›¸ç•¶å—æ­¡è¿çš„Hexoä¸»é¡Œï¼Œå¤–è§€ç°¡æ½”ã€åŠŸèƒ½å¼·å¤§ï¼Œä¸”æŒçºŒæœ‰åœ¨ç¶­è­·ï¼Œä»Šå¤©æœƒæ•™å¤§å®¶å¦‚ä½•å¥—ç”¨NexTä¸»é¡Œï¼Œä¸¦å•Ÿç”¨æ¨™ç±¤é åŠç«™å…§æœå°‹ç­‰åŠŸèƒ½ã€‚<br />
NexT å®˜ç¶²ï¼š<a href="https://theme-next.js.org/">https://theme-next.js.org/</a><br />
NexT GitHubï¼š<a href="https://github.com/next-theme/hexo-theme-next">https://github.com/next-theme/hexo-theme-next</a></p>
<span id="more"></span>
<h1 id="å®‰è£-next"><a class="markdownIt-Anchor" href="#å®‰è£-next"></a> å®‰è£ NexT</h1>
<p>æœ‰å…©å€‹æ–¹æ³•ï¼Œç¬¬ä¸€å€‹æ–¹æ³•æ˜¯é€énpm</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-theme-next</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒå€‹æ–¹æ³•æ˜¯é€égit</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/next-theme/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>
<p>æˆ‘å€‹äººæ˜¯å–œæ­¡ç¬¬äºŒç¨®æ–¹æ³•(git)ï¼Œå› ç‚ºè³‡æºç‚ºè‡ªå‹•é€²åˆ°themesè³‡æ–™å¤¾ç•¶ä¸­ï¼Œå¦‚æœä½¿ç”¨ç¬¬äºŒç¨®æ–¹æ³•(npm)çš„è©±è³‡æºæœƒè·‘åˆ°node_modulesè³‡æ–™å¤¾ä¸­ï¼Œé›–ç„¶åœ¨åŠŸèƒ½ä¸Šä¸æœƒæœ‰å·®ç•°ï¼Œä½†æœªä¾†è¦å°ä¸»é¡Œçš„configæª”åšèª¿æ•´æ™‚è¦æ‰¾æ¯”è¼ƒä¹…ã€‚</p>
<h1 id="å¥—ç”¨ä¸»é¡Œ"><a class="markdownIt-Anchor" href="#å¥—ç”¨ä¸»é¡Œ"></a> å¥—ç”¨ä¸»é¡Œ</h1>
<p>åˆ°<strong>ç¶²é </strong>çš„configæª”(<code>/_config.yml</code>)ï¼Œæœå°‹<strong>theme</strong>å°‡ä¸»é¡Œè¨­ç½®æˆnextå°±è¡Œäº†ã€‚<br />
<img src="/images/2023/03/15/config_theme.png" alt="config_theme" /></p>
<p>å¦å¤–Nextå…¶å¯¦æœ‰æä¾›4ç¨®ç‰ˆé¢å¯ä»¥åšé¸æ“‡ï¼Œåˆ†åˆ¥æ˜¯ï¼šğŸ’Ÿ <a href="https://theme-next.js.org/muse/">Muse</a> | ğŸ”¯ <a href="https://theme-next.js.org/mist/">Mist</a> | â™“ï¸ <a href="https://theme-next.js.org/pisces/">Pisces</a> | â™Šï¸ <a href="https://theme-next.js.org/">Gemini</a></p>
<p>å¤§å®¶å¯ä»¥é»æ“Šé€£çµçœ‹çœ‹è‡ªå·±å–œæ­¡å“ªç¨®ç‰ˆé¢ï¼Œé è¨­æ˜¯ä½¿ç”¨Museï¼Œå¦‚æœè¦åšæ›´æ”¹çš„è©±ï¼Œåˆ°<strong>ä¸»é¡Œ</strong>çš„configæª”(<code>themes/next/_config.yml</code>)ä¸­æœå°‹<strong>Schemes</strong>ï¼Œå°‡å–œæ­¡çš„ä½ˆå±€å–æ¶ˆè¨»è§£å°±å¯ä»¥äº†ï¼Œå¦å¤–ä¸‹é¢çš„<strong>darkmode</strong>æ”¹æˆtrueçš„è©±å‰‡æ˜¯å¯ä»¥è®“ç¶²é è®Šæˆé»‘è‰²æ¨¡å¼ã€‚<br />
<img src="/images/2023/03/15/next_schemes.png" alt="next_schemes" /></p>
<p>NexTä¹Ÿæ”¯æ´canvasèƒŒæ™¯å‹•ç•«ï¼Œæˆ‘å€‘å¯ä»¥åœ¨<strong>ä¸»é¡Œ</strong>configæª”æœå°‹<strong>canvas_ribbon</strong>ï¼Œå°‡ä¸‹æ–¹çš„enableæ”¹ç‚ºtrueï¼Œéƒ¨å±¬å¾Œç¶²é èƒŒæ™¯å°±æœƒå‡ºç¾é…·ç‚«çš„å½©è‰²çµ²å¸¶å‹•ç•«äº†ï½</p>
<h1 id="æ·»åŠ é ­åƒ-avatar"><a class="markdownIt-Anchor" href="#æ·»åŠ é ­åƒ-avatar"></a> æ·»åŠ é ­åƒ avatar</h1>
<ol>
<li>æŠŠæº–å‚™å¥½çš„åœ–ç‰‡æ”¾å…¥<code>themes/next/source/images</code>æˆ–<code>source/images</code>ç•¶ä¸­ã€‚</li>
<li>åœ¨<strong>ä¸»é¡Œ</strong>configæª”æœå°‹<strong>avatar</strong>ï¼Œä¿®æ”¹æˆè‡ªå·±æº–å‚™çš„åœ–ç‰‡è·¯å¾‘æˆ–è€…ä¿®æ”¹åœ–ç‰‡åç¨±ä½¿å…¶ä¸€è‡´ã€‚</li>
</ol>
<blockquote>
<p>roundedæ”¹æˆtrueçš„è©±é ­åƒæœƒæ˜¯åœ“å½¢ï¼Œrotatedæ”¹æˆtrueçš„è©±æ»‘é¼ ç§»åˆ°é ­åƒä¸Šæ™‚æœƒæœ‰å¿«é€Ÿæ—‹è½‰çš„å‹•ç•«ã€‚<br />
<img src="/images/2023/03/15/next_avatar.png" alt="next_avatar" /></p>
</blockquote>
<h1 id="æ›´æ”¹ç¶²ç«™åœ–ç¤º-favicon"><a class="markdownIt-Anchor" href="#æ›´æ”¹ç¶²ç«™åœ–ç¤º-favicon"></a> æ›´æ”¹ç¶²ç«™åœ–ç¤º favicon</h1>
<p>æˆ‘å€‘å¯ä»¥æŠŠç¶²ç«™åœ–ç¤ºæ›æˆè‡ªå·±çš„åœ–ç‰‡ï¼Œå®˜æ–¹æ–‡ä»¶ä¸­å»ºè­°å¯ä»¥ä½¿ç”¨<a href="https://realfavicongenerator.net/">Favicon Generator</a>ä¾†ç”Ÿæˆå®¢è£½åŒ–çš„ç¶²ç«™åœ–ç¤ºã€‚</p>
<ol>
<li>æŠŠæº–å‚™å¥½çš„åœ–ç‰‡æ”¾å…¥<code>themes/next/source/images</code>æˆ–<code>source/images</code>ç•¶ä¸­ã€‚</li>
<li>åœ¨<strong>ä¸»é¡Œ</strong>configæª”æœå°‹<strong>favicon</strong>ï¼Œä¿®æ”¹æˆè‡ªå·±æº–å‚™çš„åœ–ç‰‡è·¯å¾‘æˆ–è€…ä¿®æ”¹åœ–ç‰‡åç¨±ä½¿å…¶ä¸€è‡´ã€‚<br />
<img src="/images/2023/03/15/next_favicon.png" alt="next_favicon" /></li>
</ol>
<h1 id="ç¤¾ç¾¤åª’é«”é€£çµ-social-link"><a class="markdownIt-Anchor" href="#ç¤¾ç¾¤åª’é«”é€£çµ-social-link"></a> ç¤¾ç¾¤åª’é«”é€£çµ social link</h1>
<p>åœ¨<strong>ä¸»é¡Œ</strong>configæª”æœå°‹<strong>social</strong>ï¼Œå°‡è‡ªå·±çš„ç¤¾ç¾¤åª’é«”é€£çµå¡«å…¥ä¸¦å–æ¶ˆè¨»è§£å°±å¯ä»¥äº†ï¼Œä¸‹æ–¹çš„social_iconå‰‡å¯ä»¥è¨­å®šæ˜¯å¦é¡¯ç¤ºiconåŠiconå¤–è§€ã€‚<br />
<img src="/images/2023/03/15/next_social.png" alt="next_social" /></p>
<p>Hexo NexTä½¿ç”¨<a href="https://fontawesome.com/icons">Font Awesome</a>æä¾›çš„iconsï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥ç‚ºæ–°çš„é€£çµæŒ‘é¸é©åˆçš„iconï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘ä¾†æ–°å¢ä¸€å€‹Linkediné€£çµçœ‹çœ‹(åŒ…å«icon)ã€‚</p>
<ol>
<li>å…ˆåˆ°Font Awesomeä¸Šæœå°‹Linkedinï¼Œé¸æ“‡è‡ªå·±å–œæ­¡çš„iconï¼Œè¤‡è£½ç¶ è‰²çš„é‚£æ®µæ–‡å­—ã€‚<br />
<img src="/images/2023/03/15/font_awesome_linkedin.png" alt="font_awesome_linkedin" /></li>
<li>ä¾<code>æ¨™é¡Œ: é€£çµ || ç¶ è‰²æ–‡å­—</code>çš„æ ¼å¼åœ¨socialä¸‹åŠ å…¥æ–°çš„ä¸€è¡Œï¼Œèˆ‰ä¾‹ä¾†èªªã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Linkedin: https://www.linkedin.com/in/meng-chieh-liu-615952235/ || fa-brands fa-linkedin</span><br></pre></td></tr></table></figure>
<h1 id="å•Ÿç”¨åŠŸèƒ½é¸å–®-menu"><a class="markdownIt-Anchor" href="#å•Ÿç”¨åŠŸèƒ½é¸å–®-menu"></a> å•Ÿç”¨åŠŸèƒ½é¸å–® Menu</h1>
<p>åœ¨<strong>ä¸»é¡Œ</strong>configæª”æœå°‹<strong>menu</strong>ï¼Œå¯ä»¥çœ‹åˆ°NexTé å…ˆå¹«æˆ‘å€‘å»ºç«‹å¥½è¨±å¤šåŠŸèƒ½é¸å–®ï¼Œå…¶ä¸­homeè·Ÿarchivesæ˜¯é è¨­å°±é–‹å•Ÿçš„ï¼Œæˆ‘å€‘å¯ä»¥å–æ¶ˆè¨»è§£ä¾†å•Ÿç”¨å…¶ä»–åŠŸèƒ½é¸å–®ï¼Œä½†ç›®å‰é‚£äº›é é¢é‚„æ˜¯ç©ºçš„å–”ï¼æ‰€ä»¥æˆ‘å€‘çš„ä¸‹ä¸€æ­¥å°±æ˜¯è¦å»ºç«‹ç›¸æ‡‰çš„åˆ†é ã€‚<br />
<img src="/images/2023/03/15/next_menu.png" alt="next_menu" /></p>
<p>é€™é‚Šä»‹ç´¹å¦‚ä½•å»ºç«‹tags/categoriesé é¢ï¼š</p>
<ol>
<li>å»ºç«‹æ–°é é¢</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new page &quot;tags&quot;</span><br><span class="line">hexo new page &quot;categories&quot;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>
<p>æ‰¾åˆ°<code>source/tags/index.md</code>æª”æ¡ˆï¼Œåœ¨æª”æ¡ˆä¸­åŠ å…¥<code>type: &quot;tags&quot;</code>ï¼Œæ³¨æ„é€™è£¡çš„tagsè¦åŠ <strong>é›™å¼•è™Ÿ</strong>ï¼ï¼ï¼<br />
(categoriesæ¯”ç…§è¾¦ç†)<br />
<img src="/images/2023/03/15/tags.png" alt="tags" /></p>
</li>
<li>
<p>åœ¨postè£¡é¢åŠ å…¥tags/categoriesï¼Œé‡æ–°éƒ¨ç½²å¾Œé€™äº›tags/categorieså°±æœƒå‡ºç¾å°æ‡‰çš„é é¢ä¸Šå•¦ï½<br />
<img src="/images/2023/03/15/post_tags.png" alt="post_tags" /></p>
</li>
</ol>
<h1 id="ç«™å…§æœå°‹åŠŸèƒ½-local-search"><a class="markdownIt-Anchor" href="#ç«™å…§æœå°‹åŠŸèƒ½-local-search"></a> ç«™å…§æœå°‹åŠŸèƒ½ local search</h1>
<ol>
<li>å®‰è£<code>hexo-generator-searchdb</code>å¥—ä»¶</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>
<p>åœ¨<strong>ä¸»é¡Œ</strong>configæª”æœå°‹<strong>local_search</strong>ï¼Œå°‡enableèª¿ç‚ºtrueã€‚<br />
<img src="/images/2023/03/15/next_local_search.png" alt="next_local_search" /></p>
</li>
<li>
<p>åœ¨<strong>ç¶²é </strong>configæª”åŠ å…¥ä¸‹é¢è¨­ç½®ã€‚</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  limit: 10000</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>é‡æ–°éƒ¨ç½²å¾Œå°±èƒ½é–‹å§‹ä½¿ç”¨ç«™å…§æœå°‹å•¦ï½<br />
<img src="/images/2023/03/15/local_search.png" alt="local_search" /></li>
</ol>
<h1 id="é å‘Š"><a class="markdownIt-Anchor" href="#é å‘Š"></a> é å‘Š</h1>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« å°‡æœƒå¸¶å¤§å®¶åšSEOï¼Œè¨­å®škeywordsèˆ‡sitemapè®“Googleæœçš„åˆ°æˆ‘å€‘çš„éƒ¨è½æ ¼/æ–‡ç« ã€‚</p>
]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello Hexoï¼ç°¡å–®ä¸‰æ­¥é©Ÿæå®š Google SEO å’Œ Bing SEOï¼(3)</title>
    <url>/posts/Blog/2023/Hello-Hexo-3/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p><img src="/images/2023/04/11/google_bing.png" alt="google and bing logo" /></p>
<p>å¥½ä¸å®¹æ˜“æ¶è¨­å¥½Hexoç¶²ç«™ï¼Œä¸‹ä¸€å€‹å•é¡Œå°±æ˜¯å¦‚ä½•è®“è‡ªå·±å¯«çš„æ–‡ç« è¢«å…¶ä»–äººçœ‹è¦‹ï¼Œå¤§å®¶å¯ä»¥åœ¨Googleæœå°‹ä¸­è¼¸å…¥<code>site: ä½ çš„ç¶²ç«™url</code>ï¼Œçœ‹çœ‹Googleèƒ½ä¸èƒ½æ‰¾åˆ°ä½ çš„ç¶²ç«™ï¼Œæ²’æ„å¤–çš„è©±Googleæ‡‰è©²é‚„æ‰¾ä¸åˆ°ä½ çš„ç¶²ç«™ï¼Œæ›åšæ˜¯Bingä¹Ÿä¸€æ¨£ï¼ŒåŸå› æ˜¯é€™äº›æœå°‹å¼•æ“é‚„ä¸èªè­˜æˆ‘å€‘çš„ç¶²ç«™ï¼Œæœ¬ç¯‡æ–‡ç« æœƒå¸¶å¤§å®¶ä½¿ç”¨Google Search Consoleä»¥åŠBing Webmasterä¾†é€²è¡ŒSEOã€‚<br />
(ps. ç¶²è·¯ä¸Šå·²ç¶“æœ‰å¾ˆå¤šæ–‡ç« ä»‹ç´¹Hexoçš„Google SEOï¼Œä½†åœ¨Bingèˆ‡ChatGPTåˆä½œå¾Œï¼Œæœå°‹é‡æœ‰äº†æ˜é¡¯çš„æå‡ï¼Œå› æ­¤é€™ç¯‡æ–‡ç« é™¤äº†ä»‹ç´¹Google SEOå¤–ï¼Œä¹Ÿæœƒä»‹ç´¹Bing SEO)</p>
<span id="more"></span>
<h1 id="sitemap"><a class="markdownIt-Anchor" href="#sitemap"></a> Sitemap</h1>
<p>Sitemapå°±æ˜¯ç¶²ç«™çš„åœ°åœ–ï¼Œæœå°‹å¼•æ“æœƒé€éSitemapä¾†èªè­˜æˆ‘å€‘çš„ç¶²ç«™æ¶æ§‹ï¼Œæˆ‘å€‘å¯ä»¥é€éä¸‹é¢æŒ‡ä»¤å®‰è£hexoçš„sitemapå¥—ä»¶ï¼Œä¹‹å¾Œhexoæ¯æ¬¡generateéƒ½æœƒè‡ªå‹•æ›¿æˆ‘å€‘ç”Ÿæˆsitemapã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-sitemap</span><br></pre></td></tr></table></figure>
<h1 id="google-seo"><a class="markdownIt-Anchor" href="#google-seo"></a> Google SEO</h1>
<p>æˆ‘å€‘è¦åœ¨<a href="https://search.google.com/search-console/about">Google Search Console</a>ä¾†è¨­å®šGoogleçš„SEOï¼Œ</p>
<h2 id="step-1"><a class="markdownIt-Anchor" href="#step-1"></a> Step 1</h2>
<p>æˆ‘å€‘é¦–å…ˆè¦é©—è­‰æˆ‘å€‘çš„ç¶²é ï¼Œé¸æ“‡<strong>ç¶²ç«™å‰ç½®å­—å…ƒ</strong>ï¼Œå°‡ä½ çš„ç¶²ç«™urlè¤‡è£½ä¸Šå»(èˆ‰ä¾‹:<code>https://MengChiehLiu.github.io/</code>)ã€‚<br />
<img src="/images/2023/04/11/google_search_console.png" alt="google search console - resource type" /></p>
<h2 id="step-2"><a class="markdownIt-Anchor" href="#step-2"></a> Step 2</h2>
<p>æˆ‘å€‘ä½¿ç”¨å»ºè­°çš„é©—è­‰æ–¹å¼ï¼Œå°‡htmlæª”æ¡ˆä¸‹è¼‰ä¸‹ä¾†ï¼Œæ”¾åˆ°<code>/source</code>è·¯å¾‘ä¸‹ï¼Œæˆ‘å€‘è¦å°‡æª”æ¡ˆå…§å®¹æ”¹æˆä¸‹é¢é€™æ¨£:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åŠ ä¸Šé€™æ®µ --&gt;</span></span><br><span class="line">---</span><br><span class="line">layout: false</span><br><span class="line">---</span><br><span class="line"><span class="comment">&lt;!-- åŸæœ¬çš„ --&gt;</span></span><br><span class="line">google-site-verification: googled0a70fa73d09cd65.html</span><br></pre></td></tr></table></figure>
<p>é‡æ–°éƒ¨ç½²ç¶²é å¾Œ(é€™å¾ˆé‡è¦!)å°±å¯ä»¥å›åˆ°Google Search ConsoleæŒ‰ä¸‹é©—è­‰ã€‚<br />
<img src="/images/2023/04/11/google_search_console_2.png" alt="google search console - html verification" /></p>
<h2 id="step-3"><a class="markdownIt-Anchor" href="#step-3"></a> Step 3</h2>
<p>æˆ‘å€‘åˆ°Sitemapé é¢ä¸­å°‡åŠ å…¥<code>sitemap.xml</code>ï¼Œé€™æ¨£Googleæœå°‹å¼•æ“å°±æœƒå®šæœŸåˆ°æˆ‘å€‘çš„sitemapå»çœ‹æˆ‘å€‘çš„éƒ¨è½æ ¼æœ‰æ²’æœ‰æ›´æ–°äº†ã€‚<br />
<img src="/images/2023/04/11/google_search_console_3.png" alt="google search console - sitemap" /></p>
<h1 id="bing-seo"><a class="markdownIt-Anchor" href="#bing-seo"></a> Bing SEO</h1>
<p>æˆ‘å€‘è¦åœ¨<a href="https://www.bing.com/webmasters/about">Bing Webmaster</a>ä¾†è¨­å®šBingçš„SEOï¼ŒBingçš„SEOè¶…ç´šç°¡å–®ï¼Œç™»å…¥å¾Œç›´æ¥å¾Google Search ConsoleåŒ¯å…¥ç¶²ç«™è³‡è¨Šå°±å¥½ã€‚<br />
<img src="/images/2023/04/11/bing_webmaster.png" alt="bing webmaster" /></p>
<h1 id="çµèª"><a class="markdownIt-Anchor" href="#çµèª"></a> çµèª</h1>
<p>åšå®Œé€™äº›è¨­å®šå¾Œï¼ŒGoogleå’ŒBingæœƒéœ€è¦ä¸€äº›æ™‚é–“æŠŠæˆ‘å€‘çš„ç¶²ç«™ç´å…¥æœå°‹å¼•æ“ç•¶ä¸­ï¼Œé€™å€‹éç¨‹å¯èƒ½æœƒéœ€è¦1~2å¤©ã€‚<br />
ä¸Šé¢é€™äº›è¨­å®šåªæ˜¯è®“æœå°‹å¼•æ“æ‰¾çš„åˆ°æˆ‘å€‘çš„ç¶²ç«™ï¼Œå±¬æ–¼æœ€åŸºæœ¬çš„SEOï¼Œå…¶ä»–å¦‚é—œéµå­—ä»¥ã€ç¶²å€é•·åº¦ä¹Ÿæœƒå½±éŸ¿åˆ°ç¶²ç«™æ’åï¼Œä½†æœ€é‡è¦çš„é‚„æ˜¯æ–‡ç« çš„å“è³ªï¼Œæ‰€ä»¥åŠªåŠ›å¯«å‡ºå¥½æ–‡ç« ä¹Ÿæ˜¯SEOçš„é—œéµå–”ã€‚</p>
<blockquote>
<p>é—œéµå­—è¨­å®š<br />
å¯ä»¥ç›´æ¥å°‡<code>scaffolds/post.md</code>æ”¹æˆä¸‹é¢æ ¼å¼ï¼Œä¹‹å¾Œnew postçš„æ™‚å€™æœƒè‡ªå‹•å¥—ç”¨ä¸‹é¢æ ¼å¼ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">tags:</span><br><span class="line">    -</span><br><span class="line">    -</span><br><span class="line">categories: </span><br><span class="line">keywords:</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ™‚æ³¨æ„é—œéµå­—èˆ‡é—œéµå­—ä¹‹é–“ç”¨é€—è™Ÿåˆ†é–‹ä¸ç•™ç©ºæ ¼!ä¾‹å¦‚:</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">keywords: Hexo,SEO,Google,Bing,Google Search Console,Bing Webmaster</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç¶²å€é•·åº¦<br />
hexoé è¨­ä½¿ç”¨<code>å¹´/æœˆ/æ—¥/æª”æ¡ˆåç¨±</code>ä¾†ç•¶ä½œæ–‡ç« urlï¼Œæˆ‘å€‘å¯ä»¥ä¿®æ”¹<code>/_config.yml</code>ä¸­çš„<code>permalink</code>ä¾†è®“urlæ›´åŠ ç²¾ç°¡ï¼Œè©³ç´°è¦å‰‡å¯ä»¥åƒè€ƒ<a href="https://hexo.io/zh-tw/docs/permalinks.html">hexoå®˜æ–¹æ–‡æª”</a>ï¼Œæˆ‘è‡ªå·±æ˜¯æ”¹æˆä¸‹é¢é€™æ¨£:</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span> <span class="comment"># default</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:title/</span> <span class="comment"># shorter version</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>SEO</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello Hexoï¼åŠŸèƒ½å…¨éƒ¨é–‹èµ·ä¾†çœ‹èµ·ä¾†å°±å¾ˆå²å®³äº†å§ï¼ŸNexT å¸¸è¦‹è¨­å®šæ•´ç† (4)</title>
    <url>/posts/Blog/2023/Hello-Hexo-4/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p><img src="/images/2023/04/14/cover.png" alt="cover image" /></p>
<p>Nextä¹‹æ‰€ä»¥å—åˆ°æ­¡è¿ï¼Œä¸€å¤§åŸå› æ˜¯å› ç‚ºNexTå°‡å¾ˆå¤šå¸¸ç”¨çš„åŠŸèƒ½éƒ½æ•´åˆé€²å…¥ä¸»é¡Œç•¶ä¸­ï¼Œåªè¦ä¿®æ”¹ä¸€ä¸‹ä¸»é¡Œè¨­å®šæª”(config)ã€ä¸‹è¼‰ä¸€ä¸‹æ’ä»¶(plugins)ï¼Œå°±èƒ½å¯¦ç¾å¤§éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œä»Šå¤©å°±å¸¶å¤§å®¶çœ‹ä¸€äº›å¸¸è¦‹çš„åŠŸèƒ½åœ¨NexTä¸»é¡Œä¸‹è¦å¦‚ä½•å¯¦ç¾ã€‚</p>
<span id="more"></span>
<h1 id="å¤§ç¶±"><a class="markdownIt-Anchor" href="#å¤§ç¶±"></a> å¤§ç¶±</h1>
<ul>
<li><a href="#%E7%95%99%E8%A8%80%E6%9D%BF">ç•™è¨€æ¿</a></li>
<li><a href="#%E7%89%88%E6%AC%8A%E8%81%B2%E6%98%8E">ç‰ˆæ¬Šè²æ˜</a></li>
<li><a href="#%E9%96%B1%E8%AE%80%E9%80%B2%E5%BA%A6">é–±è®€é€²åº¦</a></li>
<li><a href="#%E5%9B%9E%E5%88%B0%E9%A0%82%E9%83%A8">å›åˆ°é ‚éƒ¨</a></li>
<li><a href="#%E8%A8%AA%E5%AE%A2%E7%B5%B1%E8%A8%88%E3%80%81%E6%96%87%E7%AB%A0%E9%96%B1%E8%AE%80%E7%B5%B1%E8%A8%88">è¨ªå®¢çµ±è¨ˆã€æ–‡ç« é–±è®€æ¬¡æ•¸</a></li>
<li><a href="#%E6%96%87%E7%AB%A0%E5%AD%97%E6%95%B8%E3%80%81%E9%96%B1%E8%AE%80%E6%99%82%E9%96%93">æ–‡ç« å­—æ•¸ã€é–±è®€æ™‚é–“</a></li>
</ul>
<h1 id="åŠŸèƒ½"><a class="markdownIt-Anchor" href="#åŠŸèƒ½"></a> åŠŸèƒ½</h1>
<h2 id="ç•™è¨€æ¿"><a class="markdownIt-Anchor" href="#ç•™è¨€æ¿"></a> ç•™è¨€æ¿</h2>
<p>ç•™è¨€æ¿æ˜¯ä¸€å€‹å¾ˆå¥‡å¦™çš„æ±è¥¿ï¼Œé›–ç„¶å¿ƒè£¡æƒ³åˆ°åº•æœ‰èª°æœƒä¾†ç•™è¨€ï¼Œä½†æ²’æœ‰çš„è©±åˆå¥½åƒå°‘äº†äº›ä»€éº¼ï¼Œæ‰€ä»¥å§‘ä¸”é‚„æ˜¯æ”¾ä¸€ä¸‹XDã€‚<br />
NexTæ”¯æ´å¤šç¨®ç•™è¨€ç‰ˆæ’ä»¶ï¼Œç¶²è·¯ä¸Šæ¨è–¦ä½¿ç”¨çš„æ˜¯disqusæˆ–utterances (gitalkå› ç‚ºæ¬Šé™è¦æ±‚éé«˜æ‰€ä»¥æ²’ä»€éº¼æ¨è–¦äº†)ï¼ŒäºŒé¸ä¸€çš„æƒ…æ³ä¸‹ï¼Œdisqusè¦å¦å¤–å»è¨»å†Šä¸€å€‹å¸³è™Ÿæœ‰é»éº»ç…©ï¼Œåè§€utteranceså¯ä»¥ç›´æ¥é€£çµgithub repositoryä¾†å„²å­˜è©•è«–ï¼Œä¸”å¤–è§€æ¯”è¼ƒç°¡æ½”ï¼Œæ‰€ä»¥æœ€å¾Œæ±ºå®šä½¿ç”¨utterancesã€‚</p>
<ol>
<li>
<p>åˆ°<a href="https://github.com/apps/utterances" title="{rel='nofollow'}">utterances app</a>æŠŠappå®‰è£åˆ°githubä¸Šï¼Œå°‡æ¬Šé™é–‹çµ¦æŒ‡å®šçš„å°ˆæ¡ˆrepositoryã€‚(æˆ‘æ˜¯ç›´æ¥è·Ÿéƒ¨è½æ ¼ä½¿ç”¨åŒä¸€å€‹ï¼Œç•¶ç„¶ä½ ä¹Ÿå¯ä»¥å¦å¤–é–‹ä¸€å€‹æ–°çš„repositoryã€‚)</p>
</li>
<li>
<p>æ‰¾åˆ°<code>next/_config.yml</code>ä¸­çš„<code>utterances</code>ï¼Œå°‡<code>enable</code>æ”¹æˆ<code>true</code>ï¼Œåœ¨<code>repo</code>å¡«å…¥å‰›å‰›é–‹å•Ÿæ¬Šé™çš„repositoryåç¨±ï¼Œèˆ‰ä¾‹ä¾†èªªæˆ‘æ˜¯å¡«<code>MengChiehLiu/MengChiehLiu.github.io</code>ï¼Œ<code>theme</code>åƒæ•¸å¯ä»¥è¨­å®šä¸åŒç•™è¨€æ¿é¢¨æ ¼ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è©¦è©¦çœ‹ã€‚</p>
</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">utterances:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">MengChiehLiu/MengChiehLiu.github.io</span></span><br><span class="line">  <span class="attr">issue_term:</span> <span class="string">pathname</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">github-light</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>æœ€å¾Œå¦‚æœä½ å¸Œæœ›ç•™è¨€æ¿åªå‡ºç¾åœ¨æ–‡ç« é é¢ï¼Œè€Œä¸è¦å‡ºç¾åœ¨å…¶ä»–page(ex: æ¨™ç±¤é ã€åˆ†é¡é )çš„è©±ï¼Œé‚£è¦åˆ°pageä¸‹çš„<code>index.md</code>ä¸‹ä¿®æ”¹æ¨™é ­æª”ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: </span><br><span class="line">date: </span><br><span class="line">type: </span><br><span class="line">&lt;!-- åŠ å…¥ä¸‹é¢é€™ä¸€è¡Œ --&gt;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<h2 id="ç‰ˆæ¬Šè²æ˜"><a class="markdownIt-Anchor" href="#ç‰ˆæ¬Šè²æ˜"></a> ç‰ˆæ¬Šè²æ˜</h2>
<p>æ‰¾åˆ°<code>next/_config.yml</code>ä¸­çš„<code>creative_commons</code>ï¼Œå°‡<code>post</code>æ”¹æˆ<code>true</code>å°±å¯ä»¥äº†ï¼Œå”è­°çš„ç‰ˆæœ¬å¯ä»¥åƒè€ƒ<a href="https://creativecommons.org/about/cclicenses/" title="{rel='nofollow'}">About CC Licenses</a>è‡ªå·±åšæŒ‘é¸ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="attr">size:</span> <span class="string">small</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">language:</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘è‡ªå·±è¦ºå¾—é è¨­çš„å…§å®¹å°±æŒºä¸éŒ¯çš„ï¼Œä¸éä¹Ÿå¯ä»¥è‡ªè¨‚å…§å®¹ï¼Œé€™é‚Šæä¾›ä¸€ç¯‡ä¸éŒ¯çš„æ–‡ç« çµ¦æœ‰èˆˆè¶£çš„äºº:</p>
<ul>
<li><a href="https://guiblogs.com/hexo30-21/" title="{rel='nofollow'}">Day 21ï¼šåœ¨ Hexo å¢åŠ ä½œè€…ç‰ˆæ¬Šè²æ˜ï¼ˆä½¿ç”¨ Next ä½ˆæ™¯ï¼‰</a></li>
</ul>
<h2 id="é–±è®€é€²åº¦"><a class="markdownIt-Anchor" href="#é–±è®€é€²åº¦"></a> é–±è®€é€²åº¦</h2>
<p>æ‰¾åˆ°<code>next/_config.yml</code>ä¸­çš„<code>reading_progress</code>ï¼Œå°‡<code>enable</code>æ”¹æˆ<code>true</code>ï¼Œé–‹å•Ÿå¾Œæœƒåœ¨ç¶²é é ‚éƒ¨/åº•éƒ¨é¡¯ç¤ºé–±è®€é€²åº¦æ¢ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reading_progress:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">start_at:</span> <span class="string">left</span>   <span class="comment"># left/rightï¼Œå¾å·¦æˆ–å³é–‹å§‹</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span>    <span class="comment"># top/bottomï¼Œé¡¯ç¤ºåœ¨ç¶²é é ‚éƒ¨æˆ–åº•éƒ¨</span></span><br><span class="line">  <span class="attr">reversed:</span> <span class="literal">false</span>  <span class="comment"># é–‹å•Ÿçš„è©±æœƒå¾å…¨æ»¿é–‹å§‹æ‰£</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#37c6c0&quot;</span> <span class="comment"># é¡è‰²</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">3px</span>      <span class="comment"># é€²åº¦æ¢å¯¬åº¦</span></span><br></pre></td></tr></table></figure>
<h2 id="å›åˆ°é ‚éƒ¨"><a class="markdownIt-Anchor" href="#å›åˆ°é ‚éƒ¨"></a> å›åˆ°é ‚éƒ¨</h2>
<p>å°±æ˜¯ç¶²é å¾€ä¸‹æ»‘å³ä¸‹è§’æœƒå‡ºç¾çš„é‚£å€‹ç®­é ­ï¼ŒæŒ‰ä¸‹å»æœƒå›åˆ°ç¶²é çš„é ‚éƒ¨ï¼Œæ‰¾åˆ°<code>next/_config.yml</code>ä¸­çš„<code>back2top</code>ï¼Œå°‡<code>enable</code>æ”¹æˆ<code>true</code>ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span>        <span class="comment"># æ˜¯å¦ä¹Ÿé¡¯ç¤ºåœ¨å´é‚Šæ¬„ä¸­</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">false</span>  <span class="comment"># æ˜¯å¦é¡¯ç¤ºç™¾åˆ†æ¯”</span></span><br></pre></td></tr></table></figure>
<h2 id="è¨ªå®¢çµ±è¨ˆ-æ–‡ç« é–±è®€çµ±è¨ˆ"><a class="markdownIt-Anchor" href="#è¨ªå®¢çµ±è¨ˆ-æ–‡ç« é–±è®€çµ±è¨ˆ"></a> è¨ªå®¢çµ±è¨ˆã€æ–‡ç« é–±è®€çµ±è¨ˆ</h2>
<p><a href="https://busuanzi.ibruce.info/" title="{rel='nofollow'}">ä¸è’œå­</a>æ˜¯ä¸€æ¬¾æ¥µç°¡çš„å‰ç«¯è¨ˆæ•¸å·¥å…·ï¼ŒNexTå·²ç¶“å¹«æˆ‘å€‘å°‡ä¸è’œå­æ•´åˆåœ¨ä¸»é¡Œç•¶ä¸­ï¼Œåªè¦ä¿®æ”¹<code>next/_config.yml</code>ä¸­çš„<code>busuanzi_count</code>ï¼Œå°‡<code>enable</code>æ”¹æˆ<code>true</code>ï¼Œå°±å¯ä»¥å•Ÿç”¨è¨ªå®¢çµ±è¨ˆã€æ–‡ç« é–±è®€æ¬¡æ•¸çš„åŠŸèƒ½ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span>  <span class="comment"># è¨ªå®¢äººæ•¸</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span>     <span class="comment"># å…¨ç«™é–±è¦½æ¬¡æ•¸</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">fa</span> <span class="string">fa-eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span>      <span class="comment"># æ–‡ç« é–±è®€çµ±è¨ˆ</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">far</span> <span class="string">fa-eye</span></span><br></pre></td></tr></table></figure>
<h2 id="æ–‡ç« å­—æ•¸-é–±è®€æ™‚é–“"><a class="markdownIt-Anchor" href="#æ–‡ç« å­—æ•¸-é–±è®€æ™‚é–“"></a> æ–‡ç« å­—æ•¸ã€é–±è®€æ™‚é–“</h2>
<ol>
<li>ä¸‹è¼‰<code>hexo-word-counter</code>æ’ä»¶</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm install hexo-word-counter</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hexo clean</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åœ¨Hexoçš„configæª”ä¸­(ä¸»ç›®éŒ„è£¡çš„)åŠ å…¥ä¸‹é¢è¨­å®š</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span>             <span class="comment"># æ–‡ç« å­—æ•¸</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span>                <span class="comment"># æ–‡ç« æ™‚é–“</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">false</span>      <span class="comment"># ç¸½æ–‡ç« å­—æ•¸ (é¡¯ç¤ºåœ¨ç¶²é åº•éƒ¨)</span></span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">false</span>         <span class="comment"># ç¸½æ–‡ç« æ™‚é–“ (é¡¯ç¤ºåœ¨ç¶²é åº•éƒ¨)</span></span><br><span class="line">  <span class="attr">exclude_codeblock:</span> <span class="literal">false</span>  <span class="comment"># ä¸è€ƒæ…®ç¨‹å¼ç¢¼éƒ¨åˆ†</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">275</span>                  <span class="comment"># Words Per Minute</span></span><br><span class="line">  <span class="attr">suffix:</span> <span class="string">&quot;mins.&quot;</span>           <span class="comment"># æ™‚é–“å–®ä½</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>wpmå®˜æ–¹æ–‡æª”ä¸­çµ¦çš„å»ºè­°æ˜¯<br />
Slow â‰ˆ 200<br />
Normal â‰ˆ 275<br />
Fast â‰ˆ 350<br />
å¦‚æœä¸»è¦æ˜¯ä¸­æ–‡çš„è©±å¯ä»¥è¨­300ï¼Œä¸­è‹±å¤¾é›œç¶­æŒ275å°±å¥½ã€‚</p>
</blockquote>
<ol start="3">
<li>é€™å€‹æ’ä»¶æœ‰è¢«æ•´åˆé€²NexTç•¶ä¸­ï¼Œåœ¨å®Œæˆå‰ä¸€å€‹æ­¥é©Ÿå¾Œï¼Œæˆ‘å€‘å¯ä»¥ä¿®æ”¹theme configä¾†èª¿æ•´å¤–è§€é¡¯ç¤º</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_meta:</span></span><br><span class="line">  <span class="attr">item_text:</span> <span class="literal">true</span>        <span class="comment"># æ˜¯å¦é¡¯ç¤ºæ–‡å­—éƒ¨åˆ†(æ–‡ç« )</span></span><br><span class="line"></span><br><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span>   <span class="comment"># æ˜¯å¦ç¨ç«‹ä¸€è¡Œ</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">false</span> <span class="comment"># æ˜¯å¦é¡¯ç¤ºæ–‡å­—éƒ¨åˆ†(ç¶²é åº•éƒ¨)</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸é¡¯ç¤ºæ–‡å­—çš„è©±å°±ä¸æœƒæœ‰<code>æ–‡ç« å­—æ•¸ï¼š</code>å’Œ<code>æ‰€éœ€é–±è®€æ™‚é–“ â‰ˆ</code>ï¼Œåªæœƒæœ‰æœ€å‰é¢çš„åœ–ç¤ºã€‚</p>
</blockquote>
<h2 id="å…¶ä»–"><a class="markdownIt-Anchor" href="#å…¶ä»–"></a> å…¶ä»–</h2>
<p>ç«™å…§æœå°‹ã€ä¸»é¸å–®ç­‰åŠŸèƒ½æˆ‘åœ¨<a href="/posts/Blog/2023/Hello-Hexo-2/">é€™ç¯‡æ–‡ç« </a>ä¸­æœ‰ä»‹ç´¹éäº†ï¼Œæœ‰èˆˆè¶£çš„äººå¯ä»¥å»çœ‹çœ‹ã€‚</p>
<h1 id="é å‘Š"><a class="markdownIt-Anchor" href="#é å‘Š"></a> é å‘Š</h1>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« æœƒå¸¶å¤§å®¶ç¾åŒ–éƒ¨è½æ ¼!åŒ…æ‹¬æ›´æ›èƒŒæ™¯åœ–ç‰‡ã€è®Šæ›´å­—é«”ä»¥åŠå…¶ä»–é¢¨æ ¼è¨­å®š~</p>
]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello Hexoï¼NexT ä¸»é¡Œå¤ªå–®èª¿ï¼Ÿè·Ÿè‘—é€™äº›ç¾åŒ–æ­¥é©Ÿç‚ºéƒ¨è½æ ¼åŠ å…¥å€‹äººé¢¨æ ¼ï¼(5)</title>
    <url>/posts/Blog/2023/Hello-Hexo-5/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1>
<p><img src="/images/2023/04/17/cover.png" alt="cover" /></p>
<p>Hexo Nexté›–ç„¶å·²ç¶“å°‡è¨±å¤šå¸¸è¦‹çš„è¨­å®šæ•´åˆåˆ°ä¸»é¡Œç•¶ä¸­ï¼Œä½†å¤§å®¶éƒ½æ¡ç”¨ä¸€æ¨£çš„è¨­å®šçš„è©±å…¶å¯¦æŒºç„¡èŠçš„ï¼Œæ‰€ä»¥ä»Šå¤©è¦åœ¨Hexo Nextçš„åŸºç¤ä¸Šå¸¶å¤§å®¶ä¾†ç¾åŒ–è‡ªå·±çš„éƒ¨è½æ ¼ï¼Œç‚ºéƒ¨è½æ ¼åŠ å…¥<strong>å€‹äººé¢¨æ ¼</strong>ï¼Œå¦‚æœé‚„ä¸çŸ¥é“Hexoæˆ–è€…NexTæ˜¯ä»€éº¼å¯ä»¥åƒè€ƒæˆ‘ä¹‹å‰å¯«çš„<a href="/categories/Hexo/">Hello Hexoï¼</a>ç³»åˆ—æ–‡ç« ã€‚</p>
<span id="more"></span>
<h1 id="å¤§ç¶±"><a class="markdownIt-Anchor" href="#å¤§ç¶±"></a> å¤§ç¶±</h1>
<ul>
<li><a href="#%E5%A5%97%E7%94%A8%E8%83%8C%E6%99%AF%E5%9C%96%E7%89%87">å¥—ç”¨èƒŒæ™¯åœ–ç‰‡</a></li>
<li><a href="#%E8%AA%BF%E6%95%B4%E5%8D%80%E5%A1%8A%E9%80%8F%E6%98%8E%E5%BA%A6">èª¿æ•´å€å¡Šé€æ˜åº¦</a></li>
<li><a href="#%E8%A8%AD%E7%BD%AE%E5%8D%80%E5%A1%8A%E5%9C%93%E8%A7%92">è¨­ç½®å€å¡Šåœ“è§’</a></li>
<li><a href="#%E6%96%87%E7%AB%A0%E5%8D%80%E5%A1%8A%E7%89%88%E9%9D%A2%E5%AF%AC%E5%BA%A6">æ–‡ç« å€å¡Šç‰ˆé¢å¯¬åº¦</a></li>
<li><a href="#%E7%A8%8B%E5%BC%8F%E7%A2%BC%E5%8D%80%E5%A1%8A%E4%B8%BB%E9%A1%8C">ç¨‹å¼ç¢¼å€å¡Šä¸»é¡Œ</a></li>
<li><a href="#%E8%AE%8A%E6%9B%B4%E6%96%87%E5%AD%97%E6%A8%A3%E5%BC%8F">è®Šæ›´æ–‡å­—æ¨£å¼</a></li>
<li><a href="#%E8%AE%8A%E6%9B%B4%E5%AD%97%E9%AB%94%E9%A1%9E%E5%9E%8B">è®Šæ›´å­—é«”é¡å‹</a></li>
<li><a href="#%E5%9C%96%E7%89%87%E6%94%BE%E5%A4%A7%E6%AA%A2%E8%A6%96">åœ–ç‰‡æ”¾å¤§æª¢è¦–</a></li>
</ul>
<h1 id="åŠŸèƒ½"><a class="markdownIt-Anchor" href="#åŠŸèƒ½"></a> åŠŸèƒ½</h1>
<h2 id="å¥—ç”¨èƒŒæ™¯åœ–ç‰‡"><a class="markdownIt-Anchor" href="#å¥—ç”¨èƒŒæ™¯åœ–ç‰‡"></a> å¥—ç”¨èƒŒæ™¯åœ–ç‰‡</h2>
<ol>
<li>æº–å‚™ä¸€å¼µåœ–ç‰‡æ”¾åˆ°<code>themes/next/source/images/</code>è·¯å¾‘ä¸­ã€‚</li>
<li>åˆ°<code>themes/next/_config.yml</code>ä¸­ï¼Œæ‰¾åˆ°<code>custom_file_path</code>ï¼Œå°‡<code>style</code>çš„è¨»è§£å–æ¶ˆæ‰ã€‚</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="comment">#head: source/_data/head.njk</span></span><br><span class="line">  <span class="comment">#header: source/_data/header.njk</span></span><br><span class="line">  <span class="comment">#sidebar: source/_data/sidebar.njk</span></span><br><span class="line">  <span class="comment">#postMeta: source/_data/post-meta.njk</span></span><br><span class="line">  <span class="comment">#postBodyEnd: source/_data/post-body-end.njk</span></span><br><span class="line">  <span class="comment">#footer: source/_data/footer.njk</span></span><br><span class="line">  <span class="comment">#bodyEnd: source/_data/body-end.njk</span></span><br><span class="line">  <span class="comment">#variable: source/_data/variables.styl</span></span><br><span class="line">  <span class="comment">#mixin: source/_data/mixins.styl</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">source/_data/styles.styl</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>åœ¨<code>source</code>å…§æ–°å¢<code>_data</code>è³‡æ–™å¤¾(<strong>æ³¨æ„æ˜¯blogçš„ï¼Œä¸æ˜¯nextè£¡é¢çš„!</strong>)ï¼Œæ¥è‘—åœ¨è£¡é¢æ–°å¢ä¸€å€‹<code>styles.styl</code>æ–‡ä»¶ã€‚</li>
<li>åœ¨<code>styles.styl</code>ä¸­åŠ å…¥:</li>
</ol>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>:<span class="built_in">url</span>(/images/background.jpg);  <span class="comment">// èƒŒæ™¯åœ–ç‰‡ä½ç½®</span></span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">background-attachment</span>: fixed;            <span class="comment">// æ˜¯å¦æ»¾å‹•ï¼Œfixedå›ºå®š</span></span><br><span class="line">  <span class="attribute">background-size</span>: cover;                  <span class="comment">// å¡«æ»¿ç•«é¢</span></span><br><span class="line">  <span class="attribute">background-position</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="èª¿æ•´å€å¡Šé€æ˜åº¦"><a class="markdownIt-Anchor" href="#èª¿æ•´å€å¡Šé€æ˜åº¦"></a> èª¿æ•´å€å¡Šé€æ˜åº¦</h2>
<p>å¥—ç”¨èƒŒæ™¯åœ–ç‰‡å¾Œï¼Œä½ å¯èƒ½æœƒç™¼ç¾ä½ çš„åœ–ç‰‡å¤§éƒ¨åˆ†éƒ½è¢«å€å¡Šæ“‹ä½äº†!ç‚ºäº†è®“å¤§å®¶çœ‹åˆ°ä½ ç¾ç¾çš„åœ–ç‰‡ï¼Œæ‰€ä»¥æˆ‘å€‘è¦ä¾†èª¿æ•´ä¸€ä¸‹å€è·¨çš„é€æ˜åº¦ï¼Œç¶²è·¯ä¸Šå¾ˆå¤šèª¿æ•´é€æ˜åº¦çš„æ–¹æ³•éƒ½æ²’æœ‰ç”¨æˆ‘è©¦éäº†ï¼Œæœ€å¾Œåœ¨<a href="https://hui-shao.cn/next-transparent-background/" title="{rel='nofollow'}">é€™ç¯‡æ–‡ç« </a>ä¸­æ‰¾åˆ°è®“æˆ‘æ»¿æ„çš„æ•ˆæœï¼Œé€™é‚Šç›´æ¥è¬›çµè«–ï¼Œåœ¨<code>styles.styl</code>åŠ å…¥:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">:root &#123;</span><br><span class="line">  --content-bg-color:#ffffffe6;  // ç™½è‰²åŠé€æ˜</span><br><span class="line">  --content-bg-color:#000000e6;  // é»‘è‰²åŠé€æ˜ï¼Œå…©è€…æ“‡ä¸€</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è£œå……: ä¸Šé¢çš„è¨­å®šæ˜¯ç›´æ¥å°‡å€å¡Šæ›æˆæŒ‡å®šé¡è‰²ï¼Œå¦‚æœæœ‰é–‹å•Ÿæ·±è‰²æ¨¡å¼å¯ä»¥ç”¨é»‘è‰²åŠé€æ˜ï¼Œå¦‚æœæ²’æœ‰çš„è©±å¯ä»¥ç”¨ç™½è‰²åŠé€æ˜ï¼Œä½†åˆ‡è¨˜ä¸è¦æ··è€…ç”¨ï¼Œå¦å‰‡æ–‡å­—æœƒçœ‹ä¸æ¸…æ¥šã€‚</p>
</blockquote>
<h2 id="è¨­ç½®å€å¡Šåœ“è§’"><a class="markdownIt-Anchor" href="#è¨­ç½®å€å¡Šåœ“è§’"></a> è¨­ç½®å€å¡Šåœ“è§’</h2>
<ol>
<li>åˆ°<code>themes/next/_config.yml</code>ä¸­ï¼Œæ‰¾åˆ°<code>custom_file_path</code>ï¼Œå°‡<code>variable</code>çš„è¨»è§£ä¹Ÿå–æ¶ˆæ‰ã€‚</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="comment">#head: source/_data/head.njk</span></span><br><span class="line">  <span class="comment">#header: source/_data/header.njk</span></span><br><span class="line">  <span class="comment">#sidebar: source/_data/sidebar.njk</span></span><br><span class="line">  <span class="comment">#postMeta: source/_data/post-meta.njk</span></span><br><span class="line">  <span class="comment">#postBodyEnd: source/_data/post-body-end.njk</span></span><br><span class="line">  <span class="comment">#footer: source/_data/footer.njk</span></span><br><span class="line">  <span class="comment">#bodyEnd: source/_data/body-end.njk</span></span><br><span class="line">  <span class="attr">variable:</span> <span class="string">source/_data/variables.styl</span></span><br><span class="line">  <span class="comment">#mixin: source/_data/mixins.styl</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">source/_data/styles.styl</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åœ¨<code>source</code>å…§æ–°å¢<code>_data</code>è³‡æ–™å¤¾(<strong>æ³¨æ„æ˜¯blogçš„ï¼Œä¸æ˜¯nextè£¡é¢çš„!</strong>)ï¼Œæ¥è‘—åœ¨è£¡é¢æ–°å¢ä¸€å€‹<code>variables.styl</code>æ–‡ä»¶ã€‚</li>
<li>åœ¨<code>variables.styl</code>ä¸­åŠ å…¥:</li>
</ol>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="variable">$border</span>-radius-inner     = <span class="number">30px</span> <span class="number">30px</span> <span class="number">30px</span> <span class="number">30px</span>;  <span class="comment">// (å…§è§’) å·¦ä¸Š å³ä¸Š å³ä¸‹ å·¦ä¸‹</span></span><br><span class="line"><span class="variable">$border</span>-radius           = <span class="number">30px</span>;                 <span class="comment">// (å¤–è§’) åªå¡«ä¸€å€‹æ•¸å­—è¡¨ç¤º4å€‹è§’</span></span><br></pre></td></tr></table></figure>
<h2 id="æ–‡ç« å€å¡Šç‰ˆé¢å¯¬åº¦"><a class="markdownIt-Anchor" href="#æ–‡ç« å€å¡Šç‰ˆé¢å¯¬åº¦"></a> æ–‡ç« å€å¡Šç‰ˆé¢å¯¬åº¦</h2>
<p>æˆ‘å€‘å…ˆä¾†çœ‹ä¸€ä¸‹é è¨­çš„å¯¬åº¦(æŒ‡çš„æ˜¯ç¶²é ç‰ˆï¼Œæ‰‹æ©Ÿæˆ–å¹³æ¿éƒ½æ˜¯ç”¨éŸ¿æ‡‰å¼ç¶²é ):</p>
<ul>
<li>Muse / Mist</li>
</ul>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="variable">$content</span>-desktop         = <span class="number">700px</span>   <span class="comment">// when screen width &lt; 1200px</span></span><br><span class="line"><span class="variable">$content</span>-desktop-large   = <span class="number">800px</span>   <span class="comment">// when screen width &gt;= 1200px</span></span><br><span class="line"><span class="variable">$content</span>-desktop-largest = <span class="number">900px</span>   <span class="comment">// when screen width &gt;= 1600px</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Pisces / Gemini</li>
</ul>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="variable">$content</span>-desktop         = <span class="string">&#x27;calc(100% - %s)&#x27;</span> % <span class="built_in">unit</span>(<span class="variable">$content</span>-desktop-<span class="attribute">padding</span> / <span class="number">2</span>, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"><span class="variable">$content</span>-desktop-large   = <span class="number">1160px</span></span><br><span class="line"><span class="variable">$content</span>-desktop-largest = <span class="number">73%</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸åŒä¸»é¡Œçš„å¯¬åº¦å®šç¾©æ–¹å¼ä¸å¤ªä¸€æ¨£ï¼Œå¦‚æœè¦æ›´æ”¹çš„è©±ï¼Œæˆ‘å€‘å¯ä»¥åˆ°<code>variables.styl</code>ä¸­æŠŠé è¨­çš„å¯¬åº¦è¦†è“‹æ‰ï¼Œèˆ‰ä¾‹ä¾†èªªæˆ‘ä½¿ç”¨Geminiï¼Œä¸‹é¢æ˜¯æˆ‘æ¡ç”¨çš„è¨­å®š:</p>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="variable">$content</span>-desktop         = <span class="number">90%</span>  <span class="comment">// å¯ä»¥ç”¨ç™¾åˆ†æ¯”</span></span><br><span class="line"><span class="variable">$content</span>-desktop-large   = <span class="number">80%</span>  <span class="comment">// ä¹Ÿå¯ç”¨çµ•å°æ•¸å€¼ ex: 1000px</span></span><br></pre></td></tr></table></figure>
<h2 id="ç¨‹å¼ç¢¼å€å¡Šä¸»é¡Œ"><a class="markdownIt-Anchor" href="#ç¨‹å¼ç¢¼å€å¡Šä¸»é¡Œ"></a> ç¨‹å¼ç¢¼å€å¡Šä¸»é¡Œ</h2>
<p>Hexoæä¾›äº†<code>highlight.js</code>ä»¥åŠ<code>prism.js</code>å…©ç¨®ç¨‹å¼ç¢¼å€å¡Šä¸»é¡Œengineï¼Œå¯ä»¥åƒè€ƒ<a href="https://theme-next.js.org/highlight/" title="{rel='nofollow'}">NexT Highlight Theme Preview</a>ä¾†åšæŒ‘é¸ï¼Œä»¥ä¸‹å·²æˆ‘è‡ªå·±å¥—ç”¨<code>highlight.js</code>ä¸­çš„<code>night-owl</code>ä¸»é¡Œç‚ºä¾‹ã€‚</p>
<ol>
<li>åˆ°<code>_config.yml</code>ä¸­(ä¸æ˜¯nextè£¡çš„)ï¼Œæ‰¾åˆ°<code>highlight</code>ï¼Œå°‡<code>enable</code>æ”¹æˆtrueã€‚</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span>   <span class="comment"># æ˜¯å¦é¡¯ç¤ºè¡Œæ•¸</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span>  <span class="comment"># æ˜¯å¦è‡ªå‹•åµæ¸¬èªè¨€(å»ºè­°ä¸è¦é–‹ï¼Œè½èªªå¾ˆåƒæ•ˆèƒ½)</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hljs:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">prismjs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span>       <span class="comment"># å¦‚æœæ˜¯ç”¨prismjsçš„è©±é‚£å°±æ˜¯é€™è£¡æ”¹trueï¼Œä¸è¦åŒæ™‚é–‹å…©å€‹</span></span><br><span class="line">  <span class="attr">preprocess:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åˆ°<code>themes/next/_config.yml</code>ä¸­ï¼Œæ‰¾åˆ°<code>codeblock</code>ï¼Œæ ¹æ“šæ˜¯å¦é–‹å•Ÿæ·±è‰²æ¨¡å¼ä¾†å¡«å…¥ä¸»é¡Œåç¨±ã€‚</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span><br><span class="line">  <span class="attr">theme:</span>                      <span class="comment"># highlight.js æ”¹é€™</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">night-owl</span>          <span class="comment"># (ç¯„ä¾‹)æ·ºè‰²æ¨¡å¼ä¸‹å¥—ç”¨night-owl </span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">stackoverflow-dark</span></span><br><span class="line">  <span class="attr">prism:</span>                      <span class="comment"># prism.js æ”¹é€™</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">prism</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">prism-dark</span></span><br><span class="line">  <span class="attr">copy_button:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span>             <span class="comment"># æ˜¯å¦é¡¯ç¤ºè¤‡è£½æŒ‰éˆ•</span></span><br><span class="line">    <span class="attr">style:</span>                    <span class="comment"># é¢¨æ ¼(Available values: default | flat | mac)</span></span><br></pre></td></tr></table></figure>
<h2 id="è®Šæ›´æ–‡å­—æ¨£å¼"><a class="markdownIt-Anchor" href="#è®Šæ›´æ–‡å­—æ¨£å¼"></a> è®Šæ›´æ–‡å­—æ¨£å¼</h2>
<p>é€™éƒ¨åˆ†ä¸»è¦æ˜¯åˆ†äº«æˆ‘åœ¨ç¶²è·¯ä¸Šæ‰¾åˆ°çš„ï¼Œè¦ºå¾—å¾ˆä¸éŒ¯çš„è¨­å®šï¼Œä»¥ä¸‹ä¿®æ”¹éƒ½æ˜¯åŠ åœ¨<code>source/_data/styles.styl</code>ä¸­ã€‚</p>
<ol>
<li>çŸ­ç¶²å€æ¨£å¼</li>
</ol>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">code</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#c7254e</span>; <span class="comment">//æ–‡å­—é¡è‰²</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f9f2f4</span>; <span class="comment">//åº•è‰²</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å…§æ–‡é€£çµæ¨£å¼</li>
</ol>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-body</span> <span class="selector-tag">p</span> a&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#0593d3</span>;</span><br><span class="line">  <span class="selector-pseudo">&amp;:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: none;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>ä¿®æ”¹é¸ä¸­æ–‡å­—åº•è‰²</li>
</ol>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* webkit, opera, IE9 */</span></span><br><span class="line"><span class="selector-pseudo">::selection</span> &#123; </span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#00c4b6</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f7f7f7</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* firefox */</span></span><br><span class="line">::-moz-selection &#123; </span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#00c4b6</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f7f7f7</span>;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>ä¿®æ”¹é è…³é…è‰²</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//é è…³çµ±è¨ˆæ–‡å­—é¡è‰²</span><br><span class="line">.footer&#123;</span><br><span class="line">  color: #F0D784</span><br><span class="line">&#125;</span><br><span class="line">//ä¿®æ”¹é è…³å‚™æ¡ˆéˆæ¥é¡è‰²</span><br><span class="line">.footer a&#123;</span><br><span class="line">  color: #F0D784</span><br><span class="line">&#125;</span><br><span class="line">//ä¿®æ”¹é è…³çµ±è¨ˆäººæ•¸çš„é¡è‰²</span><br><span class="line">.footer .with-love&#123;</span><br><span class="line">  color: #F0D784</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è®Šæ›´å­—é«”é¡å‹"><a class="markdownIt-Anchor" href="#è®Šæ›´å­—é«”é¡å‹"></a> è®Šæ›´å­—é«”é¡å‹</h2>
<p>NexTå¯ä»¥ç›´æ¥ä½¿ç”¨<a href="https://fonts.google.com/" title="{rel='nofollow'}">Google Fonts</a>æä¾›çš„å­—é«”ï¼Œä½†å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç¹é«”ä¸­æ–‡çš„è©±ï¼Œä½ æœƒç™¼ç¾å…¶å¯¦ä¹Ÿå°±åªæœ‰å…©ç¨®å¯ä»¥é¸è€Œå·²XDDDï¼ŒNexTé è¨­æ˜¯ä½¿ç”¨<strong>å¾®è»Ÿæ­£é»‘é«”</strong>ï¼Œå¦å¤–ä¸€ç¨®æ˜¯<strong>å”å®‹æ€æºé«”</strong>ï¼Œæˆ‘å€‘ä»Šå¤©å°±ä¾†è©¦è€…æŠŠå­—é«”æ›æˆå”å®‹æ€æºé«”çœ‹çœ‹å§!</p>
<ol>
<li>åˆ°<code>themes/next/_config.yml</code>ä¸­ï¼Œæ‰¾åˆ°<code>font</code>å°‡<code>enable</code>æ”¹æˆ<code>true</code>ï¼Œæ¥è‘—æ›´æ”¹<code>global</code>çš„è¨­å®š(å¾Œé¢çš„ä¸ç”¨æ”¹)ã€‚</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">font:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>              <span class="comment"># è¨­æˆtrue</span></span><br><span class="line">  <span class="attr">host:</span> </span><br><span class="line">  <span class="attr">global:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span>          <span class="comment"># è¨­æˆtrue</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">Noto</span> <span class="string">Serif</span> <span class="string">TC</span>   <span class="comment"># å”å®‹æ€æºé«”(TC: Traditional Chinese)</span></span><br><span class="line">    <span class="attr">size:</span>                   <span class="comment"># å­—é«”å¤§å°ï¼Œé»˜èªç‚º1ï¼ˆ16pxï¼‰</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>é€™é‚Šç‰¹åˆ¥èªªæ˜<code>host</code>éƒ¨åˆ†ï¼Œåœ¨å°ç£åŸºæœ¬ä¸Šæ˜¯ä¸ç”¨è¨­ï¼Œä½†å› ç‚ºé è¨­çš„hostæ˜¯Googleçš„apiï¼Œæ‰€ä»¥å¤§é™¸åœ°å€çš„ç”¨æˆ¶åœ¨çœ‹æˆ‘å€‘çš„ç¶²ç«™æ™‚å¯èƒ½æœƒé‡åˆ°ä¸€äº›ç©©å®šæ€§ä¸Šçš„å•é¡Œ?å¦‚æœä½ éƒ¨è½æ ¼çš„targetæ˜¯æ•´å€‹å¤§ä¸­è¯åœ°å€çš„è©±å¯ä»¥å¦å¤–è¨­å€‹hostï¼Œé€™é‚Šæä¾›<a href="https://github.com/cdnjs/cdnjs" title="{rel='nofollow'}">cdnjs</a>çš„é¡åƒapiçµ¦æœ‰éœ€è¦çš„äºº:</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">host:</span> <span class="string">https://fonts.loli.net</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è£œå……: ä½ å¯èƒ½æœƒæƒ³å•ã€Œå¦‚æœæˆ‘æƒ³è¦ç”¨çš„å­—é«”Google Fontsæ²’æœ‰æä¾›æ€éº¼è¾¦?ã€ï¼Œå…¶å¯¦ä¹Ÿæ˜¯æœ‰è¾¦æ³•ä½¿ç”¨æœ¬åœ°çš„å­—é«”å–”ï¼Œä¸éé€™éƒ¨åˆ†ç¨å¾®éº»ç…©ä¸€ä¸Ÿä¸Ÿï¼Œæ‰€ä»¥ä¹‹å¾Œå¦å¤–å¯«ä¸€ç¯‡æ–‡ç« ä»‹ç´¹!</p>
</blockquote>
<h2 id="åœ–ç‰‡æ”¾å¤§æª¢è¦–"><a class="markdownIt-Anchor" href="#åœ–ç‰‡æ”¾å¤§æª¢è¦–"></a> åœ–ç‰‡æ”¾å¤§æª¢è¦–</h2>
<p>NexTç›®å‰æä¾›å…©ç¨®ç‰‡æ”¾å¤§æª¢è¦–çš„å·¥å…·ï¼Œåˆ†åˆ¥æ˜¯<a href="https://fancyapps.com/fancybox/" title="{rel='nofollow'}">FancyBox</a>ä»¥åŠ<a href="https://medium-zoom.francoischalifour.com/" title="{rel='nofollow'}">Medium Zoom</a>ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è‡ªå·±å–œæ­¡å“ªç¨®ã€‚</p>
<p>åˆ°<code>themes/next/_config.yml</code>ä¸­æ‰¾åˆ°<code>fancybox</code>/<code>mediumzoom</code>ï¼Œå°‡å…¶æ”¹ç‚º<code>true</code>ï¼Œæ³¨æ„ä¸è¦åŒæ™‚é–‹å•Ÿå…©å€‹åŠŸèƒ½!!!</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">fancybox:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">mediumzoom:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è£œå……: FancyBoxçš„åŠŸèƒ½æ¯”è¼ƒå¤šä¸”å¯ä»¥é¡¯ç¤ºè¨»è§£ï¼Œä¸éæœ‰<a href="https://github.com/ppoffice/hexo-theme-icarus/issues/868" title="{rel='nofollow'}">issue</a>è¡¨ç¤ºFancyBoxå°æ–¼è¡Œå‹•è£ç½®ä¼¼ä¹ä¸æ˜¯å¾ˆå‹å¥½? ä¸çŸ¥é“æ”¹äº†æ²’ï¼ŒMedium Zoomå°±è·ŸMediumæ”¾å¤§åœ–ç‰‡çš„åŠŸèƒ½ä¸€æ¨£ï¼Œä»‹é¢æ¯”è¼ƒç°¡æ½”ã€‚</p>
</blockquote>
<h1 id="åƒè€ƒè³‡æ–™"><a class="markdownIt-Anchor" href="#åƒè€ƒè³‡æ–™"></a> åƒè€ƒè³‡æ–™</h1>
<p>æ–‡ç« å…§å®¹å¤§å¤šæ˜¯ç¶²è·¯ä¸Šçš„è³‡æ–™æ•´ç†è€Œä¾†ï¼Œå†åŠ ä¸Šè‡ªå·±çš„æ¡å‘ç¶“é©—ï¼Œå¦‚æœæœ‰éºæ¼ä¾†æºçš„è©±å†éº»ç…©å‘ŠçŸ¥è£œä¸Š!</p>
<ul>
<li><a href="https://zenreal.github.io/posts/44730/" title="{rel='nofollow'}">æœ€æ–° Hexo NexT v7.4.1 ä¸»é¡Œå„ªåŒ–</a></li>
<li><a href="https://hui-shao.cn/next-transparent-background/" title="{rel='nofollow'}">Hexo + NexT8ä¸»é¢˜é…ç½®é€æ˜èƒŒæ™¯è¿‡ç¨‹è¸©å‘å°è®°</a></li>
<li><a href="https://spartazhc.github.io/2020/06/03/Next%E4%B8%BB%E9%A2%98%E5%AD%97%E4%BD%93%E9%85%8D%E7%BD%AE/" title="{rel='nofollow'}">Nextä¸»é¢˜å­—ä½“é…ç½®</a></li>
</ul>
]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>è©¦è‘—è‡ªå·±å¯«äº†ä¸€å€‹ Hexo å¤–æ›ï¼šHexo + HackMD</title>
    <url>/posts/Blog/2024/hexo-hackmd/</url>
    <content><![CDATA[<h2 id="é‡é»"><a class="markdownIt-Anchor" href="#é‡é»"></a> é‡é»</h2>
<p>å¯«äº†ä¸€å€‹ Hexo å¤–æ› <strong><a href="https://github.com/MengChiehLiu/hexo-hackmd">hexo-hackmd</a></strong> å”åŠ©ä¸‹è¼‰ HackMD ç­†è¨˜åˆ°æœ¬åœ°ç«¯ï¼Œæ­¡è¿å¤§å®¶ä½¿ç”¨ï¼Œæœ‰å•é¡Œå¯ä»¥ç™¼ <strong><a href="https://github.com/MengChiehLiu/hexo-hackmd/issues">issues</a></strong> çµ¦æˆ‘ã€‚</p>
<span id="more"></span>
<h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2>
<p>å°æ–¼ä½¿ç”¨ Hexo æ­å»ºéƒ¨è½æ ¼çš„äººä¾†èªªï¼Œå¹³æ™‚éƒ½æ˜¯å¦‚ä½•æ’°å¯«éƒ¨è½æ ¼æ–‡ç« çš„å‘¢ï¼Ÿæˆ‘è‡ªå·±æ˜¯è »å–œæ­¡å…ˆç”¨ <strong><a href="https://hackmd.io/">HackMD</a></strong> ä¾†ç·¨å¯«æ–‡ç« ï¼Œå¯«å®Œä¹‹å¾Œå†æŠŠæ–‡ç« è¤‡è£½åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ã€‚</p>
<p>åœ¨é€™å€‹æ“ä½œä¸­ï¼Œæœ€éº»ç…©çš„å°±æ˜¯è™•ç†åœ–ç‰‡äº†ï¼Œå¦‚æœç›´æ¥åœ¨éƒ¨è½æ ¼ä¸­ä½¿ç”¨ HackMD é è¨­çš„åœ–ç‰‡ URL (ex: <a href="https://hackmd.io/_uploads/XXX.png">https://hackmd.io/_uploads/XXX.png</a>)ï¼Œæ˜¯é¡¯ç¤ºä¸å‡ºæ±è¥¿çš„ (é™¤éä½ æŠŠè©²ç­†è¨˜å…¬é–‹å…¬é–‹)ï¼Œä½†æˆ‘è‡ªå·±å–œæ­¡æŠŠåœ–ç‰‡è·Ÿéƒ¨è½æ ¼å­˜åœ¨ä¸€èµ·ï¼Œæ‰€ä»¥é€šå¸¸æˆ‘éƒ½æœƒæ‰‹å‹•å°‡åœ–ç‰‡ä¸‹è¼‰ä¸‹ä¾†ä¸¦ä¸”ä¿®æ”¹ URLã€‚</p>
<p>ååæˆ‘æ˜¯å€‹è »å–œæ­¡æ”¾åœ–ç‰‡çš„äººï¼Œç•¶åœ–ç‰‡ä¸€å¤šèµ·ä¾†ï¼Œä¿®æ”¹è·Ÿæª¢æŸ¥ä¹Ÿæ˜¯è¦è€—ä¸Šä¸å°‘æ™‚é–“ï¼Œä½†é€™è±ˆä¸æ˜¯è®Šæˆæˆ‘åœ¨ HackMD ä¸Šè¦æª¢æŸ¥ä¸€éï¼Œåœ¨æœ¬åœ°ç«¯åˆè¦æª¢æŸ¥ä¸€éå—ï¼</p>
<p><img src="/images/2024/04/30/cannot-accept-meme.png" alt="cannot-accept-meme" /></p>
<h2 id="hexo-plugin"><a class="markdownIt-Anchor" href="#hexo-plugin"></a> Hexo Plugin</h2>
<p>èªªçœŸçš„åŠŸèƒ½ä¸æ˜¯å¾ˆé›£å¯¦ç¾ï¼Œå°±åªæ˜¯æ‰“å¹¾éš» API ç„¶å¾Œçœ‹æœ‰æ²’æœ‰åœ–ç‰‡æŠŠå®ƒå€‘æ›¿æ›æ‰è€Œå·²ï¼Œæ¯”è¼ƒä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹çš„æ˜¯å°‡å…¶åŒ…è£æˆ Hexo pluginï¼Œç•¢ç«Ÿè©²æœ‰çš„åŠŸèƒ½å¤§è‡´ä¸Šéƒ½å·²ç¶“æœ‰äººé–‹ç™¼äº†ã€‚</p>
<p>ç ”ç©¶äº†ä¸€ä¸‹ï¼Œç™¼ç¾ä¹Ÿæ²’æœ‰çœŸçš„å‹•åˆ° Hexo çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œç”¨ <a href="https://hexo.io/api/console">Hexo API console extension</a> å°±è¼•é¬†æå®šã€‚</p>
<p>é›–ç„¶æ˜¯ä¸€å€‹éå¸¸ç°¡å–®çš„å¤–æ›ï¼Œä½†å¾éå»åªèƒ½ä½¿ç”¨åˆ¥äººé–‹ç™¼çš„å¤–æ›ï¼Œåˆ°ç¾åœ¨è‡ªå·±å¯«äº†ä¸€å€‹å‡ºä¾†ï¼Œå…¶å¯¦æŒºæœ‰æˆå°±æ„Ÿçš„ã€‚</p>
<h2 id="å®‰è£èˆ‡ä½¿ç”¨"><a class="markdownIt-Anchor" href="#å®‰è£èˆ‡ä½¿ç”¨"></a> å®‰è£èˆ‡ä½¿ç”¨</h2>
<h3 id="install"><a class="markdownIt-Anchor" href="#install"></a> Install</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-hackmd</span><br></pre></td></tr></table></figure>
<h3 id="config"><a class="markdownIt-Anchor" href="#config"></a> Config</h3>
<p>æ–°å¢ä¸‹é¢è‡³ Hexo Configï¼Œå¯ä»¥åƒè€ƒ <a href="https://hackmd.io/@hackmd-api/how-to-issue-an-api-token">How to issue an API token</a> å–å¾— <code>hackmd_token</code>ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">hackmd_token:</span> <span class="string">your_hackmd_token</span></span><br></pre></td></tr></table></figure>
<h3 id="usage"><a class="markdownIt-Anchor" href="#usage"></a> Usage</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo hackmd &lt;url&gt; &lt;title&gt;</span><br></pre></td></tr></table></figure>
<p><code>url</code> å°±æ˜¯ HackMD ç­†è¨˜çš„ URLã€‚<br />
<code>title</code> æ˜¯æ–‡ç« çš„æª”æ¡ˆåç¨±ï¼Œé è¨­æ˜¯ <code>default-title</code>ã€‚</p>
<h3 id="options"><a class="markdownIt-Anchor" href="#options"></a> Options</h3>
<p>é è¨­æ–‡ç« è·¯å¾‘æ˜¯ <code>source/_posts</code>ï¼Œé è¨­åœ–ç‰‡è·¯å¾‘æ˜¯ <code>source/images</code>ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šè·¯å¾‘ï¼Œé–‹é ­å¿…é ˆæ˜¯ <code>source/</code>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo hackmd &lt;url&gt; &lt;title&gt; -p &lt;post_dir&gt; -i &lt;img_dir&gt;</span><br></pre></td></tr></table></figure>
<h3 id="å°æé†’"><a class="markdownIt-Anchor" href="#å°æé†’"></a> å°æé†’</h3>
<ol>
<li>é€™å€‹å¤–æ›ä¸¦ä¸æœƒè€ƒæ…® HackMD ç­†è¨˜å³ä¸Šè§’çš„ title èˆ‡ tagsï¼Œä½ æƒ³è¦ä»€éº¼ meta data å°±ç›´æ¥å¯«é€²å» content è£¡ï¼Œå¦å¤–é€™è£¡çš„ title è·Ÿæª”æ¡ˆåç¨±æ²’æœ‰é—œä¿‚ã€‚</li>
<li>HackMD è²¼ä¸Šçš„åœ–ç‰‡é è¨­ ALT å°±æ˜¯ imageï¼Œè¨˜å¾—è¦æ”¹æ‰ï¼Œä¸ç„¶å­˜ä¸‹ä¾†çš„åœ–ç‰‡æœƒè¢«å–ä»£æ‰ã€‚</li>
<li>å¦‚æœä½ æœ‰ç”¨ä¸€äº›å‚™ä»½çš„å¤–æ›æœƒå‚™ä»½ config åˆ°å…¬é–‹ç©ºé–“çš„è©±ï¼Œè¨˜å¾—è¦<strong>å…ˆæŠŠ token åˆªæ‰</strong>ã€‚</li>
</ol>
<h2 id="ç¯„ä¾‹"><a class="markdownIt-Anchor" href="#ç¯„ä¾‹"></a> ç¯„ä¾‹</h2>
<p>å¤§å®¶å¯ä»¥ç”¨é€™å€‹å…¬é–‹ç™¼è¡¨çš„ç¶²å€è©¦è©¦ï¼š<a href="https://hackmd.io/PPr2yfn9S3m10WMnHuVepg">https://hackmd.io/PPr2yfn9S3m10WMnHuVepg</a></p>
<p><img src="/images/2024/04/30/hackmd-example.png" alt="hackmd-example" /></p>
<h3 id="æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#æŒ‡ä»¤"></a> æŒ‡ä»¤</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo hackmd https://hackmd.io/PPr2yfn9S3m10WMnHuVepg adventure time</span><br></pre></td></tr></table></figure>
<h3 id="çµæœ"><a class="markdownIt-Anchor" href="#çµæœ"></a> çµæœ</h3>
<p>å„²å­˜è‡³é è¨­è·¯å¾‘: <code>source/_posts</code><br />
<img src="/images/2024/04/30/post-dir-result.png" alt="post-dir-result" /></p>
<p>å„²å­˜è‡³é è¨­è·¯å¾‘: <code>source/images</code><br />
<img src="/images/2024/04/30/image-dir-result.png" alt="image-dir-result" /></p>
<p>æˆ‘çš„éƒ¨è½æ ¼é è¦½æˆæœ:<br />
<img src="/images/2024/04/30/blog-view.png" alt="blog-view" /></p>
]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>è§£æ±º Hexo NexT ä¸»é¡Œ Sidebar åŠ è¼‰ç·©æ…¢å•é¡Œ</title>
    <url>/posts/Blog/2024/speed-up-sidebar-loading/</url>
    <content><![CDATA[<h2 id="å•é¡Œèªªæ˜"><a class="markdownIt-Anchor" href="#å•é¡Œèªªæ˜"></a> å•é¡Œèªªæ˜</h2>
<p><img src="/images/2024/04/27/sidebar_slow_new.gif" alt="sidebar slow" /></p>
<p>å¦‚ä¸Šé¢æ‰€å±•ç¤ºçš„ï¼ŒSidebar æ¸²æŸ“çš„é€Ÿåº¦æ˜é¡¯æ¯”å…¶ä»–éƒ¨åˆ†è¦æ…¢ä¸Šè¨±å¤šã€‚</p>
<span id="more"></span>
<p><img src="/images/2024/04/27/website_score.png" alt="website score" /></p>
<p>é€é <a href="https://pagespeed.web.dev">PageSpeed Insights</a> å¹«ç¶²ç«™é€²è¡Œè©•åˆ†ï¼Œç¶“éæ¸¬è©¦å¾Œæ•ˆèƒ½æ˜¯æ…˜æ¾¹çš„ 60 åˆ†ã€‚ç•¢ç«Ÿç¶²ç«™é€Ÿåº¦ç¢ºç¢ºå¯¦å¯¦æ˜¯æœƒå½±éŸ¿åˆ° Google çš„ SEO è©•åˆ†çš„ï¼Œæ‰€ä»¥å‹¢å¿…å¾—å¥½å¥½æ­£è¦–é€™å€‹å•é¡Œã€‚è©³æƒ…å¯ä»¥åƒè€ƒï¼š<a href="https://www.yesharris.com/seo-basic/page-speed-seo/">SEOé‡é»é …ç›®ï¼šç¶²ç«™é€Ÿåº¦æ¸¬è©¦ã€é€Ÿåº¦å„ªåŒ–æŒ‡å—</a>ã€‚</p>
<h2 id="å•é¡Œè§£æ±º"><a class="markdownIt-Anchor" href="#å•é¡Œè§£æ±º"></a> å•é¡Œè§£æ±º</h2>
<p>ç›´æ¥èªªæœ€ç°¡å–®çš„è§£æ³•ï¼Œå› ç‚º Next Config é è¨­é–‹å•Ÿå‹•ç•«é¸é … (å°±æ˜¯ fadeIn fadeOut ä¹‹é¡çš„)ï¼Œè¦é¦¬ç›´æ¥é—œé–‰å‹•ç•«é¸é …ï¼Œè¦é¦¬é–‹å•Ÿ <code>async</code>ï¼Œè®“å‹•ç•«èƒ½éåŒæ­¥åŠ è¼‰ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">motion:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">async:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/2024/04/27/sidebar_fast_new.gif" alt="sidebar fast" /></p>
<p>å¯ä»¥çœ‹åˆ°æ˜é¡¯é€Ÿåº¦å¿«ä¸Šäº†ä¸å°‘ï¼Œçœ‹ä¸Šå»å”èª¿å¤šäº†ã€‚</p>
<h2 id="ç¶²é åŠ é€Ÿ"><a class="markdownIt-Anchor" href="#ç¶²é åŠ é€Ÿ"></a> ç¶²é åŠ é€Ÿ</h2>
<p>æ—¢ç„¶éƒ½è¬›åˆ°ç¶²ç«™é€Ÿåº¦äº†ï¼Œé‚£å°±é †ä¾¿ä¾†çœ‹çœ‹é‚„å¯ä»¥åšä»€éº¼å„ªåŒ–ï¼š</p>
<h3 id="lazy-loading"><a class="markdownIt-Anchor" href="#lazy-loading"></a> Lazy Loading</h3>
<p>å¯ä»¥è®“åœ–ç‰‡æ™šé»æ‰è¼‰å…¥ã€‚</p>
<ul>
<li>å®‰è£å¥—ä»¶ï¼š</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-lazyload-image</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹ Next Configï¼š</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">lazyload:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="minify"><a class="markdownIt-Anchor" href="#minify"></a> Minify</h3>
<p>ç°¡å–®ä¾†èªªå°±æ˜¯åˆªé™¤å†—é¤˜çš„æª”æ¡ˆï¼ŒNexT å…§å»ºå°±æœ‰ minify åŠŸèƒ½ã€‚</p>
<ul>
<li>ä¿®æ”¹ Next Configï¼š</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">minify:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>æ­¤å¤–é‚„å¯ä»¥ä½¿ç”¨ hexo çš„å¤–æ› <a href="https://github.com/next-theme/hexo-optimize">hexo-optimize</a>ï¼Œé™¤äº† minify å¤–ï¼Œé‚„åŒ…æ‹¬å…¶ä»–å„ªåŒ–ï¼Œå¦‚é è¼‰è³‡æºã€å°‡ CSS ç›´æ¥åµŒå…¥ html ç­‰ç­‰ã€‚</p>
<ul>
<li>å®‰è£å¥—ä»¶ï¼š</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-optimize</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹ Hexo Configï¼š</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">filter_optimize:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># static resource versioning</span></span><br><span class="line">  <span class="attr">versioning:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">css:</span></span><br><span class="line">    <span class="comment"># minify all css files</span></span><br><span class="line">    <span class="attr">minify:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">excludes:</span></span><br><span class="line">    <span class="comment"># use preload to load css elements dynamically</span></span><br><span class="line">    <span class="attr">delivery:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;@fortawesome/fontawesome-free&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;fonts.googleapis.com&#x27;</span></span><br><span class="line">    <span class="comment"># make specific css content inline into the html page</span></span><br><span class="line">    <span class="attr">inlines:</span></span><br><span class="line">      <span class="comment"># support full path only</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">css/main.css</span></span><br><span class="line">  <span class="attr">js:</span></span><br><span class="line">    <span class="comment"># minify all js files</span></span><br><span class="line">    <span class="attr">minify:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">excludes:</span></span><br><span class="line">    <span class="comment"># remove the comments in each of the js files</span></span><br><span class="line">    <span class="attr">remove_comments:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">html:</span></span><br><span class="line">    <span class="comment"># minify all html files</span></span><br><span class="line">    <span class="attr">minify:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">excludes:</span></span><br><span class="line">  <span class="comment"># set the priority of this plugin,</span></span><br><span class="line">  <span class="comment"># lower means it will be executed first, default of Hexo is 10</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">12</span></span><br></pre></td></tr></table></figure>
<p>è€å¯¦èªªæˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šé€™å€‹å¤–æ›è·Ÿ NexT å…§å»ºçš„ minify åˆ°åº•å·®ç•°å¤šå°‘ï¼Œä½†å¯¦éš›ä½¿ç”¨èµ·ä¾†å„è‡ªæœ‰å„è‡ªçš„æ•ˆæœã€‚</p>
<p>èˆ‰ä¾‹ä¾†èªª hexo-optimize é›–ç„¶æœ‰ minify çš„åŠŸèƒ½ï¼Œä½†æ¸¬è©¦å¾Œ generate å‡ºä¾†çš„æ–‡ä»¶æ•¸é‡ç¢ºæ²’æœ‰æ¯”è¼ƒå°‘ï¼Œåå€’æ˜¯ NexT å…§å»ºçš„ minify é–‹å•Ÿå¾Œ generate çš„æ–‡ä»¶æ•¸æœ‰æ˜é¡¯çš„æ¸›å°‘ã€‚</p>
<p>ä¸éä½¿ç”¨ hexo-optimize å¾Œçš„ç¢ºæœƒè®“ç¶²ç«™åŠ è¼‰é€Ÿåº¦æ›´å¿«ï¼Œæ—¢ç„¶å¦‚æ­¤é€™è£¡ä¸€å¾‹å»ºè­° <strong>å…©ç¨®éƒ½ç”¨</strong>ã€‚</p>
<h2 id="å¾Œè¨˜"><a class="markdownIt-Anchor" href="#å¾Œè¨˜"></a> å¾Œè¨˜</h2>
<p><img src="/images/2024/04/27/gif_speed.png" alt="gif speed" /></p>
<p>è©¦äº†ä¸€ä¸‹ç¶²ç«™æ•ˆèƒ½çš„åˆ†æ•¸é‚„æ˜¯ä¸å¤ªç†æƒ³ï¼Œæª¢æŸ¥ä¹‹å¾Œç™¼ç¾è·Ÿ <strong>Largest Contentful Paint</strong> æœ‰é—œï¼ŒåŸæœ¬ä»¥ç‚ºæ˜¯ gif æª”æ¡ˆå¤ªå¤§ï¼Œæ‰€ä»¥è©¦è‘—ç”¨ <a href="https://ezgif.com/optimize">GIF optimizer</a> ä¾†å£“ç¸® gif çš„å¤§å°ï¼Œå°‡æª”æ¡ˆå¤§å°å£“ç¸®äº† 50% ä»¥ä¸Šï¼Œä½†é€™é …æŒ‡æ¨™é‚„æ˜¯æ²’ä»€éº¼æ”¹å–„ï¼Œç­è§£ä¹‹å¾Œå¾ˆå¯èƒ½æ˜¯å› ç‚ºæˆ‘çš„åœ–ç‰‡æ˜¯ç›´æ¥å­˜åœ¨ github çš„ server ä¸­ï¼Œå¯¦åœ¨æ˜¯å¿«ä¸èµ·ä¾†çš„æ¨£å­ï¼Œè§£æ³•ä¸æ˜¯å¹«åœ–ç‰‡æ¬å®¶ã€è½‰æ ¼å¼ã€ä¸ç„¶å°±æ˜¯ CDN äº†ï¼Œç­‰ä¹‹å¾Œæœ‰æ™‚é–“å†ä¾†æŠ˜é¨°å›‰â€¦ (Â´ãƒ»Ï‰ãƒ»)</p>
<p>ä¸éå¯¦éš›çš„ç¶²ç«™é«”é©—é‚„æ˜¯å¥½å¾ˆå¤šå•¦ï¼Œä¹Ÿç®—æˆåŠŸï¼(ç²¾ç¥å‹åˆ©æ³•)</p>
]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>SEO</tag>
      </tags>
  </entry>
</search>
